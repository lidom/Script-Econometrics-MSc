<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)</title>
  <meta name="description" content="8.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="8.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/mylogo.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)" />
  
  
  <meta name="twitter:image" content="/images/mylogo.png" />

<meta name="author" content="Prof. Dr. Dominik Liebl" />


<meta name="date" content="2021-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="8.3-civ.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="organization-of-the-course.html"><a href="organization-of-the-course.html"><i class="fa fa-check"></i>Organization of the Course</a></li>
<li class="chapter" data-level="" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i>Literature</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-introduction-to-r.html"><a href="1-introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-short-glossary.html"><a href="1.1-short-glossary.html"><i class="fa fa-check"></i><b>1.1</b> Short Glossary</a></li>
<li class="chapter" data-level="1.2" data-path="1.2-first-steps.html"><a href="1.2-first-steps.html"><i class="fa fa-check"></i><b>1.2</b> First Steps</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-further-data-objects.html"><a href="1.3-further-data-objects.html"><i class="fa fa-check"></i><b>1.3</b> Further Data Objects</a></li>
<li class="chapter" data-level="1.4" data-path="1.4-simple-regression-analysis-using-r.html"><a href="1.4-simple-regression-analysis-using-r.html"><i class="fa fa-check"></i><b>1.4</b> Simple Regression Analysis using R</a></li>
<li class="chapter" data-level="1.5" data-path="1.5-programming-in-r.html"><a href="1.5-programming-in-r.html"><i class="fa fa-check"></i><b>1.5</b> Programming in R</a></li>
<li class="chapter" data-level="1.6" data-path="1.6-r-packages.html"><a href="1.6-r-packages.html"><i class="fa fa-check"></i><b>1.6</b> R-packages</a></li>
<li class="chapter" data-level="1.7" data-path="1.7-tidyverse.html"><a href="1.7-tidyverse.html"><i class="fa fa-check"></i><b>1.7</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="1.7-tidyverse.html"><a href="1.7-tidyverse.html#tidyverse-plotting-basics"><i class="fa fa-check"></i><b>1.7.1</b> Tidyverse: Plotting Basics</a></li>
<li class="chapter" data-level="1.7.2" data-path="1.7-tidyverse.html"><a href="1.7-tidyverse.html#tidyverse-data-wrangling-basics"><i class="fa fa-check"></i><b>1.7.2</b> Tidyverse: Data Wrangling Basics</a></li>
<li class="chapter" data-level="1.7.3" data-path="1.7-tidyverse.html"><a href="1.7-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>1.7.3</b> The pipe operator <code>%&gt;%</code></a></li>
<li class="chapter" data-level="1.7.4" data-path="1.7-tidyverse.html"><a href="1.7-tidyverse.html#the-group_by-function"><i class="fa fa-check"></i><b>1.7.4</b> The <code>group_by()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="1.8-further-links.html"><a href="1.8-further-links.html"><i class="fa fa-check"></i><b>1.8</b> Further Links</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="1.8-further-links.html"><a href="1.8-further-links.html#further-r-intros"><i class="fa fa-check"></i><b>1.8.1</b> Further R-Intros</a></li>
<li class="chapter" data-level="1.8.2" data-path="1.8-further-links.html"><a href="1.8-further-links.html#version-control-gitgithub"><i class="fa fa-check"></i><b>1.8.2</b> Version Control (Git/GitHub)</a></li>
<li class="chapter" data-level="1.8.3" data-path="1.8-further-links.html"><a href="1.8-further-links.html#r-ladies"><i class="fa fa-check"></i><b>1.8.3</b> R-Ladies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-review-probability-and-statistics.html"><a href="2-review-probability-and-statistics.html"><i class="fa fa-check"></i><b>2</b> Review: Probability and Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-probability-theory.html"><a href="2.1-probability-theory.html"><i class="fa fa-check"></i><b>2.1</b> Probability Theory</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-probability-theory.html"><a href="2.1-probability-theory.html#sample-spaces-and-events"><i class="fa fa-check"></i><b>2.1.1</b> Sample Spaces and Events</a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-probability-theory.html"><a href="2.1-probability-theory.html#probability"><i class="fa fa-check"></i><b>2.1.2</b> Probability</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-probability-theory.html"><a href="2.1-probability-theory.html#independent-events"><i class="fa fa-check"></i><b>2.1.3</b> Independent Events</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-probability-theory.html"><a href="2.1-probability-theory.html#conditional-probability"><i class="fa fa-check"></i><b>2.1.4</b> Conditional Probability</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html"><i class="fa fa-check"></i><b>2.2</b> Random Variables</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#univariate-distribution-and-probability-functions"><i class="fa fa-check"></i><b>2.2.1</b> Univariate Distribution and Probability Functions</a></li>
<li class="chapter" data-level="2.2.2" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#multivariate-distribution-and-probability-functions"><i class="fa fa-check"></i><b>2.2.2</b> Multivariate Distribution and Probability Functions</a></li>
<li class="chapter" data-level="2.2.3" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#means-and-moments"><i class="fa fa-check"></i><b>2.2.3</b> Means and Moments</a></li>
<li class="chapter" data-level="2.2.4" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#unconditional-means"><i class="fa fa-check"></i><b>2.2.4</b> Unconditional Means</a></li>
<li class="chapter" data-level="2.2.5" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#conditional-means"><i class="fa fa-check"></i><b>2.2.5</b> Conditional Means</a></li>
<li class="chapter" data-level="2.2.6" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#means-of-transformed-random-variables-and-moments"><i class="fa fa-check"></i><b>2.2.6</b> Means of Transformed Random Variables and Moments</a></li>
<li class="chapter" data-level="2.2.7" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#independent-random-variables"><i class="fa fa-check"></i><b>2.2.7</b> Independent Random Variables</a></li>
<li class="chapter" data-level="2.2.8" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#i.i.d.-samples"><i class="fa fa-check"></i><b>2.2.8</b> I.I.D. Samples</a></li>
<li class="chapter" data-level="2.2.9" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#some-important-discrete-random-variables"><i class="fa fa-check"></i><b>2.2.9</b> Some Important Discrete Random Variables</a></li>
<li class="chapter" data-level="2.2.10" data-path="2.2-random-variables.html"><a href="2.2-random-variables.html#some-important-continuous-random-variables"><i class="fa fa-check"></i><b>2.2.10</b> Some Important Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-ch:SLR.html"><a href="3-ch:SLR.html"><i class="fa fa-check"></i><b>3</b> Review: Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-the-simple-linear-regression-model.html"><a href="3.1-the-simple-linear-regression-model.html"><i class="fa fa-check"></i><b>3.1</b> The Simple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="" data-path="3.1-the-simple-linear-regression-model.html"><a href="3.1-the-simple-linear-regression-model.html#the-data-generating-process"><i class="fa fa-check"></i>The Data-Generating Process</a></li>
<li class="chapter" data-level="3.1.1" data-path="3.1-the-simple-linear-regression-model.html"><a href="3.1-the-simple-linear-regression-model.html#assumptions-about-the-error-term"><i class="fa fa-check"></i><b>3.1.1</b> Assumptions About the Error Term</a></li>
<li class="chapter" data-level="3.1.2" data-path="3.1-the-simple-linear-regression-model.html"><a href="3.1-the-simple-linear-regression-model.html#the-population-regression-line"><i class="fa fa-check"></i><b>3.1.2</b> The Population Regression Line</a></li>
<li class="chapter" data-level="3.1.3" data-path="3.1-the-simple-linear-regression-model.html"><a href="3.1-the-simple-linear-regression-model.html#terminology-estimates-versus-estimators"><i class="fa fa-check"></i><b>3.1.3</b> Terminology: Estimates versus Estimators</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3.2-ordinary-least-squares-estimation.html"><a href="3.2-ordinary-least-squares-estimation.html"><i class="fa fa-check"></i><b>3.2</b> Ordinary Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="3.2-ordinary-least-squares-estimation.html"><a href="3.2-ordinary-least-squares-estimation.html#terminology-sample-regression-line-prediction-and-residuals"><i class="fa fa-check"></i><b>3.2.1</b> Terminology: Sample Regression Line, Prediction and Residuals</a></li>
<li class="chapter" data-level="3.2.2" data-path="3.2-ordinary-least-squares-estimation.html"><a href="3.2-ordinary-least-squares-estimation.html#sec:SLROLS"><i class="fa fa-check"></i><b>3.2.2</b> Deriving the Expression of the OLS Estimator</a></li>
<li class="chapter" data-level="3.2.3" data-path="3.2-ordinary-least-squares-estimation.html"><a href="3.2-ordinary-least-squares-estimation.html#behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i"><i class="fa fa-check"></i><b>3.2.3</b> Behavior of the OLS Estimates for Resampled Data (conditionally on <span class="math inline">\(X_i\)</span>)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3.3-properties-of-the-ols-estimator.html"><a href="3.3-properties-of-the-ols-estimator.html"><i class="fa fa-check"></i><b>3.3</b> Properties of the OLS Estimator</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3.3-properties-of-the-ols-estimator.html"><a href="3.3-properties-of-the-ols-estimator.html#mean-and-bias-of-the-ols-estimator"><i class="fa fa-check"></i><b>3.3.1</b> Mean and Bias of the OLS Estimator</a></li>
<li class="chapter" data-level="3.3.2" data-path="3.3-properties-of-the-ols-estimator.html"><a href="3.3-properties-of-the-ols-estimator.html#variance-of-the-ols-estimator"><i class="fa fa-check"></i><b>3.3.2</b> Variance of the OLS Estimator</a></li>
<li class="chapter" data-level="3.3.3" data-path="3.3-properties-of-the-ols-estimator.html"><a href="3.3-properties-of-the-ols-estimator.html#consistency-of-the-ols-estimator"><i class="fa fa-check"></i><b>3.3.3</b> Consistency of the OLS Estimator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-ch:MLR.html"><a href="4-ch:MLR.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-assumptions.html"><a href="4.1-assumptions.html"><i class="fa fa-check"></i><b>4.1</b> Assumptions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4.1-assumptions.html"><a href="4.1-assumptions.html#some-implications-of-the-exogeneity-assumption"><i class="fa fa-check"></i><b>4.1.1</b> Some Implications of the Exogeneity Assumption</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4.2-deriving-the-expression-of-the-ols-estimator.html"><a href="4.2-deriving-the-expression-of-the-ols-estimator.html"><i class="fa fa-check"></i><b>4.2</b> Deriving the Expression of the OLS Estimator</a></li>
<li class="chapter" data-level="4.3" data-path="4.3-some-quantities-of-interest.html"><a href="4.3-some-quantities-of-interest.html"><i class="fa fa-check"></i><b>4.3</b> Some Quantities of Interest</a></li>
<li class="chapter" data-level="4.4" data-path="4.4-method-of-moments-estimator.html"><a href="4.4-method-of-moments-estimator.html"><i class="fa fa-check"></i><b>4.4</b> Method of Moments Estimator</a></li>
<li class="chapter" data-level="4.5" data-path="4.5-unbiasedness-of-hatbetax.html"><a href="4.5-unbiasedness-of-hatbetax.html"><i class="fa fa-check"></i><b>4.5</b> Unbiasedness of <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li class="chapter" data-level="4.6" data-path="4.6-ch:VarEstBeta.html"><a href="4.6-ch:VarEstBeta.html"><i class="fa fa-check"></i><b>4.6</b> Variance of <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li class="chapter" data-level="4.7" data-path="4.7-the-gauss-markov-theorem.html"><a href="4.7-the-gauss-markov-theorem.html"><i class="fa fa-check"></i><b>4.7</b> The Gauss-Markov Theorem</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-ch:SSINF.html"><a href="5-ch:SSINF.html"><i class="fa fa-check"></i><b>5</b> Small Sample Inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-ch:testmultp.html"><a href="5.1-ch:testmultp.html"><i class="fa fa-check"></i><b>5.1</b> Hypothesis Tests about Multiple Parameters</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="5.1-ch:testmultp.html"><a href="5.1-ch:testmultp.html#the-test-statistic-and-its-null-distribution"><i class="fa fa-check"></i><b>5.1.1</b> The Test Statistic and its Null Distribution</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5.2-ch:testingsinglep.html"><a href="5.2-ch:testingsinglep.html"><i class="fa fa-check"></i><b>5.2</b> Tests about One Parameter</a></li>
<li class="chapter" data-level="5.3" data-path="5.3-testtheory.html"><a href="5.3-testtheory.html"><i class="fa fa-check"></i><b>5.3</b> Testtheory</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="5.3-testtheory.html"><a href="5.3-testtheory.html#significance-level"><i class="fa fa-check"></i><b>5.3.1</b> Significance Level</a></li>
<li class="chapter" data-level="5.3.2" data-path="5.3-testtheory.html"><a href="5.3-testtheory.html#critical-value-for-the-f-test"><i class="fa fa-check"></i><b>5.3.2</b> Critical Value for the <span class="math inline">\(F\)</span>-Test</a></li>
<li class="chapter" data-level="5.3.3" data-path="5.3-testtheory.html"><a href="5.3-testtheory.html#critical-values-for-the-t-test"><i class="fa fa-check"></i><b>5.3.3</b> Critical Value(s) for the <span class="math inline">\(t\)</span>-Test</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5.4-type-ii-error-and-power.html"><a href="5.4-type-ii-error-and-power.html"><i class="fa fa-check"></i><b>5.4</b> Type II Error and Power</a></li>
<li class="chapter" data-level="5.5" data-path="5.5-p-value.html"><a href="5.5-p-value.html"><i class="fa fa-check"></i><b>5.5</b> <span class="math inline">\(p\)</span>-Value</a></li>
<li class="chapter" data-level="5.6" data-path="5.6-CIsmallsample.html"><a href="5.6-CIsmallsample.html"><i class="fa fa-check"></i><b>5.6</b> Confidence Intervals</a></li>
<li class="chapter" data-level="5.7" data-path="5.7-PSSI.html"><a href="5.7-PSSI.html"><i class="fa fa-check"></i><b>5.7</b> Practice: Small Sample Inference</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="5.7-PSSI.html"><a href="5.7-PSSI.html#normally-distributed-hatbetax"><i class="fa fa-check"></i><b>5.7.1</b> Normally Distributed <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li class="chapter" data-level="5.7.2" data-path="5.7-PSSI.html"><a href="5.7-PSSI.html#testing-multiple-parameters"><i class="fa fa-check"></i><b>5.7.2</b> Testing Multiple Parameters</a></li>
<li class="chapter" data-level="5.7.3" data-path="5.7-PSSI.html"><a href="5.7-PSSI.html#dualty-of-confidence-intervals-and-hypothesis-tests"><i class="fa fa-check"></i><b>5.7.3</b> Dualty of Confidence Intervals and Hypothesis Tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-ch:LSINF.html"><a href="6-ch:LSINF.html"><i class="fa fa-check"></i><b>6</b> Large Sample Inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html"><i class="fa fa-check"></i><b>6.1</b> Tools for Asymptotic Statistics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#modes-of-convergence"><i class="fa fa-check"></i><b>6.1.1</b> Modes of Convergence</a></li>
<li class="chapter" data-level="" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#four-important-modes-of-convergence"><i class="fa fa-check"></i>Four Important Modes of Convergence</a></li>
<li class="chapter" data-level="" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#relations-among-modes-of-convergence"><i class="fa fa-check"></i>Relations among Modes of Convergence</a></li>
<li class="chapter" data-level="6.1.2" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#continuous-mapping-theorem-cmt"><i class="fa fa-check"></i><b>6.1.2</b> Continuous Mapping Theorem (CMT)</a></li>
<li class="chapter" data-level="6.1.3" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#slutsky-theorem"><i class="fa fa-check"></i><b>6.1.3</b> Slutsky Theorem</a></li>
<li class="chapter" data-level="6.1.4" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#law-of-large-numbers-lln-and-central-limit-theorem-clt"><i class="fa fa-check"></i><b>6.1.4</b> Law of Large Numbers (LLN) and Central Limit Theorem (CLT)</a></li>
<li class="chapter" data-level="6.1.5" data-path="6.1-tools-for-asymptotic-statistics.html"><a href="6.1-tools-for-asymptotic-statistics.html#estimators-as-a-sequences-of-random-variables"><i class="fa fa-check"></i><b>6.1.5</b> Estimators as a Sequences of Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6.2-asymptotics-under-the-classic-regression-model.html"><a href="6.2-asymptotics-under-the-classic-regression-model.html"><i class="fa fa-check"></i><b>6.2</b> Asymptotics under the Classic Regression Model</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="6.2-asymptotics-under-the-classic-regression-model.html"><a href="6.2-asymptotics-under-the-classic-regression-model.html#the-case-of-heteroscedasticity"><i class="fa fa-check"></i><b>6.2.1</b> The Case of Heteroscedasticity</a></li>
<li class="chapter" data-level="6.2.2" data-path="6.2-asymptotics-under-the-classic-regression-model.html"><a href="6.2-asymptotics-under-the-classic-regression-model.html#hypothesis-testing-and-confidence-intervals"><i class="fa fa-check"></i><b>6.2.2</b> Hypothesis Testing and Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="6.3-robust-confidence-intervals.html"><a href="6.3-robust-confidence-intervals.html"><i class="fa fa-check"></i><b>6.3</b> Robust Confidence Intervals</a></li>
<li class="chapter" data-level="6.4" data-path="6.4-practice-large-sample-inference.html"><a href="6.4-practice-large-sample-inference.html"><i class="fa fa-check"></i><b>6.4</b> Practice: Large Sample Inference</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-practice-large-sample-inference.html"><a href="6.4-practice-large-sample-inference.html#normally-distributed-hatbeta-for-ntoinfty"><i class="fa fa-check"></i><b>6.4.1</b> Normally Distributed <span class="math inline">\(\hat\beta\)</span> for <span class="math inline">\(n\to\infty\)</span></a></li>
<li class="chapter" data-level="6.4.2" data-path="6.4-practice-large-sample-inference.html"><a href="6.4-practice-large-sample-inference.html#testing-multiple-and-single-parameters"><i class="fa fa-check"></i><b>6.4.2</b> Testing Multiple and Single Parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-maximum-likelihood.html"><a href="7-maximum-likelihood.html"><i class="fa fa-check"></i><b>7</b> Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-likelihood-principle.html"><a href="7.1-likelihood-principle.html"><i class="fa fa-check"></i><b>7.1</b> Likelihood Principle</a></li>
<li class="chapter" data-level="7.2" data-path="7.2-properties-of-maximum-likelihood-estimators.html"><a href="7.2-properties-of-maximum-likelihood-estimators.html"><i class="fa fa-check"></i><b>7.2</b> Properties of Maximum Likelihood Estimators</a></li>
<li class="chapter" data-level="7.3" data-path="7.3-the-log-likelihood-function.html"><a href="7.3-the-log-likelihood-function.html"><i class="fa fa-check"></i><b>7.3</b> The (Log-)Likelihood Function</a></li>
<li class="chapter" data-level="7.4" data-path="7.4-optimization-non-analytical-solutions.html"><a href="7.4-optimization-non-analytical-solutions.html"><i class="fa fa-check"></i><b>7.4</b> Optimization: Non-Analytical Solutions</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7.4-optimization-non-analytical-solutions.html"><a href="7.4-optimization-non-analytical-solutions.html#newton-raphson-optimization"><i class="fa fa-check"></i><b>7.4.1</b> Newton-Raphson Optimization</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7.5-ols-estimation-as-ml-estimation.html"><a href="7.5-ols-estimation-as-ml-estimation.html"><i class="fa fa-check"></i><b>7.5</b> OLS-Estimation as ML-Estimation</a></li>
<li class="chapter" data-level="7.6" data-path="7.6-variance-of-ml-estimators-hatbeta_ml-and-s2_ml.html"><a href="7.6-variance-of-ml-estimators-hatbeta_ml-and-s2_ml.html"><i class="fa fa-check"></i><b>7.6</b> Variance of ML-Estimators <span class="math inline">\(\hat\beta_{ML}\)</span> and <span class="math inline">\(s^2_{ML}\)</span></a></li>
<li class="chapter" data-level="7.7" data-path="7.7-consistency-of-hatbeta_ml-and-s_ml2.html"><a href="7.7-consistency-of-hatbeta_ml-and-s_ml2.html"><i class="fa fa-check"></i><b>7.7</b> Consistency of <span class="math inline">\(\hat\beta_{ML}\)</span> and <span class="math inline">\(s_{ML}^2\)</span></a></li>
<li class="chapter" data-level="7.8" data-path="7.8-asymptotic-theory-of-maximum-likelihood-estimators.html"><a href="7.8-asymptotic-theory-of-maximum-likelihood-estimators.html"><i class="fa fa-check"></i><b>7.8</b> Asymptotic Theory of Maximum-Likelihood Estimators</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-ivr.html"><a href="8-ivr.html"><i class="fa fa-check"></i><b>8</b> Instrumental Variables Regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-TIVEWASRAASI.html"><a href="8.1-TIVEWASRAASI.html"><i class="fa fa-check"></i><b>8.1</b> The IV Estimator with a Single Regressor and a Single Instrument</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-TIVEWASRAASI.html"><a href="8.1-TIVEWASRAASI.html#the-two-stage-least-squares-estimator"><i class="fa fa-check"></i><b>8.1.1</b> The Two-Stage Least Squares Estimator</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-TIVEWASRAASI.html"><a href="8.1-TIVEWASRAASI.html#application-demand-for-cigarettes-12"><i class="fa fa-check"></i><b>8.1.2</b> Application: Demand For Cigarettes (1/2)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-TGIVRM.html"><a href="8.2-TGIVRM.html"><i class="fa fa-check"></i><b>8.2</b> The General IV Regression Model</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8.2-TGIVRM.html"><a href="8.2-TGIVRM.html#application-demand-for-cigarettes-22"><i class="fa fa-check"></i><b>8.2.1</b> Application: Demand for Cigarettes (2/2)</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8.3-civ.html"><a href="8.3-civ.html"><i class="fa fa-check"></i><b>8.3</b> Checking Instrument Validity</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="8.3-civ.html"><a href="8.3-civ.html#instrument-relevance"><i class="fa fa-check"></i><b>8.3.1</b> Instrument Relevance</a></li>
<li class="chapter" data-level="8.3.2" data-path="8.3-civ.html"><a href="8.3-civ.html#instrument-validity"><i class="fa fa-check"></i><b>8.3.2</b> Instrument Validity</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="8.4-attdfc.html"><a href="8.4-attdfc.html"><i class="fa fa-check"></i><b>8.4</b> Application to the Demand for Cigarettes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometrics (M.Sc.)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="attdfc" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Application to the Demand for Cigarettes</h2>
<p>Are the general sales tax and the cigarette-specific tax valid instruments? If not, TSLS is not helpful to estimate the demand elasticity for cigarettes discussed in Chapter <a href="8.2-TGIVRM.html#TGIVRM">8.2</a>. As discussed in Chapter <a href="8.1-TIVEWASRAASI.html#TIVEWASRAASI">8.1</a>, both variables are likely to be relevant but whether they are exogenous is a different question.</p>
<p>One can argue that cigarette-specific taxes could be endogenous because there might be state specific historical factors like economic importance of the tobacco farming and cigarette production industry that lobby for low cigarette specific taxes. Since it is plausible that tobacco growing states have higher rates of smoking than others, this would lead to endogeneity of cigarette specific taxes. If we had data on the size on the tobacco and cigarette industry, we could solve this potential issue by including the information in the regression. Unfortunately, this is not the case.</p>
<p>However, since the role of the tobacco and cigarette industry is a factor that can be assumed to differ across states but not over time we may exploit the panel structure of <code>CigarettesSW</code>. Alternatively, a (non-panel) regression using data on <em>changes</em> between two time periods eliminates such state specific and time invariant effects. Next, we consider such changes in variables between 1985 and 1995. That is, we are interested in estimating the <em>long-run elasticity</em> of the demand for cigarettes.</p>
<p>The model to be estimated by TSLS using the general sales tax and the cigarette-specific sales tax as instruments hence is
<span class="math display" id="eq:diffivreg">\[\begin{align}
\begin{split}
  \log(Q_{i,1995}^{cigarettes}) - \log(Q_{i,1985}^{cigarettes}) =
  &amp; \, \beta_1 + \beta_2 \left[\log(P_{i,1995}^{cigarettes}) - \log(P_{i,1985}^{cigarettes}) \right] \\ 
  &amp;+ \beta_3 \left[\log(income_{i,1995}) - \log(income_{i,1985})\right] + \eps_i. \end{split}\tag{8.1}
\end{align}\]</span></p>
<p>We first create differences from 1985 to 1995 for the dependent variable, the regressors and both instruments.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="8.4-attdfc.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset data for year 1985</span></span>
<span id="cb110-2"><a href="8.4-attdfc.html#cb110-2" aria-hidden="true" tabindex="-1"></a>c1985 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1985&quot;</span>)</span>
<span id="cb110-3"><a href="8.4-attdfc.html#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="8.4-attdfc.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define differences in variables</span></span>
<span id="cb110-5"><a href="8.4-attdfc.html#cb110-5" aria-hidden="true" tabindex="-1"></a>packsdiff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>packs) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>packs)</span>
<span id="cb110-6"><a href="8.4-attdfc.html#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="8.4-attdfc.html#cb110-7" aria-hidden="true" tabindex="-1"></a>pricediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>price<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>price<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb110-8"><a href="8.4-attdfc.html#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="8.4-attdfc.html#cb110-9" aria-hidden="true" tabindex="-1"></a>incomediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>income<span class="sc">/</span>c1995<span class="sc">$</span>population<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span></span>
<span id="cb110-10"><a href="8.4-attdfc.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(c1985<span class="sc">$</span>income<span class="sc">/</span>c1985<span class="sc">$</span>population<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb110-11"><a href="8.4-attdfc.html#cb110-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-12"><a href="8.4-attdfc.html#cb110-12" aria-hidden="true" tabindex="-1"></a>salestaxdiff <span class="ot">&lt;-</span> (c1995<span class="sc">$</span>taxs <span class="sc">-</span> c1995<span class="sc">$</span>tax)<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> (c1985<span class="sc">$</span>taxs <span class="sc">-</span> c1985<span class="sc">$</span>tax)<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span>
<span id="cb110-13"><a href="8.4-attdfc.html#cb110-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-14"><a href="8.4-attdfc.html#cb110-14" aria-hidden="true" tabindex="-1"></a>cigtaxdiff <span class="ot">&lt;-</span> c1995<span class="sc">$</span>tax<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> c1985<span class="sc">$</span>tax<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span></code></pre></div>
<p>We now perform three different IV estimations of <a href="8.4-attdfc.html#eq:diffivreg">(8.1)</a> using <code>ivreg()</code>:</p>
<ol style="list-style-type: decimal">
<li><p>TSLS using only the difference in the sales taxes between 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using only the difference in the cigarette-specific sales taxes 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using both the difference in the sales taxes 1985 and 1995 and the difference in the cigarette-specific sales taxes 1985 and 1995 as instruments.</p></li>
</ol>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="8.4-attdfc.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the three models</span></span>
<span id="cb111-2"><a href="8.4-attdfc.html#cb111-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff1 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb111-3"><a href="8.4-attdfc.html#cb111-3" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb111-4"><a href="8.4-attdfc.html#cb111-4" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff)</span>
<span id="cb111-5"><a href="8.4-attdfc.html#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="8.4-attdfc.html#cb111-6" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb111-7"><a href="8.4-attdfc.html#cb111-7" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb111-8"><a href="8.4-attdfc.html#cb111-8" aria-hidden="true" tabindex="-1"></a>                         cigtaxdiff)</span>
<span id="cb111-9"><a href="8.4-attdfc.html#cb111-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-10"><a href="8.4-attdfc.html#cb111-10" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb111-11"><a href="8.4-attdfc.html#cb111-11" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb111-12"><a href="8.4-attdfc.html#cb111-12" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff <span class="sc">+</span> cigtaxdiff)</span></code></pre></div>
<p>As usual we use <code>coeftest()</code> in conjunction with <code>vcovHC()</code> to obtain robust coefficient summaries for all models.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="8.4-attdfc.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 1.</span></span>
<span id="cb112-2"><a href="8.4-attdfc.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff1, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb112-3"><a href="8.4-attdfc.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-4"><a href="8.4-attdfc.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb112-5"><a href="8.4-attdfc.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-6"><a href="8.4-attdfc.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb112-7"><a href="8.4-attdfc.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.117962   0.068217 -1.7292   0.09062 .  </span></span>
<span id="cb112-8"><a href="8.4-attdfc.html#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -0.938014   0.207502 -4.5205 4.454e-05 ***</span></span>
<span id="cb112-9"><a href="8.4-attdfc.html#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.525970   0.339494  1.5493   0.12832    </span></span>
<span id="cb112-10"><a href="8.4-attdfc.html#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb112-11"><a href="8.4-attdfc.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb112-12"><a href="8.4-attdfc.html#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="8.4-attdfc.html#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 2.</span></span>
<span id="cb112-14"><a href="8.4-attdfc.html#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb112-15"><a href="8.4-attdfc.html#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-16"><a href="8.4-attdfc.html#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb112-17"><a href="8.4-attdfc.html#cb112-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-18"><a href="8.4-attdfc.html#cb112-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb112-19"><a href="8.4-attdfc.html#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.017049   0.067217 -0.2536    0.8009    </span></span>
<span id="cb112-20"><a href="8.4-attdfc.html#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -1.342515   0.228661 -5.8712 4.848e-07 ***</span></span>
<span id="cb112-21"><a href="8.4-attdfc.html#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.428146   0.298718  1.4333    0.1587    </span></span>
<span id="cb112-22"><a href="8.4-attdfc.html#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb112-23"><a href="8.4-attdfc.html#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb112-24"><a href="8.4-attdfc.html#cb112-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-25"><a href="8.4-attdfc.html#cb112-25" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 3.</span></span>
<span id="cb112-26"><a href="8.4-attdfc.html#cb112-26" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb112-27"><a href="8.4-attdfc.html#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-28"><a href="8.4-attdfc.html#cb112-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb112-29"><a href="8.4-attdfc.html#cb112-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-30"><a href="8.4-attdfc.html#cb112-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb112-31"><a href="8.4-attdfc.html#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.052003   0.062488 -0.8322    0.4097    </span></span>
<span id="cb112-32"><a href="8.4-attdfc.html#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -1.202403   0.196943 -6.1053 2.178e-07 ***</span></span>
<span id="cb112-33"><a href="8.4-attdfc.html#cb112-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.462030   0.309341  1.4936    0.1423    </span></span>
<span id="cb112-34"><a href="8.4-attdfc.html#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb112-35"><a href="8.4-attdfc.html#cb112-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We proceed by generating a tabulated summary of the estimation results using <code>stargazer()</code>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="8.4-attdfc.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb113-2"><a href="8.4-attdfc.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb113-3"><a href="8.4-attdfc.html#cb113-3" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb113-4"><a href="8.4-attdfc.html#cb113-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb113-5"><a href="8.4-attdfc.html#cb113-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb113-6"><a href="8.4-attdfc.html#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="8.4-attdfc.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table</span></span>
<span id="cb113-8"><a href="8.4-attdfc.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(cig_ivreg_diff1, cig_ivreg_diff2, cig_ivreg_diff3,</span>
<span id="cb113-9"><a href="8.4-attdfc.html#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb113-10"><a href="8.4-attdfc.html#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb113-11"><a href="8.4-attdfc.html#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb113-12"><a href="8.4-attdfc.html#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb113-13"><a href="8.4-attdfc.html#cb113-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;IV: salestax&quot;</span>, <span class="st">&quot;IV: cigtax&quot;</span>, </span>
<span id="cb113-14"><a href="8.4-attdfc.html#cb113-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;IVs: salestax, cigtax&quot;</span>),</span>
<span id="cb113-15"><a href="8.4-attdfc.html#cb113-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-16"><a href="8.4-attdfc.html#cb113-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption =</span> </span>
<span id="cb113-17"><a href="8.4-attdfc.html#cb113-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Dependent Variable: 1985-1995 Difference in Log per Pack Price&quot;</span>,</span>
<span id="cb113-18"><a href="8.4-attdfc.html#cb113-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se)</span></code></pre></div>


<!-- ```{r, message=F, warning=F, results='asis', echo=F, purl=F, eval=my_output == "html"} -->
<!-- # gather robust standard errors in a list -->
<!-- rob_se <- list(sqrt(diag(vcovHC(cig_ivreg_diff1, type = "HC1"))), -->
<!--                sqrt(diag(vcovHC(cig_ivreg_diff2, type = "HC1"))), -->
<!--                sqrt(diag(vcovHC(cig_ivreg_diff3, type = "HC1")))) -->

<!-- stargazer(cig_ivreg_diff1, cig_ivreg_diff2,cig_ivreg_diff3, -->
<!--   header = FALSE,  -->
<!--   type = "html", -->
<!--   digits = 3,  -->
<!--   column.labels = c("IV: salestax", "IV: cigtax", "IVs: salestax, cigtax"), -->
<!--   dep.var.labels.include = FALSE, -->
<!--   dep.var.caption = "Dependent variable: 1985-1995 difference in log per pack price", -->
<!--   se = rob_se) -->

<!-- stargazer_html_title("TSLS Estimates of the Long-Term Elasticity of the Demand for Cigarettes using Panel Data", "tslseotlteotdfcupd") -->
<!-- ``` -->


<p>Table <a href="#tab:tslseotlteotdfcupd"><strong>??</strong></a> reports negative estimates of the coefficient on <code>pricediff</code> that are quite different in magnitude. Which one should we trust? This hinges on the validity of the instruments used. To assess this we compute <span class="math inline">\(F\)</span>-statistics for the first-stage regressions of all three models to check instrument relevance.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="8.4-attdfc.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first-stage regressions</span></span>
<span id="cb114-2"><a href="8.4-attdfc.html#cb114-2" aria-hidden="true" tabindex="-1"></a>mod_relevance1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> salestaxdiff <span class="sc">+</span> incomediff)</span>
<span id="cb114-3"><a href="8.4-attdfc.html#cb114-3" aria-hidden="true" tabindex="-1"></a>mod_relevance2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> cigtaxdiff   <span class="sc">+</span> incomediff)</span>
<span id="cb114-4"><a href="8.4-attdfc.html#cb114-4" aria-hidden="true" tabindex="-1"></a>mod_relevance3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> incomediff   <span class="sc">+</span> salestaxdiff <span class="sc">+</span> </span>
<span id="cb114-5"><a href="8.4-attdfc.html#cb114-5" aria-hidden="true" tabindex="-1"></a>                                                cigtaxdiff)</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="8.4-attdfc.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (1)</span></span>
<span id="cb115-2"><a href="8.4-attdfc.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance1, </span>
<span id="cb115-3"><a href="8.4-attdfc.html#cb115-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;salestaxdiff = 0&quot;</span>, </span>
<span id="cb115-4"><a href="8.4-attdfc.html#cb115-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb115-5"><a href="8.4-attdfc.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb115-6"><a href="8.4-attdfc.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-7"><a href="8.4-attdfc.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb115-8"><a href="8.4-attdfc.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb115-9"><a href="8.4-attdfc.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-10"><a href="8.4-attdfc.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb115-11"><a href="8.4-attdfc.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ salestaxdiff + incomediff</span></span>
<span id="cb115-12"><a href="8.4-attdfc.html#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-13"><a href="8.4-attdfc.html#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb115-14"><a href="8.4-attdfc.html#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-15"><a href="8.4-attdfc.html#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb115-16"><a href="8.4-attdfc.html#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                        </span></span>
<span id="cb115-17"><a href="8.4-attdfc.html#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     45  1 28.445 3.009e-06 ***</span></span>
<span id="cb115-18"><a href="8.4-attdfc.html#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb115-19"><a href="8.4-attdfc.html#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="8.4-attdfc.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (2)</span></span>
<span id="cb116-2"><a href="8.4-attdfc.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance2, </span>
<span id="cb116-3"><a href="8.4-attdfc.html#cb116-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;cigtaxdiff = 0&quot;</span>, </span>
<span id="cb116-4"><a href="8.4-attdfc.html#cb116-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb116-5"><a href="8.4-attdfc.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb116-6"><a href="8.4-attdfc.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-7"><a href="8.4-attdfc.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb116-8"><a href="8.4-attdfc.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb116-9"><a href="8.4-attdfc.html#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-10"><a href="8.4-attdfc.html#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb116-11"><a href="8.4-attdfc.html#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ cigtaxdiff + incomediff</span></span>
<span id="cb116-12"><a href="8.4-attdfc.html#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-13"><a href="8.4-attdfc.html#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb116-14"><a href="8.4-attdfc.html#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb116-15"><a href="8.4-attdfc.html#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)    </span></span>
<span id="cb116-16"><a href="8.4-attdfc.html#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                       </span></span>
<span id="cb116-17"><a href="8.4-attdfc.html#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     45  1 98.034 7.09e-13 ***</span></span>
<span id="cb116-18"><a href="8.4-attdfc.html#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb116-19"><a href="8.4-attdfc.html#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="8.4-attdfc.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (3)</span></span>
<span id="cb117-2"><a href="8.4-attdfc.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance3, </span>
<span id="cb117-3"><a href="8.4-attdfc.html#cb117-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;salestaxdiff = 0&quot;</span>, <span class="st">&quot;cigtaxdiff = 0&quot;</span>), </span>
<span id="cb117-4"><a href="8.4-attdfc.html#cb117-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb117-5"><a href="8.4-attdfc.html#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb117-6"><a href="8.4-attdfc.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-7"><a href="8.4-attdfc.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb117-8"><a href="8.4-attdfc.html#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb117-9"><a href="8.4-attdfc.html#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb117-10"><a href="8.4-attdfc.html#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-11"><a href="8.4-attdfc.html#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb117-12"><a href="8.4-attdfc.html#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ incomediff + salestaxdiff + cigtaxdiff</span></span>
<span id="cb117-13"><a href="8.4-attdfc.html#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-14"><a href="8.4-attdfc.html#cb117-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb117-15"><a href="8.4-attdfc.html#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb117-16"><a href="8.4-attdfc.html#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb117-17"><a href="8.4-attdfc.html#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                        </span></span>
<span id="cb117-18"><a href="8.4-attdfc.html#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     44  2 76.916 4.339e-15 ***</span></span>
<span id="cb117-19"><a href="8.4-attdfc.html#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb117-20"><a href="8.4-attdfc.html#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>All <span class="math inline">\(F\)</span>-statistics are larger than <span class="math inline">\(10\)</span>; so, the rule of thumb for detecting weak instruments would suggest that the instruments are not weak.</p>
<p>Next, we also conduct the overidentifying restrictions test for model three which is the only model where the coefficient on the difference in log prices is overidentified (<span class="math inline">\(m=2\)</span>, <span class="math inline">\((K-1)=1\)</span>) such that the <span class="math inline">\(J\)</span>-statistic can be computed. To do this we take the residuals stored in <code>cig_ivreg_diff3</code> and regress them on both instruments and the presumably exogenous regressor <code>incomediff</code>. We again use <code>linearHypothesis()</code> to test whether the coefficients on both instruments are zero which is necessary for the exogeneity assumption to be fulfilled. Note that with <code>test = "Chisq"</code> we obtain a chi-squared distributed test statistic instead of an <span class="math inline">\(F\)</span>-statistic.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="8.4-attdfc.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the J-statistic</span></span>
<span id="cb118-2"><a href="8.4-attdfc.html#cb118-2" aria-hidden="true" tabindex="-1"></a>cig_iv_OR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">residuals</span>(cig_ivreg_diff3) <span class="sc">~</span> incomediff <span class="sc">+</span> </span>
<span id="cb118-3"><a href="8.4-attdfc.html#cb118-3" aria-hidden="true" tabindex="-1"></a>                                 salestaxdiff <span class="sc">+</span> cigtaxdiff)</span>
<span id="cb118-4"><a href="8.4-attdfc.html#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="8.4-attdfc.html#cb118-5" aria-hidden="true" tabindex="-1"></a>cig_OR_test <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(cig_iv_OR, </span>
<span id="cb118-6"><a href="8.4-attdfc.html#cb118-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;salestaxdiff = 0&quot;</span>, </span>
<span id="cb118-7"><a href="8.4-attdfc.html#cb118-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;cigtaxdiff = 0&quot;</span>), </span>
<span id="cb118-8"><a href="8.4-attdfc.html#cb118-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb118-9"><a href="8.4-attdfc.html#cb118-9" aria-hidden="true" tabindex="-1"></a>cig_OR_test</span>
<span id="cb118-10"><a href="8.4-attdfc.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb118-11"><a href="8.4-attdfc.html#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-12"><a href="8.4-attdfc.html#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb118-13"><a href="8.4-attdfc.html#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb118-14"><a href="8.4-attdfc.html#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb118-15"><a href="8.4-attdfc.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-16"><a href="8.4-attdfc.html#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb118-17"><a href="8.4-attdfc.html#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: residuals(cig_ivreg_diff3) ~ incomediff + salestaxdiff + cigtaxdiff</span></span>
<span id="cb118-18"><a href="8.4-attdfc.html#cb118-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-19"><a href="8.4-attdfc.html#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df     RSS Df Sum of Sq Chisq Pr(&gt;Chisq)  </span></span>
<span id="cb118-20"><a href="8.4-attdfc.html#cb118-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46 0.37472                                </span></span>
<span id="cb118-21"><a href="8.4-attdfc.html#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     44 0.33695  2  0.037769 4.932    0.08492 .</span></span>
<span id="cb118-22"><a href="8.4-attdfc.html#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb118-23"><a href="8.4-attdfc.html#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Caution</strong>: In this case the <span class="math inline">\(p\)</span>-value reported by <code>linearHypothesis()</code> is wrong because the degrees of freedom are set to <span class="math inline">\(2\)</span>. This differs from the degree of overidentification (<span class="math inline">\(m-(K-1)=2-(2-1)=1\)</span>) so the <span class="math inline">\(J\)</span>-statistic is <span class="math inline">\(\chi^2_1\)</span> distributed instead of following a <span class="math inline">\(\chi^2_2\)</span> distribution as assumed defaultly by <code>linearHypothesis()</code>. We may compute the correct <span class="math inline">\(p\)</span>-value using <code>pchisq()</code>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="8.4-attdfc.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute correct p-value for J-statistic</span></span>
<span id="cb119-2"><a href="8.4-attdfc.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(cig_OR_test[<span class="dv">2</span>, <span class="dv">5</span>], <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb119-3"><a href="8.4-attdfc.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02636406</span></span></code></pre></div>
<p>Since this value is smaller than <span class="math inline">\(0.05\)</span> we reject the hypothesis that both instruments are exogenous at the level of <span class="math inline">\(5\%\)</span>. This means one of the following:</p>
<ol style="list-style-type: decimal">
<li>The sales tax is an invalid instrument for the per-pack price.</li>
<li>The cigarettes-specific sales tax is an invalid instrument for the per-pack price.</li>
<li>Both instruments are invalid.</li>
</ol>
<p>One can argue that the assumption of instrument exogeneity is more likely to hold for the general sales tax such that the IV estimate of the long-run elasticity of demand for cigarettes we consider the most trustworthy is <span class="math inline">\(-0.94\)</span>, the TSLS estimate obtained using the general sales tax as the only instrument.</p>
<p>The interpretation of this estimate is that over a 10-year period, an increase in the average price per package by one percent is expected to decrease consumption by about <span class="math inline">\(0.94\)</span> percentage points. This suggests that, in the long run, price increases can reduce cigarette consumption considerably.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="8.3-civ.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Script_Econometrics_MSc.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
