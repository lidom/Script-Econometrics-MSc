<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 The General IV Regression Model | Econometrics (M.Sc.)</title>
  <meta name="description" content="6.2 The General IV Regression Model | Econometrics (M.Sc.)" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 The General IV Regression Model | Econometrics (M.Sc.)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/mylogo.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 The General IV Regression Model | Econometrics (M.Sc.)" />
  
  
  <meta name="twitter:image" content="/images/mylogo.png" />

<meta name="author" content="Prof. Dr. Dominik Liebl" />


<meta name="date" content="2022-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="TIVEWASRAASI.html"/>
<link rel="next" href="civ.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#organization-of-the-course" id="toc-organization-of-the-course">Organization of the Course</a></li>
<li><a href="index.html#literature" id="toc-literature">Literature</a></li>
</ul></li>
<li><a href="introduction-to-r.html#introduction-to-r" id="toc-introduction-to-r"><span class="toc-section-number">1</span> Introduction to R</a>
<ul>
<li><a href="short-glossary.html#short-glossary" id="toc-short-glossary"><span class="toc-section-number">1.1</span> Short Glossary</a></li>
<li><a href="first-steps.html#first-steps" id="toc-first-steps"><span class="toc-section-number">1.2</span> First Steps</a></li>
<li><a href="further-data-objects.html#further-data-objects" id="toc-further-data-objects"><span class="toc-section-number">1.3</span> Further Data Objects</a></li>
<li><a href="simple-regression-analysis-using-r.html#simple-regression-analysis-using-r" id="toc-simple-regression-analysis-using-r"><span class="toc-section-number">1.4</span> Simple Regression Analysis using R</a></li>
<li><a href="programming-in-r.html#programming-in-r" id="toc-programming-in-r"><span class="toc-section-number">1.5</span> Programming in R</a></li>
<li><a href="r-packages.html#r-packages" id="toc-r-packages"><span class="toc-section-number">1.6</span> R-packages</a></li>
<li><a href="tidyverse.html#tidyverse" id="toc-tidyverse"><span class="toc-section-number">1.7</span> Tidyverse</a>
<ul>
<li><a href="tidyverse.html#tidyverse-plotting-basics" id="toc-tidyverse-plotting-basics"><span class="toc-section-number">1.7.1</span> Tidyverse: Plotting Basics</a></li>
<li><a href="tidyverse.html#tidyverse-data-wrangling-basics" id="toc-tidyverse-data-wrangling-basics"><span class="toc-section-number">1.7.2</span> Tidyverse: Data Wrangling Basics</a></li>
<li><a href="tidyverse.html#the-pipe-operator" id="toc-the-pipe-operator"><span class="toc-section-number">1.7.3</span> The pipe operator <code>%&gt;%</code></a></li>
<li><a href="tidyverse.html#the-group_by-function" id="toc-the-group_by-function"><span class="toc-section-number">1.7.4</span> The <code>group_by()</code> function</a></li>
</ul></li>
<li><a href="further-links.html#further-links" id="toc-further-links"><span class="toc-section-number">1.8</span> Further Links</a>
<ul>
<li><a href="further-links.html#further-r-intros" id="toc-further-r-intros"><span class="toc-section-number">1.8.1</span> Further R-Intros</a></li>
<li><a href="further-links.html#version-control-gitgithub" id="toc-version-control-gitgithub"><span class="toc-section-number">1.8.2</span> Version Control (Git/GitHub)</a></li>
<li><a href="further-links.html#r-ladies" id="toc-r-ladies"><span class="toc-section-number">1.8.3</span> R-Ladies</a></li>
</ul></li>
</ul></li>
<li><a href="ReviewStats.html#ReviewStats" id="toc-ReviewStats"><span class="toc-section-number">2</span> Review: Probability and Statistics</a>
<ul>
<li><a href="probability-theory.html#probability-theory" id="toc-probability-theory"><span class="toc-section-number">2.1</span> Probability Theory</a>
<ul>
<li><a href="probability-theory.html#sample-spaces-and-elementary-events" id="toc-sample-spaces-and-elementary-events"><span class="toc-section-number">2.1.1</span> Sample Spaces and (Elementary) Events</a></li>
<li><a href="probability-theory.html#probability" id="toc-probability"><span class="toc-section-number">2.1.2</span> Probability</a></li>
<li><a href="probability-theory.html#independent-events" id="toc-independent-events"><span class="toc-section-number">2.1.3</span> Independent Events</a></li>
<li><a href="probability-theory.html#conditional-probability" id="toc-conditional-probability"><span class="toc-section-number">2.1.4</span> Conditional Probability</a></li>
</ul></li>
<li><a href="random-variables.html#random-variables" id="toc-random-variables"><span class="toc-section-number">2.2</span> Random Variables</a>
<ul>
<li><a href="random-variables.html#univariate-distribution-and-probability-functions" id="toc-univariate-distribution-and-probability-functions"><span class="toc-section-number">2.2.1</span> Univariate Distribution and Probability Functions</a></li>
<li><a href="random-variables.html#multivariate-distribution-and-probability-functions" id="toc-multivariate-distribution-and-probability-functions"><span class="toc-section-number">2.2.2</span> Multivariate Distribution and Probability Functions</a></li>
<li><a href="random-variables.html#means-and-moments" id="toc-means-and-moments"><span class="toc-section-number">2.2.3</span> Means and Moments</a></li>
<li><a href="random-variables.html#unconditional-means" id="toc-unconditional-means"><span class="toc-section-number">2.2.4</span> Unconditional Means</a></li>
<li><a href="random-variables.html#conditional-means" id="toc-conditional-means"><span class="toc-section-number">2.2.5</span> Conditional Means</a></li>
<li><a href="random-variables.html#means-of-transformed-random-variables-and-moments" id="toc-means-of-transformed-random-variables-and-moments"><span class="toc-section-number">2.2.6</span> Means of Transformed Random Variables and Moments</a></li>
<li><a href="random-variables.html#independent-random-variables" id="toc-independent-random-variables"><span class="toc-section-number">2.2.7</span> Independent Random Variables</a></li>
<li><a href="random-variables.html#i.i.d.-samples" id="toc-i.i.d.-samples"><span class="toc-section-number">2.2.8</span> I.I.D. Samples</a></li>
<li><a href="random-variables.html#some-important-discrete-random-variables" id="toc-some-important-discrete-random-variables"><span class="toc-section-number">2.2.9</span> Some Important Discrete Random Variables</a></li>
<li><a href="random-variables.html#some-important-continuous-random-variables" id="toc-some-important-continuous-random-variables"><span class="toc-section-number">2.2.10</span> Some Important Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li><a href="ch:MLR.html#ch:MLR" id="toc-ch:MLR"><span class="toc-section-number">3</span> Multiple Linear Regression</a>
<ul>
<li><a href="assumptions.html#assumptions" id="toc-assumptions"><span class="toc-section-number">3.1</span> Assumptions</a>
<ul>
<li><a href="assumptions.html#some-implications-of-the-exogeneity-assumption" id="toc-some-implications-of-the-exogeneity-assumption"><span class="toc-section-number">3.1.1</span> Some Implications of the Exogeneity Assumption</a></li>
</ul></li>
<li><a href="deriving-the-expression-of-the-ols-estimator.html#deriving-the-expression-of-the-ols-estimator" id="toc-deriving-the-expression-of-the-ols-estimator"><span class="toc-section-number">3.2</span> Deriving the Expression of the OLS Estimator</a></li>
<li><a href="some-quantities-of-interest.html#some-quantities-of-interest" id="toc-some-quantities-of-interest"><span class="toc-section-number">3.3</span> Some Quantities of Interest</a></li>
<li><a href="method-of-moments-estimator.html#method-of-moments-estimator" id="toc-method-of-moments-estimator"><span class="toc-section-number">3.4</span> Method of Moments Estimator</a></li>
<li><a href="unbiasedness-of-hatbetax-and-hatbeta.html#unbiasedness-of-hatbetax-and-hatbeta" id="toc-unbiasedness-of-hatbetax-and-hatbeta"><span class="toc-section-number">3.5</span> Unbiasedness of <span class="math inline">\(\hat\beta|X\)</span> and <span class="math inline">\(\hat\beta\)</span></a></li>
<li><a href="ch:VarEstBeta.html#ch:VarEstBeta" id="toc-ch:VarEstBeta"><span class="toc-section-number">3.6</span> Variance and Standard Error of <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li><a href="the-gauss-markov-theorem.html#the-gauss-markov-theorem" id="toc-the-gauss-markov-theorem"><span class="toc-section-number">3.7</span> The Gauss-Markov Theorem</a></li>
<li><a href="practice-real-data.html#practice-real-data" id="toc-practice-real-data"><span class="toc-section-number">3.8</span> Practice: Real Data</a>
<ul>
<li><a href="practice-real-data.html#dummy-variables-contrast-codings-and-interactions" id="toc-dummy-variables-contrast-codings-and-interactions">Dummy Variables, Contrast Codings, and Interactions</a></li>
<li><a href="practice-real-data.html#the-function" id="toc-the-function">The Function </a></li>
</ul></li>
<li><a href="practice-simulation.html#practice-simulation" id="toc-practice-simulation"><span class="toc-section-number">3.9</span> Practice: Simulation</a>
<ul>
<li><a href="practice-simulation.html#behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i" id="toc-behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i"><span class="toc-section-number">3.9.1</span> Behavior of the OLS Estimates for Resampled Data (conditionally on <span class="math inline">\(X_i\)</span>)</a></li>
</ul></li>
</ul></li>
<li><a href="ch:SSINF.html#ch:SSINF" id="toc-ch:SSINF"><span class="toc-section-number">4</span> Small Sample Inference</a>
<ul>
<li><a href="ch:testmultp.html#ch:testmultp" id="toc-ch:testmultp"><span class="toc-section-number">4.1</span> Hypothesis Tests about Multiple Parameters</a>
<ul>
<li><a href="ch:testmultp.html#the-test-statistic-and-its-null-distribution" id="toc-the-test-statistic-and-its-null-distribution"><span class="toc-section-number">4.1.1</span> The Test Statistic and its Null Distribution</a></li>
</ul></li>
<li><a href="ch:testingsinglep.html#ch:testingsinglep" id="toc-ch:testingsinglep"><span class="toc-section-number">4.2</span> Tests about One Parameter</a></li>
<li><a href="testtheory.html#testtheory" id="toc-testtheory"><span class="toc-section-number">4.3</span> Testtheory</a>
<ul>
<li><a href="testtheory.html#significance-level" id="toc-significance-level"><span class="toc-section-number">4.3.1</span> Significance Level</a></li>
<li><a href="testtheory.html#critical-value-for-the-f-test" id="toc-critical-value-for-the-f-test"><span class="toc-section-number">4.3.2</span> Critical Value for the <span class="math inline">\(F\)</span>-Test</a></li>
<li><a href="testtheory.html#critical-values-for-the-t-test" id="toc-critical-values-for-the-t-test"><span class="toc-section-number">4.3.3</span> Critical Value(s) for the <span class="math inline">\(t\)</span>-Test</a></li>
</ul></li>
<li><a href="type-ii-error-and-power.html#type-ii-error-and-power" id="toc-type-ii-error-and-power"><span class="toc-section-number">4.4</span> Type II Error and Power</a></li>
<li><a href="p-value.html#p-value" id="toc-p-value"><span class="toc-section-number">4.5</span> <span class="math inline">\(p\)</span>-Value</a></li>
<li><a href="CIsmallsample.html#CIsmallsample" id="toc-CIsmallsample"><span class="toc-section-number">4.6</span> Confidence Intervals</a></li>
<li><a href="PSSI.html#PSSI" id="toc-PSSI"><span class="toc-section-number">4.7</span> Practice: Small Sample Inference</a>
<ul>
<li><a href="PSSI.html#normally-distributed-hatbetax" id="toc-normally-distributed-hatbetax"><span class="toc-section-number">4.7.1</span> Normally Distributed <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li><a href="PSSI.html#testing-multiple-parameters" id="toc-testing-multiple-parameters"><span class="toc-section-number">4.7.2</span> Testing Multiple Parameters</a></li>
<li><a href="PSSI.html#dualty-of-confidence-intervals-and-hypothesis-tests" id="toc-dualty-of-confidence-intervals-and-hypothesis-tests"><span class="toc-section-number">4.7.3</span> Dualty of Confidence Intervals and Hypothesis Tests</a></li>
</ul></li>
</ul></li>
<li><a href="ch:LSINF.html#ch:LSINF" id="toc-ch:LSINF"><span class="toc-section-number">5</span> Large Sample Inference</a>
<ul>
<li><a href="tools-for-asymptotic-statistics.html#tools-for-asymptotic-statistics" id="toc-tools-for-asymptotic-statistics"><span class="toc-section-number">5.1</span> Tools for Asymptotic Statistics</a>
<ul>
<li><a href="tools-for-asymptotic-statistics.html#modes-of-convergence" id="toc-modes-of-convergence"><span class="toc-section-number">5.1.1</span> Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#four-important-modes-of-convergence" id="toc-four-important-modes-of-convergence">Four Important Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#relations-among-modes-of-convergence" id="toc-relations-among-modes-of-convergence">Relations among Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#continuous-mapping-theorem-cmt" id="toc-continuous-mapping-theorem-cmt"><span class="toc-section-number">5.1.2</span> Continuous Mapping Theorem (CMT)</a></li>
<li><a href="tools-for-asymptotic-statistics.html#slutsky-theorem" id="toc-slutsky-theorem"><span class="toc-section-number">5.1.3</span> Slutsky Theorem</a></li>
<li><a href="tools-for-asymptotic-statistics.html#law-of-large-numbers-lln-and-central-limit-theorem-clt" id="toc-law-of-large-numbers-lln-and-central-limit-theorem-clt"><span class="toc-section-number">5.1.4</span> Law of Large Numbers (LLN) and Central Limit Theorem (CLT)</a></li>
<li><a href="tools-for-asymptotic-statistics.html#estimators-as-a-sequences-of-random-variables" id="toc-estimators-as-a-sequences-of-random-variables"><span class="toc-section-number">5.1.5</span> Estimators as a Sequences of Random Variables</a></li>
</ul></li>
<li><a href="asymptotics-under-the-classic-regression-model.html#asymptotics-under-the-classic-regression-model" id="toc-asymptotics-under-the-classic-regression-model"><span class="toc-section-number">5.2</span> Asymptotics under the Classic Regression Model</a>
<ul>
<li><a href="asymptotics-under-the-classic-regression-model.html#the-case-of-heteroscedasticity" id="toc-the-case-of-heteroscedasticity"><span class="toc-section-number">5.2.1</span> The Case of Heteroscedasticity</a></li>
<li><a href="asymptotics-under-the-classic-regression-model.html#hypothesis-testing-and-confidence-intervals" id="toc-hypothesis-testing-and-confidence-intervals"><span class="toc-section-number">5.2.2</span> Hypothesis Testing and Confidence Intervals</a></li>
</ul></li>
<li><a href="practice-large-sample-inference.html#practice-large-sample-inference" id="toc-practice-large-sample-inference"><span class="toc-section-number">5.3</span> Practice: Large Sample Inference</a>
<ul>
<li><a href="practice-large-sample-inference.html#normally-distributed-hatbeta-for-ntoinfty" id="toc-normally-distributed-hatbeta-for-ntoinfty"><span class="toc-section-number">5.3.1</span> Normally Distributed <span class="math inline">\(\hat\beta\)</span> for <span class="math inline">\(n\to\infty\)</span></a></li>
<li><a href="practice-large-sample-inference.html#testing-multiple-and-single-parameters" id="toc-testing-multiple-and-single-parameters"><span class="toc-section-number">5.3.2</span> Testing Multiple and Single Parameters</a></li>
</ul></li>
</ul></li>
<li><a href="ivr.html#ivr" id="toc-ivr"><span class="toc-section-number">6</span> Instrumental Variables Regression</a>
<ul>
<li><a href="TIVEWASRAASI.html#TIVEWASRAASI" id="toc-TIVEWASRAASI"><span class="toc-section-number">6.1</span> The IV Estimator with a Single Regressor and a Single Instrument</a>
<ul>
<li><a href="TIVEWASRAASI.html#the-two-stage-least-squares-estimator" id="toc-the-two-stage-least-squares-estimator"><span class="toc-section-number">6.1.1</span> The Two-Stage Least Squares Estimator</a></li>
<li><a href="TIVEWASRAASI.html#application-demand-for-cigarettes-12" id="toc-application-demand-for-cigarettes-12"><span class="toc-section-number">6.1.2</span> Application: Demand For Cigarettes (1/2)</a></li>
</ul></li>
<li><a href="TGIVRM.html#TGIVRM" id="toc-TGIVRM"><span class="toc-section-number">6.2</span> The General IV Regression Model</a>
<ul>
<li><a href="TGIVRM.html#application-demand-for-cigarettes-22" id="toc-application-demand-for-cigarettes-22"><span class="toc-section-number">6.2.1</span> Application: Demand for Cigarettes (2/2)</a></li>
</ul></li>
<li><a href="civ.html#civ" id="toc-civ"><span class="toc-section-number">6.3</span> Checking Instrument Validity</a>
<ul>
<li><a href="civ.html#instrument-relevance" id="toc-instrument-relevance"><span class="toc-section-number">6.3.1</span> Instrument Relevance</a></li>
<li><a href="civ.html#instrument-validity" id="toc-instrument-validity"><span class="toc-section-number">6.3.2</span> Instrument Validity</a></li>
</ul></li>
<li><a href="attdfc.html#attdfc" id="toc-attdfc"><span class="toc-section-number">6.4</span> Application to the Demand for Cigarettes</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometrics (M.Sc.)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="TGIVRM" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> The General IV Regression Model</h2>
The simple IV regression model is easily extended to a multiple regression model which we refer to as the general IV regression model. In this model we distinguish between four types of variables: the dependent variable, included exogenous variables, included endogenous variables and instrumental variables:
<span class="math display">\[\begin{align}
  Y_i = \beta_1 + \beta_2 X_{2i} + \dots + \beta_K X_{Ki} + \beta_{K+1} W_{1i} + \dots + \beta_{K+r} W_{ri} + \eps_i, \label{eq:givmodel}
\end{align}\]</span>
with <span class="math inline">\(i=1,\dots,n\)</span> is the general instrumental variables regression model where
<p>The coefficients are if <span class="math inline">\(m&gt;(K-1)\)</span>. If <span class="math inline">\(m&lt;(K-1)\)</span>, the coefficients are and when <span class="math inline">\(m=(K-1)\)</span> they are . For estimation of the IV regression model we require exact identification or overidentification.</p>
<p>Estimating regression models with TSLS using multiple instruments by means of <code>ivreg()</code> is straightforward. There are, however, some subtleties in correctly specifying the regression formula. Assume that you want to estimate the model
<span class="math display">\[
Y_i = \beta_1 + \beta_2 X_{2i} + \beta_3 X_{3i} + \beta_4 W_{1i} + \eps_i
\]</span>
where <span class="math inline">\(X_{2i}\)</span> and <span class="math inline">\(X_{3i}\)</span> are endogenous regressors that shall be instrumented by <span class="math inline">\(Z_{1i}\)</span>, <span class="math inline">\(Z_{2i}\)</span> and <span class="math inline">\(Z_{3i}\)</span>, and where <span class="math inline">\(W_{1i}\)</span> is an exogenous regressor. Say the corresponding data is available in a <code>data.frame</code> with column names <code>y</code>, <code>x2</code>, <code>x3</code>, <code>w1</code>, <code>z1</code>, <code>z2</code> and <code>z3</code>. It might be tempting to specify the argument <code>formula</code> in your call of <code>ivreg()</code> as <code>y ~ x2 + x3 + w1 | z1 + z2 + z3</code> which is, however, . As explained in the documentation of <code>ivreg()</code> (see <code>?ivreg</code>), it is necessary to list <em>all</em> exogenous variables as instruments too, that is joining them by <code>+</code>’s on the right of the vertical bar: <code>y ~ x2 + x3 + w1 | w1 + z1 + z2 + z3</code>, where <code>w1</code> is “instrumenting itself”.</p>
<p>Similarly to the simple IV regression model, the general IV model <span class="math inline">\(\eqref{eq:givmodel}\)</span> can be estimated using the two-stage least squares estimator:</p>
In the general IV regression model, the instrument relevance and instrument exogeneity assumptions are equivalent to the case of the simple regression model with a single endogenous regressor and only one instrument. That is, for <span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> to be a set of valid instruments, the following two conditions must be fulfilled:
<p>One can show that if the IV regression assumptions hold, the TSLS estimator in <span class="math inline">\(\eqref{eq:givmodel}\)</span> is consistent and normally distributed when the sample size <span class="math inline">\(n\)</span> is large. That is, if we have valid instruments, we obtain valid statistical inference using <span class="math inline">\(t\)</span>-tests, <span class="math inline">\(F\)</span>-tests and confidence intervals for the model coefficients.</p>
<div id="application-demand-for-cigarettes-22" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Application: Demand for Cigarettes (2/2)</h3>
<p>The estimated elasticity of the demand for cigarettes in <span class="math inline">\(\eqref{eq:srm12}\)</span> is <span class="math inline">\(1.08\)</span>. Although <span class="math inline">\(\eqref{eq:srm12}\)</span> was estimated using IV regression it is plausible that this IV estimate is biased. The TSLS estimator is inconsistent for the true <span class="math inline">\(\beta_2\)</span> if the instrument (here: the real sales tax per pack) is invalid, i.e., if the instrument correlates with the error term. This is likely to be the case here since there are economic factors, like state income, which impact the demand for cigarettes and correlate with the sales tax. States with high personal income tend to generate tax revenues by income taxes and less by sales taxes. Consequently, state income should be included in the regression model.
<span class="math display">\[\begin{align}
  \log(Q_i^{cigarettes}) = \beta_1 + \beta_2 \log(P_i^{cigarettes}) + \beta_3 \log(income_i) + \eps_i \label{eq:mcigstsls1}
\end{align}\]</span></p>
<p>Before estimating <span class="math inline">\(\eqref{eq:mcigstsls1}\)</span> using <code>ivreg()</code> we define <span class="math inline">\(income\)</span> as real per capita income <code>rincome</code> and append it to the data set <code>CigarettesSW</code>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="TGIVRM.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add real income to the dataset (cpi: consumer price index)</span></span>
<span id="cb109-2"><a href="TGIVRM.html#cb109-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>rincome <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, </span>
<span id="cb109-3"><a href="TGIVRM.html#cb109-3" aria-hidden="true" tabindex="-1"></a>                             income <span class="sc">/</span> population <span class="sc">/</span> cpi)</span>
<span id="cb109-4"><a href="TGIVRM.html#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="TGIVRM.html#cb109-5" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="TGIVRM.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb110-2"><a href="TGIVRM.html#cb110-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">+</span> </span>
<span id="cb110-3"><a href="TGIVRM.html#cb110-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">log</span>(rincome) <span class="sc">|</span> <span class="fu">log</span>(rincome) <span class="sc">+</span> </span>
<span id="cb110-4"><a href="TGIVRM.html#cb110-4" aria-hidden="true" tabindex="-1"></a>                    salestax, <span class="at">data =</span> c1995)</span>
<span id="cb110-5"><a href="TGIVRM.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="TGIVRM.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb110-7"><a href="TGIVRM.html#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-8"><a href="TGIVRM.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb110-9"><a href="TGIVRM.html#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb110-10"><a href="TGIVRM.html#cb110-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb110-11"><a href="TGIVRM.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   9.43066    1.25939  7.4883 1.935e-09 ***</span></span>
<span id="cb110-12"><a href="TGIVRM.html#cb110-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rprice)  -1.14338    0.37230 -3.0711  0.003611 ** </span></span>
<span id="cb110-13"><a href="TGIVRM.html#cb110-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rincome)  0.21452    0.31175  0.6881  0.494917    </span></span>
<span id="cb110-14"><a href="TGIVRM.html#cb110-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb110-15"><a href="TGIVRM.html#cb110-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We obtain
<span class="math display">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(1.26)}{9.42} - \underset{(0.37)}{1.14} \log(P_i^{cigarettes}) + \underset{(0.31)}{0.21} \log(income_i). \label{eq:emcigstsls2}
\end{align}\]</span></p>
<p>In the following we add the cigarette-specific taxes (<span class="math inline">\(cigtax_i\)</span>) as a further instrumental variable and estimate again using TSLS.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="TGIVRM.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add cigtax to the data set</span></span>
<span id="cb111-2"><a href="TGIVRM.html#cb111-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>cigtax <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, tax<span class="sc">/</span>cpi)</span>
<span id="cb111-3"><a href="TGIVRM.html#cb111-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-4"><a href="TGIVRM.html#cb111-4" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1995&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="TGIVRM.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb112-2"><a href="TGIVRM.html#cb112-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">+</span> <span class="fu">log</span>(rincome) <span class="sc">|</span> </span>
<span id="cb112-3"><a href="TGIVRM.html#cb112-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(rincome) <span class="sc">+</span> salestax <span class="sc">+</span> cigtax, </span>
<span id="cb112-4"><a href="TGIVRM.html#cb112-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> c1995)</span>
<span id="cb112-5"><a href="TGIVRM.html#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="TGIVRM.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb112-7"><a href="TGIVRM.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-8"><a href="TGIVRM.html#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb112-9"><a href="TGIVRM.html#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb112-10"><a href="TGIVRM.html#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb112-11"><a href="TGIVRM.html#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept)   9.89496    0.95922 10.3157 1.947e-13 ***</span></span>
<span id="cb112-12"><a href="TGIVRM.html#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rprice)  -1.27742    0.24961 -5.1177 6.211e-06 ***</span></span>
<span id="cb112-13"><a href="TGIVRM.html#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; log(rincome)  0.28040    0.25389  1.1044    0.2753    </span></span>
<span id="cb112-14"><a href="TGIVRM.html#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb112-15"><a href="TGIVRM.html#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Using the two instruments <span class="math inline">\(salestax_i\)</span> and <span class="math inline">\(cigtax_i\)</span> we have <span class="math inline">\(m=2\)</span> for one endogenous regressor – so the coefficient on the endogenous regressor <span class="math inline">\(\log(P_i^{cigarettes})\)</span> is <em>overidentified</em>. The TSLS estimate of <span class="math inline">\(\eqref{eq:mcigstsls1}\)</span> is</p>
<p><span class="math display">\[\begin{align}
\widehat{\log(Q_i^{cigarettes})} = \underset{(0.96)}{9.89} - \underset{(0.25)}{1.28} \log(P_i^{cigarettes}) + \underset{(0.25)}{0.28} \log(income_i). \label{eq:emcigstsls3}
\end{align}\]</span></p>
<p>Should we trust the estimates presented in <span class="math inline">\(\eqref{eq:emcigstsls2}\)</span> or rather rely on <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span>? The estimates obtained using both instruments are more precise since in <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span> all standard errors reported are smaller than in <span class="math inline">\(\eqref{eq:emcigstsls2}\)</span>. In fact, the standard error for the estimate of the demand elasticity is only two thirds of the standard error when the sales tax is the only instrument used. This is due to more information being used in estimation <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span>. <em>If</em> the instruments are valid, <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span> can be considered more reliable.</p>
<p>However, without insights regarding the validity of the instruments it is not sensible to make such a statement. This stresses why checking instrument validity is essential. Chapter <a href="civ.html#civ">6.3</a> briefly discusses guidelines in checking instrument validity and presents approaches that allow to test for instrument relevance and exogeneity under certain conditions. These are then used in an application to the demand for cigarettes in Chapter <a href="attdfc.html#attdfc">6.4</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="TIVEWASRAASI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="civ.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Script_Econometrics_MSc.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"download": "https://uni-bonn.sciebo.de/s/IZ2yeLeA4dRTFUY",
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
