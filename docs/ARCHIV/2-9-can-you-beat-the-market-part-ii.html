<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.9 Can You Beat the Market? (Part II) | Introduction to Econometrics with R</title>
  <meta name="description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="2.9 Can You Beat the Market? (Part II) | Introduction to Econometrics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.econometrics-with-r.org/" />
  <meta property="og:image" content="https://www.econometrics-with-r.org/images/cover.png" />
  <meta property="og:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="github-repo" content="mca91/EconometricsWithR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.9 Can You Beat the Market? (Part II) | Introduction to Econometrics with R" />
  
  <meta name="twitter:description" content="Beginners with little background in statistics and econometrics often have a hard time understanding the benefits of having programming skills for learning and applying Econometrics. ‘Introduction to Econometrics with R’ is an interactive companion to the well-received textbook ‘Introduction to Econometrics’ by James H. Stock and Mark W. Watson (2015). It gives a gentle introduction to the essentials of R programming and guides students in implementing the empirical applications presented throughout the textbook using the newly aquired skills. This is supported by interactive programming exercises generated with DataCamp Light and integration of interactive visualizations of central concepts which are based on the flexible JavaScript library D3.js." />
  <meta name="twitter:image" content="https://www.econometrics-with-r.org/images/cover.png" />

<meta name="author" content="Christoph Hanck, Martin Arnold, Alexander Gerber and Martin Schmelzer" />


<meta name="date" content="2019-08-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2-8-niib.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- font families -->

<link href="https://fonts.googleapis.com/css?family=PT+Sans|Pacifico|Source+Sans+Pro" rel="stylesheet">

<!--<script src="js/hideOutput.js"></script>-->

<!-- Mathjax -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/default.js"></script>

 <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js", "TeX/AMSmath.js"],
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
        jax: ["input/TeX","output/CommonHTML"]
      });
      MathJax.Hub.processSectionDelay = 0;
  </script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-110299877-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-110299877-1');
</script>

<!-- open review block -->

<script async defer src="https://hypothes.is/embed.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><center><img src="images/logo.png" alt="logo" width="50%" height="50%"style="margin: 15px 0 0 0"></center></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="1-introduction.html"><a href="1-introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="1-1-a-very-short-introduction-to-r-and-rstudio.html"><a href="1-1-a-very-short-introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1.1</b> A Very Short Introduction to <tt>R</tt> and <em>RStudio</em></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-ittsraf.html"><a href="2-ittsraf.html"><i class="fa fa-check"></i><b>2</b> Introduction to Time Series Regression and Forecasting</a><ul>
<li class="chapter" data-level="2.1" data-path="2-1-using-regression-models-for-forecasting.html"><a href="2-1-using-regression-models-for-forecasting.html"><i class="fa fa-check"></i><b>2.1</b> Using Regression Models for Forecasting</a></li>
<li class="chapter" data-level="2.2" data-path="2-2-tsdasc.html"><a href="2-2-tsdasc.html"><i class="fa fa-check"></i><b>2.2</b> Time Series Data and Serial Correlation</a><ul>
<li class="chapter" data-level="" data-path="2-2-tsdasc.html"><a href="2-2-tsdasc.html#notation-lags-differences-logarithms-and-growth-rates"><i class="fa fa-check"></i>Notation, Lags, Differences, Logarithms and Growth Rates</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2-3-autoregressions.html"><a href="2-3-autoregressions.html"><i class="fa fa-check"></i><b>2.3</b> Autoregressions</a><ul>
<li><a href="2-3-autoregressions.html#autoregressive-models-of-order-p">Autoregressive Models of Order <span class="math inline">\(p\)</span></a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-4-cybtmpi.html"><a href="2-4-cybtmpi.html"><i class="fa fa-check"></i><b>2.4</b> Can You Beat the Market? (Part I)</a></li>
<li class="chapter" data-level="2.5" data-path="2-5-apatadlm.html"><a href="2-5-apatadlm.html"><i class="fa fa-check"></i><b>2.5</b> Additional Predictors and The ADL Model</a><ul>
<li class="chapter" data-level="" data-path="2-5-apatadlm.html"><a href="2-5-apatadlm.html#forecast-uncertainty-and-forecast-intervals"><i class="fa fa-check"></i>Forecast Uncertainty and Forecast Intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-6-llsuic.html"><a href="2-6-llsuic.html"><i class="fa fa-check"></i><b>2.6</b> Lag Length Selection Using Information Criteria</a></li>
<li class="chapter" data-level="2.7" data-path="2-7-nit.html"><a href="2-7-nit.html"><i class="fa fa-check"></i><b>2.7</b> Nonstationarity I: Trends</a></li>
<li class="chapter" data-level="2.8" data-path="2-8-niib.html"><a href="2-8-niib.html"><i class="fa fa-check"></i><b>2.8</b> Nonstationarity II: Breaks</a></li>
<li class="chapter" data-level="2.9" data-path="2-9-can-you-beat-the-market-part-ii.html"><a href="2-9-can-you-beat-the-market-part-ii.html"><i class="fa fa-check"></i><b>2.9</b> Can You Beat the Market? (Part II)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Econometrics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b>Open Review</b>. We want your feedback to make the book better for you and other students. You may annotate some text by <span style="background-color: #3297FD; color: white">selecting it with the cursor</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. You can also see the annotations of others: click the <i class="h-icon-chevron-left"></i> in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="can-you-beat-the-market-part-ii" class="section level2">
<h2><span class="header-section-number">2.9</span> Can You Beat the Market? (Part II)</h2>
<p>The dividend yield (the ratio of current dividends to the stock price) can be considered as an indicator of future dividends: if a stock has a high current dividend yield, it can be considered undervalued and it can be presumed that the price of the stock goes up in the future, meaning that future excess returns go up.</p>
<p>This presumption can be examined using ADL models of excess returns, where lags of the logarithm of the stock’s dividend yield serve as additional regressors.</p>
<p>Unfortunately, a graphical inspection of the time series of the logarithm of the dividend yield casts doubt on the assumption that the series is stationary which, as has been discussed in Chapter <a href="2-7-nit.html#nit">2.7</a>, is necessary to conduct standard inference in a regression analysis.</p>
<div class="unfolded">
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb126-1"></a><span class="co"># plot logarithm of dividend yield series</span></span>
<span id="cb126-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb126-2"></a><span class="kw">plot</span>(StockReturns[, <span class="dv">2</span>], </span>
<span id="cb126-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb126-3"></a>     <span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>, </span>
<span id="cb126-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb126-4"></a>     <span class="dt">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb126-5"><a href="2-9-can-you-beat-the-market-part-ii.html#cb126-5"></a>     <span class="dt">ylab =</span> <span class="st">&quot;Logarithm&quot;</span>, </span>
<span id="cb126-6"><a href="2-9-can-you-beat-the-market-part-ii.html#cb126-6"></a>     <span class="dt">main =</span> <span class="st">&quot;Dividend Yield for CRSP Index&quot;</span>)</span></code></pre></div>
<p><img src="ITER_files/figure-html/unnamed-chunk-101-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<p>The Dickey-Fuller test statistic for an autoregressive unit root in an AR(<span class="math inline">\(1\)</span>) model with drift provides further evidence that the series might be nonstationary.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb127-1"></a><span class="co"># test for unit root in GDP using &#39;ur.df()&#39; from the package &#39;urca&#39;</span></span>
<span id="cb127-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb127-2"></a><span class="kw">summary</span>(<span class="kw">ur.df</span>(<span class="kw">window</span>(StockReturns[, <span class="dv">2</span>], </span>
<span id="cb127-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb127-3"></a>                     <span class="kw">c</span>(<span class="dv">1960</span>,<span class="dv">1</span>), </span>
<span id="cb127-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb127-4"></a>                     <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>)), </span>
<span id="cb127-5"><a href="2-9-can-you-beat-the-market-part-ii.html#cb127-5"></a>              <span class="dt">type =</span> <span class="st">&quot;drift&quot;</span>, </span>
<span id="cb127-6"><a href="2-9-can-you-beat-the-market-part-ii.html#cb127-6"></a>              <span class="dt">lags =</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>## 
## ############################################### 
## # Augmented Dickey-Fuller Test Unit Root Test # 
## ############################################### 
## 
## Test regression drift 
## 
## 
## Call:
## lm(formula = z.diff ~ z.lag.1 + 1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.3540  -2.9118  -0.2952   2.6374  25.5170 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.740964   2.080039  -1.318    0.188
## z.lag.1     -0.007652   0.005989  -1.278    0.202
## 
## Residual standard error: 4.45 on 513 degrees of freedom
## Multiple R-squared:  0.003172,   Adjusted R-squared:  0.001229 
## F-statistic: 1.633 on 1 and 513 DF,  p-value: 0.2019
## 
## 
## Value of test-statistic is: -1.2777 0.9339 
## 
## Critical values for test statistics: 
##       1pct  5pct 10pct
## tau2 -3.43 -2.86 -2.57
## phi1  6.43  4.59  3.78</code></pre>
<p>We use <tt>window()</tt> to get observations from January 1960 to December 2012 only.</p>
<p>Since the <span class="math inline">\(t\)</span>-value for the coefficient on the lagged logarithm of the dividend yield is <span class="math inline">\(-1.27\)</span>, the hypothesis that the true coefficient is zero cannot be rejected, even at the <span class="math inline">\(10\%\)</span> significance level.</p>
<p>However, it is possible to examine whether the dividend yield has predictive power for excess returns by using its differences in an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) and an ADL(<span class="math inline">\(2\)</span>,<span class="math inline">\(2\)</span>) model (remember that differencing a series with a unit root yields a stationary series), although these model specifications do not correspond to the economic reasoning mentioned above. Thus, we also estimate an ADL(<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>) regression using the level of the logarithm of the dividend yield.</p>
<p>That is we estimate three different specifications:</p>
<p><span class="math display">\[\begin{align*}
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_3 \Delta \log(dividend yield_{t-1}) + u_t \\
  \\
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_2 excess \, returns_{t-2} \\ &amp;+ \, \beta_3 \Delta \log(dividend yield_{t-1}) + \beta_4 \Delta \log(dividend yield_{t-2}) + u_t \\
  \\
  excess \, returns_t =&amp; \, \beta_0 + \beta_1 excess \, returns_{t-1} + \beta_5 \log(dividend yield_{t-1}) + u_t \\
\end{align*}\]</span></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-1"></a><span class="co"># ADL(1,1) (1st difference of log dividend yield)</span></span>
<span id="cb129-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-2"></a>CRSP_ADL_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">d</span>(<span class="kw">L</span>(ln_DivYield)), </span>
<span id="cb129-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-3"></a>                    <span class="dt">data =</span> StockReturns,</span>
<span id="cb129-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-4"></a>                    <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span>
<span id="cb129-5"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-5"></a></span>
<span id="cb129-6"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-6"></a><span class="co"># ADL(2,2) (1st &amp; 2nd differences of log dividend yield)</span></span>
<span id="cb129-7"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-7"></a>CRSP_ADL_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(ExReturn, <span class="dv">2</span>) </span>
<span id="cb129-8"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-8"></a>                    <span class="op">+</span><span class="st"> </span><span class="kw">d</span>(<span class="kw">L</span>(ln_DivYield)) <span class="op">+</span><span class="st"> </span><span class="kw">d</span>(<span class="kw">L</span>(ln_DivYield, <span class="dv">2</span>)), </span>
<span id="cb129-9"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-9"></a>                    <span class="dt">data =</span> StockReturns,</span>
<span id="cb129-10"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-10"></a>                    <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))</span>
<span id="cb129-11"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-11"></a></span>
<span id="cb129-12"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-12"></a><span class="co"># ADL(1,1) (level of log dividend yield)</span></span>
<span id="cb129-13"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-13"></a>CRSP_ADL_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(ln_DivYield),</span>
<span id="cb129-14"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-14"></a>                    <span class="dt">data =</span> StockReturns,</span>
<span id="cb129-15"><a href="2-9-can-you-beat-the-market-part-ii.html#cb129-15"></a>                    <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">1992</span>, <span class="dv">12</span>))</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb130-1"></a><span class="co"># gather robust standard errors</span></span>
<span id="cb130-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb130-2"></a>rob_se_CRSP_ADL &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">sandwich</span>(CRSP_ADL_<span class="dv">1</span>))),</span>
<span id="cb130-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb130-3"></a>                        <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">sandwich</span>(CRSP_ADL_<span class="dv">2</span>))),</span>
<span id="cb130-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb130-4"></a>                        <span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">sandwich</span>(CRSP_ADL_<span class="dv">3</span>))))</span></code></pre></div>
<p>A tabular representation of the results can then be generated using <tt>stargazer()</tt>.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-1"></a><span class="kw">stargazer</span>(CRSP_ADL_<span class="dv">1</span>, CRSP_ADL_<span class="dv">2</span>, CRSP_ADL_<span class="dv">3</span>,</span>
<span id="cb131-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-2"></a>  <span class="dt">title =</span> <span class="st">&quot;ADL Models of Monthly Excess Stock Returns&quot;</span>,</span>
<span id="cb131-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-3"></a>  <span class="dt">header =</span> <span class="ot">FALSE</span>, </span>
<span id="cb131-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-4"></a>  <span class="dt">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb131-5"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-5"></a>  <span class="dt">column.sep.width =</span> <span class="st">&quot;-5pt&quot;</span>,</span>
<span id="cb131-6"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-6"></a>  <span class="dt">no.space =</span> T,</span>
<span id="cb131-7"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-7"></a>  <span class="dt">digits =</span> <span class="dv">3</span>, </span>
<span id="cb131-8"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-8"></a>  <span class="dt">column.labels =</span> <span class="kw">c</span>(<span class="st">&quot;ADL(1,1)&quot;</span>, <span class="st">&quot;ADL(2,2)&quot;</span>, <span class="st">&quot;ADL(1,1)&quot;</span>),</span>
<span id="cb131-9"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-9"></a>  <span class="dt">dep.var.caption  =</span> <span class="st">&quot;Dependent Variable: Excess returns on the CSRP value-weighted index&quot;</span>,</span>
<span id="cb131-10"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-10"></a>  <span class="dt">dep.var.labels.include =</span> <span class="ot">FALSE</span>,</span>
<span id="cb131-11"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-11"></a>  <span class="dt">covariate.labels =</span> <span class="kw">c</span>(<span class="st">&quot;$excess return_{t-1}$&quot;</span>, </span>
<span id="cb131-12"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-12"></a>                       <span class="st">&quot;$excess return_{t-2}$&quot;</span>, </span>
<span id="cb131-13"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-13"></a>                       <span class="st">&quot;$1^{st} diff log(dividend yield_{t-1})$&quot;</span>, </span>
<span id="cb131-14"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-14"></a>                       <span class="st">&quot;$1^{st} diff log(dividend yield_{t-2})$&quot;</span>, </span>
<span id="cb131-15"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-15"></a>                       <span class="st">&quot;$log(dividend yield_{t-1})$&quot;</span>, </span>
<span id="cb131-16"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-16"></a>                       <span class="st">&quot;Constant&quot;</span>),</span>
<span id="cb131-17"><a href="2-9-can-you-beat-the-market-part-ii.html#cb131-17"></a>  <span class="dt">se =</span> rob_se_CRSP_ADL) </span></code></pre></div>



<table style="text-align:center"><tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td colspan="3">Dependent Variable: Excess Returns on the CSRP Value-Weighted Index</td></tr>
<tr><td></td><td colspan="3" style="border-bottom: 1px solid black"></td></tr>
<tr><td style="text-align:left"></td><td>ADL(1,1)</td><td>ADL(2,2)</td><td>ADL(1,1)</td></tr>
<tr><td style="text-align:left"></td><td>(1)</td><td>(2)</td><td>(3)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">excess return<sub>t-1</sub></td><td>0.059</td><td>0.042</td><td>0.078</td></tr>
<tr><td style="text-align:left"></td><td>(0.158)</td><td>(0.162)</td><td>(0.057)</td></tr>
<tr><td style="text-align:left">excess return<sub>t-2</sub></td><td></td><td>-0.213</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.193)</td><td></td></tr>
<tr><td style="text-align:left">1<sup>st</sup> diff log(dividend yield<sub>t-1</sub>)</td><td>0.009</td><td>-0.012</td><td></td></tr>
<tr><td style="text-align:left"></td><td>(0.157)</td><td>(0.163)</td><td></td></tr>
<tr><td style="text-align:left">1<sup>st</sup> diff log(dividend yield<sub>t-2</sub>)</td><td></td><td>-0.161</td><td></td></tr>
<tr><td style="text-align:left"></td><td></td><td>(0.185)</td><td></td></tr>
<tr><td style="text-align:left">log(dividend yield<sub>t-1</sub>)</td><td></td><td></td><td>0.026<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td></td><td></td><td>(0.012)</td></tr>
<tr><td style="text-align:left">Constant</td><td>0.309</td><td>0.372<sup>*</sup></td><td>8.987<sup>**</sup></td></tr>
<tr><td style="text-align:left"></td><td>(0.199)</td><td>(0.208)</td><td>(3.912)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>516</td><td>516</td><td>396</td></tr>
<tr><td style="text-align:left">R<sup>2</sup></td><td>0.003</td><td>0.007</td><td>0.018</td></tr>
<tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>-0.001</td><td>-0.001</td><td>0.013</td></tr>
<tr><td style="text-align:left">Residual Std. Error</td><td>4.338 (df = 513)</td><td>4.337 (df = 511)</td><td>4.407 (df = 393)</td></tr>
<tr><td style="text-align:left">F Statistic</td><td>0.653 (df = 2; 513)</td><td>0.897 (df = 4; 511)</td><td>3.683<sup>**</sup> (df = 2; 393)</td></tr>
<tr><td colspan="4" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td colspan="3" style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr>
</table>
<caption><p style='text-align:center'><span id="tab:adlmomesr">Table 2.3: </span> ADL Models of Monthly Excess Stock Returns</p></caption>


<p>For models (1) and (2) none of the individual <span class="math inline">\(t\)</span>-statistics suggest that the coefficients are different from zero. Also, we cannot reject the hypothesis that none of the lags have predictive power for excess returns at any common level of significance (an <span class="math inline">\(F\)</span>-test that the lags have predictive power does not reject for both models).</p>
<p>Things are different for model (3). The coefficient on the level of the logarithm of the dividend yield is different from zero at the <span class="math inline">\(5\%\)</span> level and the <span class="math inline">\(F\)</span>-test rejects, too. But we should be suspicious: the high degree of persistence in the dividend yield series probably renders this inference dubious because <span class="math inline">\(t\)</span>- and <span class="math inline">\(F\)</span>-statistics may follow distributions that deviate considerably from their theoretical large-sample distributions such that the usual critical values cannot be applied.</p>
<p>If model (3) were of use for predicting excess returns, pseudo-out-of-sample forecasts based on (3) should at least outperform forecasts of an intercept-only model in terms of the sample RMSFE. We can perform this type of comparison using <tt>R</tt> code in the fashion of the applications of Chapter <a href="2-8-niib.html#niib">2.8</a>.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-1"></a><span class="co"># end of sample dates</span></span>
<span id="cb132-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-2"></a>EndOfSample &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">window</span>(<span class="kw">time</span>(StockReturns), <span class="kw">c</span>(<span class="dv">1992</span>, <span class="dv">12</span>), <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">11</span>)))</span>
<span id="cb132-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-3"></a></span>
<span id="cb132-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-4"></a><span class="co"># initialize matrix  forecasts</span></span>
<span id="cb132-5"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-5"></a>forecasts &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb132-6"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-6"></a>                    <span class="dt">ncol =</span> <span class="kw">length</span>(EndOfSample))</span>
<span id="cb132-7"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-7"></a></span>
<span id="cb132-8"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-8"></a><span class="co"># estimation loop over end of sample dates</span></span>
<span id="cb132-9"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(EndOfSample)) {</span>
<span id="cb132-10"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-10"></a></span>
<span id="cb132-11"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-11"></a>  <span class="co"># estimate model (3)</span></span>
<span id="cb132-12"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-12"></a>  mod3 &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="kw">L</span>(ExReturn) <span class="op">+</span><span class="st"> </span><span class="kw">L</span>(ln_DivYield), <span class="dt">data =</span> StockReturns, </span>
<span id="cb132-13"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-13"></a>                <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), </span>
<span id="cb132-14"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-14"></a>                <span class="dt">end =</span> EndOfSample[i])</span>
<span id="cb132-15"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-15"></a>  </span>
<span id="cb132-16"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-16"></a>  <span class="co"># estimate intercept only model</span></span>
<span id="cb132-17"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-17"></a>  modconst &lt;-<span class="st"> </span><span class="kw">dynlm</span>(ExReturn <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> StockReturns, </span>
<span id="cb132-18"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-18"></a>                <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1960</span>, <span class="dv">1</span>), </span>
<span id="cb132-19"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-19"></a>                <span class="dt">end =</span> EndOfSample[i])</span>
<span id="cb132-20"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-20"></a>  </span>
<span id="cb132-21"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-21"></a>  <span class="co"># sample data for one-period ahead forecast</span></span>
<span id="cb132-22"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-22"></a>  t &lt;-<span class="st"> </span><span class="kw">window</span>(StockReturns, EndOfSample[i], EndOfSample[i])</span>
<span id="cb132-23"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-23"></a>  </span>
<span id="cb132-24"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-24"></a>  <span class="co"># compute forecast</span></span>
<span id="cb132-25"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-25"></a>  forecasts[, i] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">coef</span>(mod3) <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, t[<span class="dv">1</span>], t[<span class="dv">2</span>]), <span class="kw">coef</span>(modconst))</span>
<span id="cb132-26"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-26"></a>                     </span>
<span id="cb132-27"><a href="2-9-can-you-beat-the-market-part-ii.html#cb132-27"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-1"></a><span class="co"># gather data</span></span>
<span id="cb133-2"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-2"></a>d &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="st">&quot;Excess Returns&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">window</span>(StockReturns[,<span class="dv">1</span>], <span class="kw">c</span>(<span class="dv">1993</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">2002</span>, <span class="dv">12</span>))),</span>
<span id="cb133-3"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-3"></a>           <span class="st">&quot;Model (3)&quot;</span> =<span class="st"> </span>forecasts[<span class="dv">1</span>,], </span>
<span id="cb133-4"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-4"></a>           <span class="st">&quot;Intercept Only&quot;</span> =<span class="st"> </span>forecasts[<span class="dv">2</span>,], </span>
<span id="cb133-5"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-5"></a>           <span class="st">&quot;Always Zero&quot;</span> =<span class="st">  </span><span class="dv">0</span>)</span>
<span id="cb133-6"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-6"></a></span>
<span id="cb133-7"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-7"></a><span class="co"># Compute RMSFEs</span></span>
<span id="cb133-8"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-8"></a><span class="kw">c</span>(<span class="st">&quot;ADL model (3)&quot;</span> =<span class="st"> </span><span class="kw">sd</span>(d[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>d[, <span class="dv">2</span>]),</span>
<span id="cb133-9"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-9"></a>  <span class="st">&quot;Intercept-only model&quot;</span> =<span class="st"> </span><span class="kw">sd</span>(d[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>d[, <span class="dv">3</span>]),</span>
<span id="cb133-10"><a href="2-9-can-you-beat-the-market-part-ii.html#cb133-10"></a>  <span class="st">&quot;Always zero&quot;</span> =<span class="st"> </span><span class="kw">sd</span>(d[,<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>d[, <span class="dv">4</span>]))</span></code></pre></div>
<pre><code>##        ADL model (3) Intercept-only model          Always zero 
##             4.043757             4.000221             3.995428</code></pre>
<p>The comparison indicates that model (3) is not useful since it is outperformed in terms of sample RMSFE by the intercept-only model. A model forecasting excess returns always to be zero has an even lower sample RMSFE. This finding is consistent with the weak-form efficiency hypothesis which states that all publicly available information is accounted for in stock prices such that there is no way to predict future stock prices or excess returns using past observations, implying that the perceived significant relationship indicated by model (3) is wrong.</p>
<div id="summary" class="section level4 unnumbered">
<h4>Summary</h4>
<p>This chapter dealt with introductory topics in time series regression analysis, where variables are generally correlated from one observation to the next, a concept termed serial correlation. We presented several ways of storing and plotting time series data using <tt>R</tt> and used these for informal analysis of economic data.</p>
<p>We have introduced AR and ADL models and applied them in the context of forecasting of macroeconomic and financial time series using <tt>R</tt>. The discussion also included the topic of lag length selection. It was shown how to set up a simple function that computes the BIC for a model object supplied.</p>
<p>We have also seen how to write simple <tt>R</tt> code for performing and evaluating forecasts and demonstrated some more sophisticated approaches to conduct pseudo-out-of-sample forecasts for assessment of a model’s predictive power for unobserved future outcomes of a series, to check model stability and to compare different models.</p>
<p>Furthermore, some more technical aspects like the concept of stationarity were addressed. This included applications to testing for an autoregressive unit root with the Dickey-Fuller test and the detection of a break in the population regression function using the <span class="math inline">\(QLR\)</span> statistic. For both methods, the distribution of the relevant test statistic is non-normal, even in large samples. Concerning the Dickey-Fuller test we have used <tt>R</tt>’s random number generation facilities to produce evidence for this by means of a Monte-Carlo simulation and motivated usage of the quantiles tabulated in the book.</p>
<p>Also, empirical studies regarding the validity of the weak and the strong form efficiency hypothesis which are presented in the applications <em>Can You Beat the Market? Part I &amp; II</em> in the book have been reproduced using <tt>R</tt>.</p>
<p>In all applications of this chapter, the focus was on forecasting future outcomes rather than estimation of causal relationships between time series variables. However, the methods needed for the latter are quite similar. Chapter <a href="#eodce"><strong>??</strong></a> is devoted to estimation of so called <em>dynamic causal effects</em>.</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="2-8-niib.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/mca91/EconometricsWithR/edit/master/14-ch14.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["ITER.pdf"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
