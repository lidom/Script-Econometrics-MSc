<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Econometrics M.Sc. - 6&nbsp; Instrumental Variables Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-Asymptotics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Instrumental Variables Regression</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./Uni_Bonn_Logo.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Econometrics M.Sc.</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction-to-R.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Review-Prob_n_Stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Review: Probability and Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-MultipleReg.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Small-Sample-Inference.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Small Sample Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Asymptotics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Large Sample Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Instrumental-Variables.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Instrumental Variables Regression</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#TIVEWASRAASI" id="toc-TIVEWASRAASI" class="nav-link active" data-scroll-target="#TIVEWASRAASI"><span class="toc-section-number">6.1</span>  The IV Estimator with a Single Regressor and a Single Instrument</a>
  <ul class="collapse">
  <li><a href="#the-two-stage-least-squares-estimator" id="toc-the-two-stage-least-squares-estimator" class="nav-link" data-scroll-target="#the-two-stage-least-squares-estimator"><span class="toc-section-number">6.1.1</span>  The Two-Stage Least Squares Estimator</a></li>
  <li><a href="#application-demand-for-cigarettes-12" id="toc-application-demand-for-cigarettes-12" class="nav-link" data-scroll-target="#application-demand-for-cigarettes-12"><span class="toc-section-number">6.1.2</span>  Application: Demand For Cigarettes (1/2)</a></li>
  </ul></li>
  <li><a href="#TGIVRM" id="toc-TGIVRM" class="nav-link" data-scroll-target="#TGIVRM"><span class="toc-section-number">6.2</span>  The General IV Regression Model</a>
  <ul class="collapse">
  <li><a href="#application-demand-for-cigarettes-22" id="toc-application-demand-for-cigarettes-22" class="nav-link" data-scroll-target="#application-demand-for-cigarettes-22"><span class="toc-section-number">6.2.1</span>  Application: Demand for Cigarettes (2/2)</a></li>
  </ul></li>
  <li><a href="#civ" id="toc-civ" class="nav-link" data-scroll-target="#civ"><span class="toc-section-number">6.3</span>  Checking Instrument Validity</a>
  <ul class="collapse">
  <li><a href="#instrument-relevance" id="toc-instrument-relevance" class="nav-link" data-scroll-target="#instrument-relevance"><span class="toc-section-number">6.3.1</span>  Instrument Relevance</a></li>
  <li><a href="#instrument-validity" id="toc-instrument-validity" class="nav-link" data-scroll-target="#instrument-validity"><span class="toc-section-number">6.3.2</span>  Instrument Validity</a></li>
  </ul></li>
  <li><a href="#attdfc" id="toc-attdfc" class="nav-link" data-scroll-target="#attdfc"><span class="toc-section-number">6.4</span>  Application to the Demand for Cigarettes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="ivr" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Instrumental Variables Regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>The current version of this chapter is basically completly taken from the free online book: <a href="www.econometrics-with-r.org">www.econometrics-with-r.org</a> <span class="citation" data-cites="Hanck_et_al_2019">(<a href="#ref-Hanck_et_al_2019" role="doc-biblioref">Hanck et al. 2021</a>)</span></p>
<p>Regression models may suffer from problems like omitted variables, measurement errors and simultaneous causality. If so, the error term <span class="math inline">\(\eps_i\)</span> is correlated with the regressor, <span class="math inline">\(X_{ik}\)</span> say, and the corresponding coefficient of interest, <span class="math inline">\(\beta_k\)</span>, is estimated . If one is lucky, one can add, for instance, the omitted variables to the regression to mitigate the risk of biased estimations (). However, if omitted variables cannot be measured or are not available for other reasons, multiple regression cannot solve the problem. The same issue arises if there is . When causality runs from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> (e.g.&nbsp;if <span class="math inline">\(Y=\text{Demanded quantity of a good}\)</span> and <span class="math inline">\(X=\text{Price of this good}\)</span>), there will be an estimation bias that cannot be corrected for by multiple regression.</p>
<p>A general technique for obtaining a consistent estimator of the coefficient of interest is instrumental variables (IV) regression. In this chapter we focus on the IV regression tool called <em>two-stage least squares</em> (TSLS). The first sections briefly recap the general mechanics and assumptions of IV regression and show how to perform TSLS estimation using . Next, IV regression is used for estimating the elasticity of the demand for cigarettes — a classical example where multiple regression fails to do the job because of simultaneous causality.</p>
<section id="TIVEWASRAASI" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="TIVEWASRAASI"><span class="header-section-number">6.1</span> The IV Estimator with a Single Regressor and a Single Instrument</h2>
<p>Consider the simple regression model <span class="math display">\[\begin{align}
  Y_i = \beta_1 + \beta_2 X_i + \eps_i \ \ , \ \ i=1,\dots,n, \label{eq:srm12}
\end{align}\]</span> where the error term <span class="math inline">\(\eps_i\)</span> is correlated with the regressor <span class="math inline">\(X_i\)</span> (<span class="math inline">\(X\)</span> is the called ). In this case Assumption 2 is violated, that is, strict exogeneity and orthogonality between <span class="math inline">\(X_i\)</span> and <span class="math inline">\(\eps_i\)</span> do not hold. Therefore, OLS estimation (also maximum likelihood and methods of moments estimation) is inconsistent for the true <span class="math inline">\(\beta_2\)</span>. In the most simple case, IV regression uses a single instrumental variable <span class="math inline">\(Z_i\)</span> to obtain a consistent estimator for <span class="math inline">\(\beta_2\)</span>.</p>
<span class="math inline">\(Z_i\)</span> must satisfy two conditions to be a valid instrument:
<section id="the-two-stage-least-squares-estimator" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="the-two-stage-least-squares-estimator"><span class="header-section-number">6.1.1</span> The Two-Stage Least Squares Estimator</h3>
<p>As can be guessed from its name, TSLS proceeds in two stages. In the first stage, the variation in the endogenous regressor <span class="math inline">\(X_i\)</span> is decomposed into a component that is explained by the (exogenous) instrument <span class="math inline">\(Z_i\)</span> and a problematic component that is correlated with the error <span class="math inline">\(\eps_i\)</span>. The second stage uses the problem-free component of the variation in <span class="math inline">\(X_i\)</span> to estimate <span class="math inline">\(\beta_2\)</span>.</p>
<p>The first stage regression model is</p>
<p><span class="math display">\[
X_i = \pi_0 + \pi_1 Z_i + \nu_i,
\]</span></p>
<p>where <span class="math inline">\(\pi_0 + \pi_1 Z_i\)</span> is the component of <span class="math inline">\(X_i\)</span> that is explained by <span class="math inline">\(Z_i\)</span> while <span class="math inline">\(\nu_i\)</span> is the component (an error term) that cannot be explained by <span class="math inline">\(Z_i\)</span> and exhibits correlation with <span class="math inline">\(\eps_i\)</span>.</p>
<p>Using the OLS estimates <span class="math inline">\(\widehat{\pi}_0\)</span> and <span class="math inline">\(\widehat{\pi}_1\)</span> we obtain predicted values <span class="math inline">\(\widehat{X}_i=\hat\pi_0+\hat\pi_1 Z_i,\ i=1,\dots,n\)</span>. If <span class="math inline">\(Z_i\)</span> is a valid instrument, the <span class="math inline">\(\widehat{X}_i\)</span> are problem-free in the sense that <span class="math inline">\(\widehat{X}_i\)</span> is in a regression of <span class="math inline">\(Y_i\)</span> on <span class="math inline">\(\widehat{X}_i\)</span> which is done in the second stage regression. The second stage produces <span class="math inline">\(\widehat{\beta}_1^{TSLS}\)</span> and <span class="math inline">\(\widehat{\beta}_2^{TSLS}\)</span>, the TSLS estimates of <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>.</p>
<p>For the case of a single instrument one can show that the TSLS estimator of <span class="math inline">\(\beta_2\)</span> is <span class="math display">\[\begin{align}
\widehat{\beta}_2^{TSLS} = \frac{s_{ZY}}{s_{ZX}} = \frac{\frac{1}{n-1}\sum_{i=1}^n(Y_i - \overline{Y})(Z_i - \overline{Z})}{\frac{1}{n-1}\sum_{i=1}^n(X_i - \overline{X})(Z_i - \overline{Z})}, \label{eq:simpletsls}
\end{align}\]</span> which is nothing but the ratio of the sample covariance between <span class="math inline">\(Z_i\)</span> and <span class="math inline">\(Y_i\)</span> to the sample covariance between <span class="math inline">\(Z_i\)</span> and <span class="math inline">\(X_i\)</span>.</p>
<p>The estimator in <span class="math inline">\(\eqref{eq:simpletsls}\)</span> is a consistent estimator for <span class="math inline">\(\beta_2\)</span> in <span class="math inline">\(\eqref{eq:srm12}\)</span> under the assumption that <span class="math inline">\(Z_i\)</span> is a valid instrument. The CLT implies that the distribution of <span class="math inline">\(\widehat{\beta}_2^{TSLS}\)</span> can be approximated by a normal distribution if the sample size <span class="math inline">\(n\)</span> is large. This allows us to use <span class="math inline">\(t\)</span>-statistics, <span class="math inline">\(F\)</span>-statistics, confidence intervals, etc.</p>
</section>
<section id="application-demand-for-cigarettes-12" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="application-demand-for-cigarettes-12"><span class="header-section-number">6.1.2</span> Application: Demand For Cigarettes (1/2)</h3>
<p>The relation between the demand for and the price of commodities is a simple yet widespread problem in economics. Health economics is concerned with the study of how health-affecting behavior of individuals is influenced by the health-care system and regulation policy. Probably the most prominent example in public policy debates is smoking as it is related to many illnesses and negative externalities.</p>
<p>It is plausible that cigarette consumption can be reduced by taxing cigarettes more heavily. The question is by <em>how much</em> taxes must be increased to reach a certain reduction in cigarette consumption. Economists use elasticities to answer this kind of question. Since the price elasticity for the demand of cigarettes is unknown, it must be estimated. A simple OLS regression of log quantity on log price cannot be used to estimate the effect of interest since there is simultaneous causality between demand and supply. Instead, IV regression can be used.</p>
<p>We use the data set <code>CigarettesSW</code> which comes with the package <code>AER</code>. It is a panel data set that contains observations on cigarette consumption and several economic indicators for all 48 continental federal states of the U.S. from 1985 to 1995. In the following, however, we consider data for the cross section of states in 1995 only – that is, we transform the panel data to a cross-sectional data set. We start by loading the package, attaching the data set. An overview about summary statistics for each of the variables is returned by <code>summary(CigarettesSW)</code>. Use <code>?CigarettesSW</code> for a detailed description of the variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data set and get an overview</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"AER"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"CigarettesSW"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CigarettesSW)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>     state      year         cpi          population           packs       
 AL     : 2   1985:48   Min.   :1.076   Min.   :  478447   Min.   : 49.27  
 AR     : 2   1995:48   1st Qu.:1.076   1st Qu.: 1622606   1st Qu.: 92.45  
 AZ     : 2             Median :1.300   Median : 3697472   Median :110.16  
 CA     : 2             Mean   :1.300   Mean   : 5168866   Mean   :109.18  
 CO     : 2             3rd Qu.:1.524   3rd Qu.: 5901500   3rd Qu.:123.52  
 CT     : 2             Max.   :1.524   Max.   :31493524   Max.   :197.99  
 (Other):84                                                                
     income               tax            price             taxs       
 Min.   :  6887097   Min.   :18.00   Min.   : 84.97   Min.   : 21.27  
 1st Qu.: 25520384   1st Qu.:31.00   1st Qu.:102.71   1st Qu.: 34.77  
 Median : 61661644   Median :37.00   Median :137.72   Median : 41.05  
 Mean   : 99878736   Mean   :42.68   Mean   :143.45   Mean   : 48.33  
 3rd Qu.:127313964   3rd Qu.:50.88   3rd Qu.:176.15   3rd Qu.: 59.48  
 Max.   :771470144   Max.   :99.00   Max.   :240.85   Max.   :112.63  
                                                                      </code></pre>
</div>
</div>
<p>We are interested in estimating <span class="math inline">\(\beta_2\)</span> in <span class="math display">\[\begin{align}
  \log(Q_i^{cigarettes}) = \beta_1 + \beta_2 \log(P_i^{cigarettes}) + \eps_i, \label{eq:cigstsls}
\end{align}\]</span> where <span class="math inline">\(Q_i^{cigarettes}\)</span> is the number of cigarette packs per capita sold and <span class="math inline">\(P_i^{cigarettes}\)</span> is the after-tax average real price per pack of cigarettes in state <span class="math inline">\(i=1,\dots,n=48\)</span>.</p>
The instrumental variable we are going to use for instrumenting the endogenous regressor <span class="math inline">\(\log(P_i^{cigarettes})\)</span> is <span class="math inline">\(SalesTax\)</span>, the portion of taxes on cigarettes arising from the general sales tax. <span class="math inline">\(SalesTax\)</span> is measured in dollars per pack. The idea is that:
<p>In the following, we perform some transformations in order to obtain deflated cross section data for the year 1995. We also compute the sample correlation between the sales tax and price per pack. The sample correlation is a consistent estimator of the population correlation. The estimate of approximately <span class="math inline">\(0.614\)</span> indicates that <span class="math inline">\(SalesTax\)</span> and <span class="math inline">\(P_i^{cigarettes}\)</span> exhibit positive correlation which meets our expectations: higher sales taxes lead to higher prices. However, a correlation analysis like this is not sufficient for checking whether the instrument is relevant. We will later come back to the issue of checking whether an instrument is relevant and exogenous; see Chapter @ref(civ).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute real per capita prices</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>rprice <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, price <span class="sc">/</span> cpi)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  compute the sales tax</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>salestax <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, (taxs <span class="sc">-</span> tax) <span class="sc">/</span> cpi)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check the correlation between sales tax and price</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(CigarettesSW<span class="sc">$</span>salestax, CigarettesSW<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6141228</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a subset for the year 1995</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">"1995"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first stage regression is</p>
<p><span class="math display">\[
\log(P_i^{cigarettes}) = \pi_0 + \pi_1 SalesTax_i + \nu_i.
\]</span></p>
<p>We estimate this model in using <code>lm()</code>. In the second stage we run a regression of <span class="math inline">\(\log(Q_i^{cigarettes})\)</span> on <span class="math inline">\(\widehat{\log(P_i^{cigarettes})}\)</span> to obtain <span class="math inline">\(\widehat{\beta}_1^{TSLS}\)</span> and <span class="math inline">\(\widehat{\beta}_2^{TSLS}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform the first stage regression</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cig_s1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(rprice) <span class="sc">~</span> salestax, <span class="at">data =</span> c1995)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_s1, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error  t value  Pr(&gt;|t|)    
(Intercept) 4.6165463  0.0289177 159.6444 &lt; 2.2e-16 ***
salestax    0.0307289  0.0048354   6.3549 8.489e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The first stage regression is</p>
<p><span class="math display">\[
\widehat{\log(P_i^{cigarettes})} = \underset{(0.03)}{4.62} + \underset{(0.005)}{0.031}\; SalesTax_i
\]</span></p>
<p>which predicts the relation between sales tax price per cigarettes to be positive. How much of the observed variation in <span class="math inline">\(\log(P^{cigarettes})\)</span> is explained by the instrument <span class="math inline">\(SalesTax\)</span>? This can be answered by looking at the regression’s <span class="math inline">\(R^2\)</span> which states that about <span class="math inline">\(47\%\)</span> of the variation in after tax prices is explained by the variation of the sales tax across states.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect the R^2 of the first stage regression</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cig_s1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4709961</code></pre>
</div>
</div>
<p>We next store <span class="math inline">\(\widehat{\log(P_i^{cigarettes})}\)</span>, the fitted values obtained by the first stage regression <code>cig_s1</code>, in the variable <code>lcigp_pred</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the predicted values</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>lcigp_pred <span class="ot">&lt;-</span> cig_s1<span class="sc">$</span>fitted.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we run the second stage regression which gives us the TSLS estimates we seek.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run the stage 2 regression</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>cig_s2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(c1995<span class="sc">$</span>packs) <span class="sc">~</span> lcigp_pred)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_s2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)   9.7199     1.5971  6.0859 2.153e-07 ***
lcigp_pred   -1.0836     0.3337 -3.2472  0.002178 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Thus estimating the model <span class="math inline">\(\eqref{eq:cigstsls}\)</span> using TSLS yields <span class="math display">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(1.60)}{9.72} - \underset{(0.33)}{1.08} \widehat{\log(P_i^{cigarettes})}, \label{eq:ecigstsls}
\end{align}\]</span></p>
<p>The function <code>ivreg()</code> from the package <code>AER</code> carries out TSLS procedure automatically. It is used similarly as <code>lm()</code>. Instruments can be added to the usual specification of the regression formula using a vertical bar separating the model equation from the instruments. Thus, for the regression at hand the correct formula is <code>log(packs) ~ log(rprice) | salestax</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform TSLS using 'ivreg()'</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">|</span> salestax, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> c1995)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

            Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  9.71988    1.52832  6.3598 8.346e-08 ***
log(rprice) -1.08359    0.31892 -3.3977  0.001411 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We find that the coefficient estimates coincide for both approaches.</p>
<p>The TSLS estimate for <span class="math inline">\(\beta_2\)</span> in <span class="math inline">\(\eqref{eq:ecigstsls}\)</span> suggests that an increase in cigarette prices by one percent reduces cigarette consumption by roughly <span class="math inline">\(1.08\)</span> percentage points, which is fairly elastic. However, we should keep in mind that this estimate might not be trustworthy even though we used IV estimation: there still might be a bias due to . Thus a multiple IV regression approach is needed to reduce the risk of omitted variable biases.</p>
</section>
</section>
<section id="TGIVRM" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="TGIVRM"><span class="header-section-number">6.2</span> The General IV Regression Model</h2>
The simple IV regression model is easily extended to a multiple regression model which we refer to as the general IV regression model. In this model we distinguish between four types of variables: the dependent variable, included exogenous variables, included endogenous variables and instrumental variables: <span class="math display">\[\begin{align}
  Y_i = \beta_1 + \beta_2 X_{2i} + \dots + \beta_K X_{Ki} + \beta_{K+1} W_{1i} + \dots + \beta_{K+r} W_{ri} + \eps_i, \label{eq:givmodel}
\end{align}\]</span> with <span class="math inline">\(i=1,\dots,n\)</span> is the general instrumental variables regression model where
<p>The coefficients are if <span class="math inline">\(m&gt;(K-1)\)</span>. If <span class="math inline">\(m&lt;(K-1)\)</span>, the coefficients are and when <span class="math inline">\(m=(K-1)\)</span> they are . For estimation of the IV regression model we require exact identification or overidentification.</p>
<p>Estimating regression models with TSLS using multiple instruments by means of <code>ivreg()</code> is straightforward. There are, however, some subtleties in correctly specifying the regression formula. Assume that you want to estimate the model</p>
<p><span class="math display">\[
Y_i = \beta_1 + \beta_2 X_{2i} + \beta_3 X_{3i} + \beta_4 W_{1i} + \eps_i
\]</span></p>
<p>where <span class="math inline">\(X_{2i}\)</span> and <span class="math inline">\(X_{3i}\)</span> are endogenous regressors that shall be instrumented by <span class="math inline">\(Z_{1i}\)</span>, <span class="math inline">\(Z_{2i}\)</span> and <span class="math inline">\(Z_{3i}\)</span>, and where <span class="math inline">\(W_{1i}\)</span> is an exogenous regressor. Say the corresponding data is available in a <code>data.frame</code> with column names <code>y</code>, <code>x2</code>, <code>x3</code>, <code>w1</code>, <code>z1</code>, <code>z2</code> and <code>z3</code>. It might be tempting to specify the argument <code>formula</code> in your call of <code>ivreg()</code> as <code>y ~ x2 + x3 + w1 | z1 + z2 + z3</code> which is, however, . As explained in the documentation of <code>ivreg()</code> (see <code>?ivreg</code>), it is necessary to list <em>all</em> exogenous variables as instruments too, that is joining them by <code>+</code>’s on the right of the vertical bar: <code>y ~ x2 + x3 + w1 | w1 + z1 + z2 + z3</code>, where <code>w1</code> is “instrumenting itself”.</p>
<p>Similarly to the simple IV regression model, the general IV model <span class="math inline">\(\eqref{eq:givmodel}\)</span> can be estimated using the two-stage least squares estimator:</p>
In the general IV regression model, the instrument relevance and instrument exogeneity assumptions are equivalent to the case of the simple regression model with a single endogenous regressor and only one instrument. That is, for <span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> to be a set of valid instruments, the following two conditions must be fulfilled:
<p>One can show that if the IV regression assumptions hold, the TSLS estimator in <span class="math inline">\(\eqref{eq:givmodel}\)</span> is consistent and normally distributed when the sample size <span class="math inline">\(n\)</span> is large. That is, if we have valid instruments, we obtain valid statistical inference using <span class="math inline">\(t\)</span>-tests, <span class="math inline">\(F\)</span>-tests and confidence intervals for the model coefficients.</p>
<section id="application-demand-for-cigarettes-22" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="application-demand-for-cigarettes-22"><span class="header-section-number">6.2.1</span> Application: Demand for Cigarettes (2/2)</h3>
<p>The estimated elasticity of the demand for cigarettes in <span class="math inline">\(\eqref{eq:srm12}\)</span> is <span class="math inline">\(1.08\)</span>. Although <span class="math inline">\(\eqref{eq:srm12}\)</span> was estimated using IV regression it is plausible that this IV estimate is biased. The TSLS estimator is inconsistent for the true <span class="math inline">\(\beta_2\)</span> if the instrument (here: the real sales tax per pack) is invalid, i.e., if the instrument correlates with the error term. This is likely to be the case here since there are economic factors, like state income, which impact the demand for cigarettes and correlate with the sales tax. States with high personal income tend to generate tax revenues by income taxes and less by sales taxes. Consequently, state income should be included in the regression model. <span class="math display">\[\begin{align}
  \log(Q_i^{cigarettes}) = \beta_1 + \beta_2 \log(P_i^{cigarettes}) + \beta_3 \log(income_i) + \eps_i \label{eq:mcigstsls1}
\end{align}\]</span></p>
<p>Before estimating <span class="math inline">\(\eqref{eq:mcigstsls1}\)</span> using <code>ivreg()</code> we define <span class="math inline">\(income\)</span> as real per capita income <code>rincome</code> and append it to the data set <code>CigarettesSW</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add real income to the dataset (cpi: consumer price index)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>rincome <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                             income <span class="sc">/</span> population <span class="sc">/</span> cpi)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">"1995"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">log</span>(rincome) <span class="sc">|</span> <span class="fu">log</span>(rincome) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                    salestax, <span class="at">data =</span> c1995)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)   9.43066    1.25939  7.4883 1.935e-09 ***
log(rprice)  -1.14338    0.37230 -3.0711  0.003611 ** 
log(rincome)  0.21452    0.31175  0.6881  0.494917    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We obtain <span class="math display">\[\begin{align}
  \widehat{\log(Q_i^{cigarettes})} = \underset{(1.26)}{9.42} - \underset{(0.37)}{1.14} \log(P_i^{cigarettes}) + \underset{(0.31)}{0.21} \log(income_i). \label{eq:emcigstsls2}
\end{align}\]</span></p>
<p>In the following we add the cigarette-specific taxes (<span class="math inline">\(cigtax_i\)</span>) as a further instrumental variable and estimate again using TSLS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add cigtax to the data set</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>CigarettesSW<span class="sc">$</span>cigtax <span class="ot">&lt;-</span> <span class="fu">with</span>(CigarettesSW, tax<span class="sc">/</span>cpi)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>c1995 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">"1995"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the model</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(<span class="fu">log</span>(packs) <span class="sc">~</span> <span class="fu">log</span>(rprice) <span class="sc">+</span> <span class="fu">log</span>(rincome) <span class="sc">|</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">log</span>(rincome) <span class="sc">+</span> salestax <span class="sc">+</span> cigtax, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> c1995)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)   9.89496    0.95922 10.3157 1.947e-13 ***
log(rprice)  -1.27742    0.24961 -5.1177 6.211e-06 ***
log(rincome)  0.28040    0.25389  1.1044    0.2753    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Using the two instruments <span class="math inline">\(salestax_i\)</span> and <span class="math inline">\(cigtax_i\)</span> we have <span class="math inline">\(m=2\)</span> for one endogenous regressor – so the coefficient on the endogenous regressor <span class="math inline">\(\log(P_i^{cigarettes})\)</span> is <em>overidentified</em>. The TSLS estimate of <span class="math inline">\(\eqref{eq:mcigstsls1}\)</span> is</p>
<p><span class="math display">\[\begin{align}
\widehat{\log(Q_i^{cigarettes})} = \underset{(0.96)}{9.89} - \underset{(0.25)}{1.28} \log(P_i^{cigarettes}) + \underset{(0.25)}{0.28} \log(income_i). \label{eq:emcigstsls3}
\end{align}\]</span></p>
<p>Should we trust the estimates presented in <span class="math inline">\(\eqref{eq:emcigstsls2}\)</span> or rather rely on <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span>? The estimates obtained using both instruments are more precise since in <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span> all standard errors reported are smaller than in <span class="math inline">\(\eqref{eq:emcigstsls2}\)</span>. In fact, the standard error for the estimate of the demand elasticity is only two thirds of the standard error when the sales tax is the only instrument used. This is due to more information being used in estimation <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span>. <em>If</em> the instruments are valid, <span class="math inline">\(\eqref{eq:emcigstsls3}\)</span> can be considered more reliable.</p>
<p>However, without insights regarding the validity of the instruments it is not sensible to make such a statement. This stresses why checking instrument validity is essential. Chapter @ref(civ) briefly discusses guidelines in checking instrument validity and presents approaches that allow to test for instrument relevance and exogeneity under certain conditions. These are then used in an application to the demand for cigarettes in Chapter @ref(attdfc).</p>
</section>
</section>
<section id="civ" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="civ"><span class="header-section-number">6.3</span> Checking Instrument Validity</h2>
<section id="instrument-relevance" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="instrument-relevance"><span class="header-section-number">6.3.1</span> Instrument Relevance</h3>
<p>Instruments that explain little variation in the endogenous regressor <span class="math inline">\(X_i\)</span> are called <em>weak instruments</em>. Weak instruments provide little information about the variation in <span class="math inline">\(X_i\)</span> that is exploited by IV regression to estimate the effect of interest: the estimate of the coefficient on the endogenous regressor is estimated inaccurately. Moreover, weak instruments cause the distribution of the estimator to deviate considerably from a normal distribution even in large samples such that the usual methods for obtaining inference about the true coefficient on <span class="math inline">\(X_i\)</span> may produce wrong results.</p>
<p>Consider the case of a single endogenous regressor <span class="math inline">\(X_i\)</span> and <span class="math inline">\(m\)</span> instruments <span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span>. If the coefficients on all instruments in the population first-stage regression of a TSLS estimation are zero, the instruments do not explain any of the variation in the <span class="math inline">\(X_i\)</span> which clearly violates assumption that instruments must be relevant. Although the latter case is unlikely to be encountered in practice, we should ask ourselves to what extent the assumption of instrument relevance should be fulfilled. While this is hard to answer for general IV regression, in the case of a endogenous regressor <span class="math inline">\(X_i\)</span> one may use : Compute the <span class="math inline">\(F\)</span>-statistic which corresponds to the hypothesis that the coefficients on <span class="math inline">\(Z_{1i},\dots,Z_{mi}\)</span> are all zero in the first-stage regression. If the <span class="math inline">\(F\)</span>-statistic is less than <span class="math inline">\(10\)</span>, the instruments are such that the TSLS estimate of the coefficient on <span class="math inline">\(X_i\)</span> is probably biased and no valid statistical inference about its true value can be made.</p>
<p>This rule of thumb is easily implemented in . Run the first-stage regression using <code>lm()</code> and subsequently compute the heteroskedasticity-robust <span class="math inline">\(F\)</span>-statistic by means of <code>linearHypothesis()</code>. This is part of the application to the demand for cigarettes discussed in Chapter @ref(attdfc).</p>
<section id="if-instruments-are-weak" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="if-instruments-are-weak">If Instruments are Weak</h4>
<p>There are two ways to proceed if instruments are weak:</p>
<ol type="1">
<li><p>Discard the weak instruments and/or find stronger instruments. While the former is only an option if the unknown coefficients remain identified when the weak instruments are discarded, the latter can be very difficult and even may require a redesign of the whole study.</p></li>
<li><p>Stick with the weak instruments but use methods that improve upon TSLS in this scenario, for example limited information maximum likelihood estimation. (Out of the scope of this course.)</p></li>
<li><p>Use tests that allow for inferences robust to weak instruments: </p></li>
</ol>
<!-- \citep{AR1949} -->
</section>
</section>
<section id="instrument-validity" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="instrument-validity"><span class="header-section-number">6.3.2</span> Instrument Validity</h3>
<p>If there is correlation between an instrument and the error term, IV regression is not consistent. The overidentifying restrictions test (also called the <span class="math inline">\(J\)</span>-test) is an approach to test the hypothesis that instruments are exogenous. For the <span class="math inline">\(J\)</span>-test to be applicable there need to be more instruments than endogenous regressors.</p>
<!-- or \say{Overidentifying Restrictions Test} -->
<p>Take <span class="math inline">\(\hat{\eps}_i^{TSLS},\ i = 1,\dots,n\)</span>, the residuals of the TSLS estimation of the general IV regression model <span class="math inline">\(\eqref{eq:givmodel}\)</span>. Run the OLS regression <span class="math display">\[\begin{align}
\hat{\eps}_i^{TSLS} =&amp; \delta_0 + \delta_1 Z_{1i} + \dots + \delta_m Z_{mi} + \delta_{m+1} W_{1i} + \dots + \delta_{m+r} W_{ri} + e_i \label{eq:jstatreg}
\end{align}\]</span> and test the joint hypothesis</p>
<p><span class="math display">\[
H_0: \delta_1 = \dots \delta_{m} = 0
\]</span></p>
<p>which states that all instruments are exogenous. This can be done using the corresponding <span class="math inline">\(F\)</span>-statistic by computing</p>
<p><span class="math display">\[
J = m  F.
\]</span></p>
<p>This test is the overidentifying restrictions test and the statistic is called the <span class="math inline">\(J\)</span>-statistic with</p>
<p><span class="math display">\[
J \overset{H_0}{\to}_d \chi^2_{m-(K-1)}\quad\text{as}\quad n\to\infty
\]</span></p>
<p>under the . The degrees of freedom <span class="math inline">\(m-(K-1)\)</span> state the degree of overidentification since this is the number of instruments <span class="math inline">\(m\)</span> minus the number of endogenous regressors <span class="math inline">\(K-1\)</span>.</p>
<p>It is important to note that the <span class="math inline">\(J\)</span>-statistic is only <span class="math inline">\(\chi^2_{m-(K-1)}\)</span> distributed when the error term <span class="math inline">\(\eps_i\)</span> in the regression @ref(eq:jstatreg) is homoskedastic. A discussion of the heteroskedasticity-robust <span class="math inline">\(J\)</span>-statistic is beyond the scope of this chapter. The application in the next section shows how to apply the <span class="math inline">\(J\)</span>-test using <code>linearHypothesis()</code>.</p>
</section>
</section>
<section id="attdfc" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="attdfc"><span class="header-section-number">6.4</span> Application to the Demand for Cigarettes</h2>
<p>Are the general sales tax and the cigarette-specific tax valid instruments? If not, TSLS is not helpful to estimate the demand elasticity for cigarettes discussed in Chapter @ref(TGIVRM). As discussed in Chapter @ref(TIVEWASRAASI), both variables are likely to be relevant but whether they are exogenous is a different question.</p>
<p>One can argue that cigarette-specific taxes could be endogenous because there might be state specific historical factors like economic importance of the tobacco farming and cigarette production industry that lobby for low cigarette specific taxes. Since it is plausible that tobacco growing states have higher rates of smoking than others, this would lead to endogeneity of cigarette specific taxes. If we had data on the size on the tobacco and cigarette industry, we could solve this potential issue by including the information in the regression. Unfortunately, this is not the case.</p>
<p>However, since the role of the tobacco and cigarette industry is a factor that can be assumed to differ across states but not over time we may exploit the panel structure of <code>CigarettesSW</code>. Alternatively, a (non-panel) regression using data on <em>changes</em> between two time periods eliminates such state specific and time invariant effects. Next, we consider such changes in variables between 1985 and 1995. That is, we are interested in estimating the <em>long-run elasticity</em> of the demand for cigarettes.</p>
<p>The model to be estimated by TSLS using the general sales tax and the cigarette-specific sales tax as instruments hence is <span class="math display">\[\begin{align}
\begin{split}
  \log(Q_{i,1995}^{cigarettes}) - \log(Q_{i,1985}^{cigarettes}) =
  &amp; \, \beta_1 + \beta_2 \left[\log(P_{i,1995}^{cigarettes}) - \log(P_{i,1985}^{cigarettes}) \right] \\
  &amp;+ \beta_3 \left[\log(income_{i,1995}) - \log(income_{i,1985})\right] + \eps_i. \end{split}(\#eq:diffivreg)
\end{align}\]</span></p>
<p>We first create differences from 1985 to 1995 for the dependent variable, the regressors and both instruments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset data for year 1985</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>c1985 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">"1985"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define differences in variables</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>packsdiff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>packs) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>packs)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>pricediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>price<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>price<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>incomediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>income<span class="sc">/</span>c1995<span class="sc">$</span>population<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(c1985<span class="sc">$</span>income<span class="sc">/</span>c1985<span class="sc">$</span>population<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>salestaxdiff <span class="ot">&lt;-</span> (c1995<span class="sc">$</span>taxs <span class="sc">-</span> c1995<span class="sc">$</span>tax)<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> (c1985<span class="sc">$</span>taxs <span class="sc">-</span> c1985<span class="sc">$</span>tax)<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>cigtaxdiff <span class="ot">&lt;-</span> c1995<span class="sc">$</span>tax<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> c1985<span class="sc">$</span>tax<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now perform three different IV estimations of @ref(eq:diffivreg) using <code>ivreg()</code>:</p>
<ol type="1">
<li><p>TSLS using only the difference in the sales taxes between 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using only the difference in the cigarette-specific sales taxes 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using both the difference in the sales taxes 1985 and 1995 and the difference in the cigarette-specific sales taxes 1985 and 1995 as instruments.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the three models</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff1 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                         cigtaxdiff)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff <span class="sc">+</span> cigtaxdiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As usual we use <code>coeftest()</code> in conjunction with <code>vcovHC()</code> to obtain robust coefficient summaries for all models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 1.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff1, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) -0.117962   0.068217 -1.7292   0.09062 .  
pricediff   -0.938014   0.207502 -4.5205 4.454e-05 ***
incomediff   0.525970   0.339494  1.5493   0.12832    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 2.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) -0.017049   0.067217 -0.2536    0.8009    
pricediff   -1.342515   0.228661 -5.8712 4.848e-07 ***
incomediff   0.428146   0.298718  1.4333    0.1587    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 3.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept) -0.052003   0.062488 -0.8322    0.4097    
pricediff   -1.202403   0.196943 -6.1053 2.178e-07 ***
incomediff   0.462030   0.309341  1.4936    0.1423    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We proceed by generating a tabulated summary of the estimation results using <code>stargazer()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff1, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff2, <span class="at">type =</span> <span class="st">"HC1"</span>))),</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff3, <span class="at">type =</span> <span class="st">"HC1"</span>))))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(cig_ivreg_diff1, cig_ivreg_diff2, cig_ivreg_diff3,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"latex"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">"n"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">"IV: salestax"</span>, <span class="st">"IV: cigtax"</span>, </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"IVs: salestax, cigtax"</span>),</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption =</span> </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="st">"Dependent Variable: 1985-1995 Difference in Log per Pack Price"</span>,</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>

<!-- ```{r, message=F, warning=F, results='asis', echo=F, purl=F, eval=my_output == "html"} -->
<!-- # gather robust standard errors in a list -->
<!-- rob_se <- list(sqrt(diag(vcovHC(cig_ivreg_diff1, type = "HC1"))), -->
<!--                sqrt(diag(vcovHC(cig_ivreg_diff2, type = "HC1"))), -->
<!--                sqrt(diag(vcovHC(cig_ivreg_diff3, type = "HC1")))) -->

<!-- stargazer(cig_ivreg_diff1, cig_ivreg_diff2,cig_ivreg_diff3, -->
<!--   header = FALSE,  -->
<!--   type = "html", -->
<!--   digits = 3,  -->
<!--   column.labels = c("IV: salestax", "IV: cigtax", "IVs: salestax, cigtax"), -->
<!--   dep.var.labels.include = FALSE, -->
<!--   dep.var.caption = "Dependent variable: 1985-1995 difference in log per pack price", -->
<!--   se = rob_se) -->

<!-- stargazer_html_title("TSLS Estimates of the Long-Term Elasticity of the Demand for Cigarettes using Panel Data", "tslseotlteotdfcupd") -->
<!-- ``` -->

</p>
<p>Table @ref(tab:tslseotlteotdfcupd) reports negative estimates of the coefficient on <code>pricediff</code> that are quite different in magnitude. Which one should we trust? This hinges on the validity of the instruments used. To assess this we compute <span class="math inline">\(F\)</span>-statistics for the first-stage regressions of all three models to check instrument relevance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first-stage regressions</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mod_relevance1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> salestaxdiff <span class="sc">+</span> incomediff)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>mod_relevance2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> cigtaxdiff   <span class="sc">+</span> incomediff)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>mod_relevance3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> incomediff   <span class="sc">+</span> salestaxdiff <span class="sc">+</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                                                cigtaxdiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (1)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance1, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"salestaxdiff = 0"</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
salestaxdiff = 0

Model 1: restricted model
Model 2: pricediff ~ salestaxdiff + incomediff

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F    Pr(&gt;F)    
1     46                        
2     45  1 28.445 3.009e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (2)</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance2, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"cigtaxdiff = 0"</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
cigtaxdiff = 0

Model 1: restricted model
Model 2: pricediff ~ cigtaxdiff + incomediff

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F   Pr(&gt;F)    
1     46                       
2     45  1 98.034 7.09e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (3)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance3, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">"salestaxdiff = 0"</span>, <span class="st">"cigtaxdiff = 0"</span>), </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">"HC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
salestaxdiff = 0
cigtaxdiff = 0

Model 1: restricted model
Model 2: pricediff ~ incomediff + salestaxdiff + cigtaxdiff

Note: Coefficient covariance matrix supplied.

  Res.Df Df      F    Pr(&gt;F)    
1     46                        
2     44  2 76.916 4.339e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>All <span class="math inline">\(F\)</span>-statistics are larger than <span class="math inline">\(10\)</span>; so, the rule of thumb for detecting weak instruments would suggest that the instruments are not weak.</p>
<p>Next, we also conduct the overidentifying restrictions test for model three which is the only model where the coefficient on the difference in log prices is overidentified (<span class="math inline">\(m=2\)</span>, <span class="math inline">\((K-1)=1\)</span>) such that the <span class="math inline">\(J\)</span>-statistic can be computed. To do this we take the residuals stored in <code>cig_ivreg_diff3</code> and regress them on both instruments and the presumably exogenous regressor <code>incomediff</code>. We again use <code>linearHypothesis()</code> to test whether the coefficients on both instruments are zero which is necessary for the exogeneity assumption to be fulfilled. Note that with <code>test = "Chisq"</code> we obtain a chi-squared distributed test statistic instead of an <span class="math inline">\(F\)</span>-statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the J-statistic</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>cig_iv_OR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">residuals</span>(cig_ivreg_diff3) <span class="sc">~</span> incomediff <span class="sc">+</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                                 salestaxdiff <span class="sc">+</span> cigtaxdiff)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>cig_OR_test <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(cig_iv_OR, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">"salestaxdiff = 0"</span>, </span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"cigtaxdiff = 0"</span>), </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>cig_OR_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear hypothesis test

Hypothesis:
salestaxdiff = 0
cigtaxdiff = 0

Model 1: restricted model
Model 2: residuals(cig_ivreg_diff3) ~ incomediff + salestaxdiff + cigtaxdiff

  Res.Df     RSS Df Sum of Sq Chisq Pr(&gt;Chisq)  
1     46 0.37472                                
2     44 0.33695  2  0.037769 4.932    0.08492 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Caution</strong>: In this case the <span class="math inline">\(p\)</span>-value reported by <code>linearHypothesis()</code> is wrong because the degrees of freedom are set to <span class="math inline">\(2\)</span>. This differs from the degree of overidentification (<span class="math inline">\(m-(K-1)=2-(2-1)=1\)</span>) so the <span class="math inline">\(J\)</span>-statistic is <span class="math inline">\(\chi^2_1\)</span> distributed instead of following a <span class="math inline">\(\chi^2_2\)</span> distribution as assumed defaultly by <code>linearHypothesis()</code>. We may compute the correct <span class="math inline">\(p\)</span>-value using <code>pchisq()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute correct p-value for J-statistic</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(cig_OR_test[<span class="dv">2</span>, <span class="dv">5</span>], <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02636406</code></pre>
</div>
</div>
<p>Since this value is smaller than <span class="math inline">\(0.05\)</span> we reject the hypothesis that both instruments are exogenous at the level of <span class="math inline">\(5\%\)</span>. This means one of the following:</p>
<ol type="1">
<li>The sales tax is an invalid instrument for the per-pack price.</li>
<li>The cigarettes-specific sales tax is an invalid instrument for the per-pack price.</li>
<li>Both instruments are invalid.</li>
</ol>
<p>One can argue that the assumption of instrument exogeneity is more likely to hold for the general sales tax such that the IV estimate of the long-run elasticity of demand for cigarettes we consider the most trustworthy is <span class="math inline">\(-0.94\)</span>, the TSLS estimate obtained using the general sales tax as the only instrument.</p>
<p>The interpretation of this estimate is that over a 10-year period, an increase in the average price per package by one percent is expected to decrease consumption by about <span class="math inline">\(0.94\)</span> percentage points. This suggests that, in the long run, price increases can reduce cigarette consumption considerably.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Hanck_et_al_2019" class="csl-entry" role="doc-biblioentry">
Hanck, Christoph, Martin Arnold, Alexander Gerber, and Martin Schmelzer. 2021. <span>“Introduction to Econometrics with <span>R</span>.”</span> <a href="https://www.econometrics-with-r.org">www.econometrics-with-r.org</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-Asymptotics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Large Sample Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>