<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)</title>
  <meta name="description" content="6.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/mylogo.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.4 Application to the Demand for Cigarettes | Econometrics (M.Sc.)" />
  
  
  <meta name="twitter:image" content="/images/mylogo.png" />

<meta name="author" content="Prof. Dr. Dominik Liebl" />


<meta name="date" content="2022-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="civ.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#organization-of-the-course" id="toc-organization-of-the-course">Organization of the Course</a></li>
<li><a href="index.html#literature" id="toc-literature">Literature</a></li>
</ul></li>
<li><a href="introduction-to-r.html#introduction-to-r" id="toc-introduction-to-r"><span class="toc-section-number">1</span> Introduction to R</a>
<ul>
<li><a href="short-glossary.html#short-glossary" id="toc-short-glossary"><span class="toc-section-number">1.1</span> Short Glossary</a></li>
<li><a href="first-steps.html#first-steps" id="toc-first-steps"><span class="toc-section-number">1.2</span> First Steps</a></li>
<li><a href="further-data-objects.html#further-data-objects" id="toc-further-data-objects"><span class="toc-section-number">1.3</span> Further Data Objects</a></li>
<li><a href="simple-regression-analysis-using-r.html#simple-regression-analysis-using-r" id="toc-simple-regression-analysis-using-r"><span class="toc-section-number">1.4</span> Simple Regression Analysis using R</a></li>
<li><a href="programming-in-r.html#programming-in-r" id="toc-programming-in-r"><span class="toc-section-number">1.5</span> Programming in R</a></li>
<li><a href="r-packages.html#r-packages" id="toc-r-packages"><span class="toc-section-number">1.6</span> R-packages</a></li>
<li><a href="tidyverse.html#tidyverse" id="toc-tidyverse"><span class="toc-section-number">1.7</span> Tidyverse</a>
<ul>
<li><a href="tidyverse.html#tidyverse-plotting-basics" id="toc-tidyverse-plotting-basics"><span class="toc-section-number">1.7.1</span> Tidyverse: Plotting Basics</a></li>
<li><a href="tidyverse.html#tidyverse-data-wrangling-basics" id="toc-tidyverse-data-wrangling-basics"><span class="toc-section-number">1.7.2</span> Tidyverse: Data Wrangling Basics</a></li>
<li><a href="tidyverse.html#the-pipe-operator" id="toc-the-pipe-operator"><span class="toc-section-number">1.7.3</span> The pipe operator <code>%&gt;%</code></a></li>
<li><a href="tidyverse.html#the-group_by-function" id="toc-the-group_by-function"><span class="toc-section-number">1.7.4</span> The <code>group_by()</code> function</a></li>
</ul></li>
<li><a href="further-links.html#further-links" id="toc-further-links"><span class="toc-section-number">1.8</span> Further Links</a>
<ul>
<li><a href="further-links.html#further-r-intros" id="toc-further-r-intros"><span class="toc-section-number">1.8.1</span> Further R-Intros</a></li>
<li><a href="further-links.html#version-control-gitgithub" id="toc-version-control-gitgithub"><span class="toc-section-number">1.8.2</span> Version Control (Git/GitHub)</a></li>
<li><a href="further-links.html#r-ladies" id="toc-r-ladies"><span class="toc-section-number">1.8.3</span> R-Ladies</a></li>
</ul></li>
</ul></li>
<li><a href="ReviewStats.html#ReviewStats" id="toc-ReviewStats"><span class="toc-section-number">2</span> Review: Probability and Statistics</a>
<ul>
<li><a href="probability-theory.html#probability-theory" id="toc-probability-theory"><span class="toc-section-number">2.1</span> Probability Theory</a>
<ul>
<li><a href="probability-theory.html#sample-spaces-and-elementary-events" id="toc-sample-spaces-and-elementary-events"><span class="toc-section-number">2.1.1</span> Sample Spaces and (Elementary) Events</a></li>
<li><a href="probability-theory.html#probability" id="toc-probability"><span class="toc-section-number">2.1.2</span> Probability</a></li>
<li><a href="probability-theory.html#independent-events" id="toc-independent-events"><span class="toc-section-number">2.1.3</span> Independent Events</a></li>
<li><a href="probability-theory.html#conditional-probability" id="toc-conditional-probability"><span class="toc-section-number">2.1.4</span> Conditional Probability</a></li>
</ul></li>
<li><a href="random-variables.html#random-variables" id="toc-random-variables"><span class="toc-section-number">2.2</span> Random Variables</a>
<ul>
<li><a href="random-variables.html#univariate-distribution-and-probability-functions" id="toc-univariate-distribution-and-probability-functions"><span class="toc-section-number">2.2.1</span> Univariate Distribution and Probability Functions</a></li>
<li><a href="random-variables.html#multivariate-distribution-and-probability-functions" id="toc-multivariate-distribution-and-probability-functions"><span class="toc-section-number">2.2.2</span> Multivariate Distribution and Probability Functions</a></li>
<li><a href="random-variables.html#means-and-moments" id="toc-means-and-moments"><span class="toc-section-number">2.2.3</span> Means and Moments</a></li>
<li><a href="random-variables.html#unconditional-means" id="toc-unconditional-means"><span class="toc-section-number">2.2.4</span> Unconditional Means</a></li>
<li><a href="random-variables.html#conditional-means" id="toc-conditional-means"><span class="toc-section-number">2.2.5</span> Conditional Means</a></li>
<li><a href="random-variables.html#means-of-transformed-random-variables-and-moments" id="toc-means-of-transformed-random-variables-and-moments"><span class="toc-section-number">2.2.6</span> Means of Transformed Random Variables and Moments</a></li>
<li><a href="random-variables.html#independent-random-variables" id="toc-independent-random-variables"><span class="toc-section-number">2.2.7</span> Independent Random Variables</a></li>
<li><a href="random-variables.html#i.i.d.-samples" id="toc-i.i.d.-samples"><span class="toc-section-number">2.2.8</span> I.I.D. Samples</a></li>
<li><a href="random-variables.html#some-important-discrete-random-variables" id="toc-some-important-discrete-random-variables"><span class="toc-section-number">2.2.9</span> Some Important Discrete Random Variables</a></li>
<li><a href="random-variables.html#some-important-continuous-random-variables" id="toc-some-important-continuous-random-variables"><span class="toc-section-number">2.2.10</span> Some Important Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li><a href="ch:MLR.html#ch:MLR" id="toc-ch:MLR"><span class="toc-section-number">3</span> Multiple Linear Regression</a>
<ul>
<li><a href="assumptions.html#assumptions" id="toc-assumptions"><span class="toc-section-number">3.1</span> Assumptions</a>
<ul>
<li><a href="assumptions.html#some-implications-of-the-exogeneity-assumption" id="toc-some-implications-of-the-exogeneity-assumption"><span class="toc-section-number">3.1.1</span> Some Implications of the Exogeneity Assumption</a></li>
</ul></li>
<li><a href="deriving-the-expression-of-the-ols-estimator.html#deriving-the-expression-of-the-ols-estimator" id="toc-deriving-the-expression-of-the-ols-estimator"><span class="toc-section-number">3.2</span> Deriving the Expression of the OLS Estimator</a></li>
<li><a href="some-quantities-of-interest.html#some-quantities-of-interest" id="toc-some-quantities-of-interest"><span class="toc-section-number">3.3</span> Some Quantities of Interest</a></li>
<li><a href="method-of-moments-estimator.html#method-of-moments-estimator" id="toc-method-of-moments-estimator"><span class="toc-section-number">3.4</span> Method of Moments Estimator</a></li>
<li><a href="unbiasedness-of-hatbetax-and-hatbeta.html#unbiasedness-of-hatbetax-and-hatbeta" id="toc-unbiasedness-of-hatbetax-and-hatbeta"><span class="toc-section-number">3.5</span> Unbiasedness of <span class="math inline">\(\hat\beta|X\)</span> and <span class="math inline">\(\hat\beta\)</span></a></li>
<li><a href="ch:VarEstBeta.html#ch:VarEstBeta" id="toc-ch:VarEstBeta"><span class="toc-section-number">3.6</span> Variance and Standard Error of <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li><a href="the-gauss-markov-theorem.html#the-gauss-markov-theorem" id="toc-the-gauss-markov-theorem"><span class="toc-section-number">3.7</span> The Gauss-Markov Theorem</a></li>
<li><a href="practice-real-data.html#practice-real-data" id="toc-practice-real-data"><span class="toc-section-number">3.8</span> Practice: Real Data</a>
<ul>
<li><a href="practice-real-data.html#dummy-variables-contrast-codings-and-interactions" id="toc-dummy-variables-contrast-codings-and-interactions">Dummy Variables, Contrast Codings, and Interactions</a></li>
<li><a href="practice-real-data.html#the-function" id="toc-the-function">The Function </a></li>
</ul></li>
<li><a href="practice-simulation.html#practice-simulation" id="toc-practice-simulation"><span class="toc-section-number">3.9</span> Practice: Simulation</a>
<ul>
<li><a href="practice-simulation.html#behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i" id="toc-behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i"><span class="toc-section-number">3.9.1</span> Behavior of the OLS Estimates for Resampled Data (conditionally on <span class="math inline">\(X_i\)</span>)</a></li>
</ul></li>
</ul></li>
<li><a href="ch:SSINF.html#ch:SSINF" id="toc-ch:SSINF"><span class="toc-section-number">4</span> Small Sample Inference</a>
<ul>
<li><a href="ch:testmultp.html#ch:testmultp" id="toc-ch:testmultp"><span class="toc-section-number">4.1</span> Hypothesis Tests about Multiple Parameters</a>
<ul>
<li><a href="ch:testmultp.html#the-test-statistic-and-its-null-distribution" id="toc-the-test-statistic-and-its-null-distribution"><span class="toc-section-number">4.1.1</span> The Test Statistic and its Null Distribution</a></li>
</ul></li>
<li><a href="ch:testingsinglep.html#ch:testingsinglep" id="toc-ch:testingsinglep"><span class="toc-section-number">4.2</span> Tests about One Parameter</a></li>
<li><a href="testtheory.html#testtheory" id="toc-testtheory"><span class="toc-section-number">4.3</span> Testtheory</a>
<ul>
<li><a href="testtheory.html#significance-level" id="toc-significance-level"><span class="toc-section-number">4.3.1</span> Significance Level</a></li>
<li><a href="testtheory.html#critical-value-for-the-f-test" id="toc-critical-value-for-the-f-test"><span class="toc-section-number">4.3.2</span> Critical Value for the <span class="math inline">\(F\)</span>-Test</a></li>
<li><a href="testtheory.html#critical-values-for-the-t-test" id="toc-critical-values-for-the-t-test"><span class="toc-section-number">4.3.3</span> Critical Value(s) for the <span class="math inline">\(t\)</span>-Test</a></li>
</ul></li>
<li><a href="type-ii-error-and-power.html#type-ii-error-and-power" id="toc-type-ii-error-and-power"><span class="toc-section-number">4.4</span> Type II Error and Power</a></li>
<li><a href="p-value.html#p-value" id="toc-p-value"><span class="toc-section-number">4.5</span> <span class="math inline">\(p\)</span>-Value</a></li>
<li><a href="CIsmallsample.html#CIsmallsample" id="toc-CIsmallsample"><span class="toc-section-number">4.6</span> Confidence Intervals</a></li>
<li><a href="PSSI.html#PSSI" id="toc-PSSI"><span class="toc-section-number">4.7</span> Practice: Small Sample Inference</a>
<ul>
<li><a href="PSSI.html#normally-distributed-hatbetax" id="toc-normally-distributed-hatbetax"><span class="toc-section-number">4.7.1</span> Normally Distributed <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li><a href="PSSI.html#testing-multiple-parameters" id="toc-testing-multiple-parameters"><span class="toc-section-number">4.7.2</span> Testing Multiple Parameters</a></li>
<li><a href="PSSI.html#dualty-of-confidence-intervals-and-hypothesis-tests" id="toc-dualty-of-confidence-intervals-and-hypothesis-tests"><span class="toc-section-number">4.7.3</span> Dualty of Confidence Intervals and Hypothesis Tests</a></li>
</ul></li>
</ul></li>
<li><a href="ch:LSINF.html#ch:LSINF" id="toc-ch:LSINF"><span class="toc-section-number">5</span> Large Sample Inference</a>
<ul>
<li><a href="tools-for-asymptotic-statistics.html#tools-for-asymptotic-statistics" id="toc-tools-for-asymptotic-statistics"><span class="toc-section-number">5.1</span> Tools for Asymptotic Statistics</a>
<ul>
<li><a href="tools-for-asymptotic-statistics.html#modes-of-convergence" id="toc-modes-of-convergence"><span class="toc-section-number">5.1.1</span> Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#four-important-modes-of-convergence" id="toc-four-important-modes-of-convergence">Four Important Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#relations-among-modes-of-convergence" id="toc-relations-among-modes-of-convergence">Relations among Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#continuous-mapping-theorem-cmt" id="toc-continuous-mapping-theorem-cmt"><span class="toc-section-number">5.1.2</span> Continuous Mapping Theorem (CMT)</a></li>
<li><a href="tools-for-asymptotic-statistics.html#slutsky-theorem" id="toc-slutsky-theorem"><span class="toc-section-number">5.1.3</span> Slutsky Theorem</a></li>
<li><a href="tools-for-asymptotic-statistics.html#law-of-large-numbers-lln-and-central-limit-theorem-clt" id="toc-law-of-large-numbers-lln-and-central-limit-theorem-clt"><span class="toc-section-number">5.1.4</span> Law of Large Numbers (LLN) and Central Limit Theorem (CLT)</a></li>
<li><a href="tools-for-asymptotic-statistics.html#estimators-as-a-sequences-of-random-variables" id="toc-estimators-as-a-sequences-of-random-variables"><span class="toc-section-number">5.1.5</span> Estimators as a Sequences of Random Variables</a></li>
</ul></li>
<li><a href="asymptotics-under-the-classic-regression-model.html#asymptotics-under-the-classic-regression-model" id="toc-asymptotics-under-the-classic-regression-model"><span class="toc-section-number">5.2</span> Asymptotics under the Classic Regression Model</a>
<ul>
<li><a href="asymptotics-under-the-classic-regression-model.html#the-case-of-heteroscedasticity" id="toc-the-case-of-heteroscedasticity"><span class="toc-section-number">5.2.1</span> The Case of Heteroscedasticity</a></li>
<li><a href="asymptotics-under-the-classic-regression-model.html#hypothesis-testing-and-confidence-intervals" id="toc-hypothesis-testing-and-confidence-intervals"><span class="toc-section-number">5.2.2</span> Hypothesis Testing and Confidence Intervals</a></li>
</ul></li>
<li><a href="practice-large-sample-inference.html#practice-large-sample-inference" id="toc-practice-large-sample-inference"><span class="toc-section-number">5.3</span> Practice: Large Sample Inference</a>
<ul>
<li><a href="practice-large-sample-inference.html#normally-distributed-hatbeta-for-ntoinfty" id="toc-normally-distributed-hatbeta-for-ntoinfty"><span class="toc-section-number">5.3.1</span> Normally Distributed <span class="math inline">\(\hat\beta\)</span> for <span class="math inline">\(n\to\infty\)</span></a></li>
<li><a href="practice-large-sample-inference.html#testing-multiple-and-single-parameters" id="toc-testing-multiple-and-single-parameters"><span class="toc-section-number">5.3.2</span> Testing Multiple and Single Parameters</a></li>
</ul></li>
</ul></li>
<li><a href="ivr.html#ivr" id="toc-ivr"><span class="toc-section-number">6</span> Instrumental Variables Regression</a>
<ul>
<li><a href="TIVEWASRAASI.html#TIVEWASRAASI" id="toc-TIVEWASRAASI"><span class="toc-section-number">6.1</span> The IV Estimator with a Single Regressor and a Single Instrument</a>
<ul>
<li><a href="TIVEWASRAASI.html#the-two-stage-least-squares-estimator" id="toc-the-two-stage-least-squares-estimator"><span class="toc-section-number">6.1.1</span> The Two-Stage Least Squares Estimator</a></li>
<li><a href="TIVEWASRAASI.html#application-demand-for-cigarettes-12" id="toc-application-demand-for-cigarettes-12"><span class="toc-section-number">6.1.2</span> Application: Demand For Cigarettes (1/2)</a></li>
</ul></li>
<li><a href="TGIVRM.html#TGIVRM" id="toc-TGIVRM"><span class="toc-section-number">6.2</span> The General IV Regression Model</a>
<ul>
<li><a href="TGIVRM.html#application-demand-for-cigarettes-22" id="toc-application-demand-for-cigarettes-22"><span class="toc-section-number">6.2.1</span> Application: Demand for Cigarettes (2/2)</a></li>
</ul></li>
<li><a href="civ.html#civ" id="toc-civ"><span class="toc-section-number">6.3</span> Checking Instrument Validity</a>
<ul>
<li><a href="civ.html#instrument-relevance" id="toc-instrument-relevance"><span class="toc-section-number">6.3.1</span> Instrument Relevance</a></li>
<li><a href="civ.html#instrument-validity" id="toc-instrument-validity"><span class="toc-section-number">6.3.2</span> Instrument Validity</a></li>
</ul></li>
<li><a href="attdfc.html#attdfc" id="toc-attdfc"><span class="toc-section-number">6.4</span> Application to the Demand for Cigarettes</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometrics (M.Sc.)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="attdfc" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Application to the Demand for Cigarettes</h2>
<p>Are the general sales tax and the cigarette-specific tax valid instruments? If not, TSLS is not helpful to estimate the demand elasticity for cigarettes discussed in Chapter <a href="TGIVRM.html#TGIVRM">6.2</a>. As discussed in Chapter <a href="TIVEWASRAASI.html#TIVEWASRAASI">6.1</a>, both variables are likely to be relevant but whether they are exogenous is a different question.</p>
<p>One can argue that cigarette-specific taxes could be endogenous because there might be state specific historical factors like economic importance of the tobacco farming and cigarette production industry that lobby for low cigarette specific taxes. Since it is plausible that tobacco growing states have higher rates of smoking than others, this would lead to endogeneity of cigarette specific taxes. If we had data on the size on the tobacco and cigarette industry, we could solve this potential issue by including the information in the regression. Unfortunately, this is not the case.</p>
<p>However, since the role of the tobacco and cigarette industry is a factor that can be assumed to differ across states but not over time we may exploit the panel structure of <code>CigarettesSW</code>. Alternatively, a (non-panel) regression using data on <em>changes</em> between two time periods eliminates such state specific and time invariant effects. Next, we consider such changes in variables between 1985 and 1995. That is, we are interested in estimating the <em>long-run elasticity</em> of the demand for cigarettes.</p>
<p>The model to be estimated by TSLS using the general sales tax and the cigarette-specific sales tax as instruments hence is
<span class="math display" id="eq:diffivreg">\[\begin{align}
\begin{split}
  \log(Q_{i,1995}^{cigarettes}) - \log(Q_{i,1985}^{cigarettes}) =
  &amp; \, \beta_1 + \beta_2 \left[\log(P_{i,1995}^{cigarettes}) - \log(P_{i,1985}^{cigarettes}) \right] \\
  &amp;+ \beta_3 \left[\log(income_{i,1995}) - \log(income_{i,1985})\right] + \eps_i. \end{split}\tag{6.1}
\end{align}\]</span></p>
<p>We first create differences from 1985 to 1995 for the dependent variable, the regressors and both instruments.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="attdfc.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset data for year 1985</span></span>
<span id="cb113-2"><a href="attdfc.html#cb113-2" aria-hidden="true" tabindex="-1"></a>c1985 <span class="ot">&lt;-</span> <span class="fu">subset</span>(CigarettesSW, year <span class="sc">==</span> <span class="st">&quot;1985&quot;</span>)</span>
<span id="cb113-3"><a href="attdfc.html#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="attdfc.html#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define differences in variables</span></span>
<span id="cb113-5"><a href="attdfc.html#cb113-5" aria-hidden="true" tabindex="-1"></a>packsdiff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>packs) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>packs)</span>
<span id="cb113-6"><a href="attdfc.html#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="attdfc.html#cb113-7" aria-hidden="true" tabindex="-1"></a>pricediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>price<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span> <span class="fu">log</span>(c1985<span class="sc">$</span>price<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb113-8"><a href="attdfc.html#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="attdfc.html#cb113-9" aria-hidden="true" tabindex="-1"></a>incomediff <span class="ot">&lt;-</span> <span class="fu">log</span>(c1995<span class="sc">$</span>income<span class="sc">/</span>c1995<span class="sc">$</span>population<span class="sc">/</span>c1995<span class="sc">$</span>cpi) <span class="sc">-</span></span>
<span id="cb113-10"><a href="attdfc.html#cb113-10" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(c1985<span class="sc">$</span>income<span class="sc">/</span>c1985<span class="sc">$</span>population<span class="sc">/</span>c1985<span class="sc">$</span>cpi)</span>
<span id="cb113-11"><a href="attdfc.html#cb113-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-12"><a href="attdfc.html#cb113-12" aria-hidden="true" tabindex="-1"></a>salestaxdiff <span class="ot">&lt;-</span> (c1995<span class="sc">$</span>taxs <span class="sc">-</span> c1995<span class="sc">$</span>tax)<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> (c1985<span class="sc">$</span>taxs <span class="sc">-</span> c1985<span class="sc">$</span>tax)<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span>
<span id="cb113-13"><a href="attdfc.html#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="attdfc.html#cb113-14" aria-hidden="true" tabindex="-1"></a>cigtaxdiff <span class="ot">&lt;-</span> c1995<span class="sc">$</span>tax<span class="sc">/</span>c1995<span class="sc">$</span>cpi <span class="sc">-</span> c1985<span class="sc">$</span>tax<span class="sc">/</span>c1985<span class="sc">$</span>cpi</span></code></pre></div>
<p>We now perform three different IV estimations of <a href="attdfc.html#eq:diffivreg">(6.1)</a> using <code>ivreg()</code>:</p>
<ol style="list-style-type: decimal">
<li><p>TSLS using only the difference in the sales taxes between 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using only the difference in the cigarette-specific sales taxes 1985 and 1995 as the instrument.</p></li>
<li><p>TSLS using both the difference in the sales taxes 1985 and 1995 and the difference in the cigarette-specific sales taxes 1985 and 1995 as instruments.</p></li>
</ol>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="attdfc.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the three models</span></span>
<span id="cb114-2"><a href="attdfc.html#cb114-2" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff1 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb114-3"><a href="attdfc.html#cb114-3" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb114-4"><a href="attdfc.html#cb114-4" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff)</span>
<span id="cb114-5"><a href="attdfc.html#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="attdfc.html#cb114-6" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff2 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb114-7"><a href="attdfc.html#cb114-7" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb114-8"><a href="attdfc.html#cb114-8" aria-hidden="true" tabindex="-1"></a>                         cigtaxdiff)</span>
<span id="cb114-9"><a href="attdfc.html#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="attdfc.html#cb114-10" aria-hidden="true" tabindex="-1"></a>cig_ivreg_diff3 <span class="ot">&lt;-</span> <span class="fu">ivreg</span>(packsdiff <span class="sc">~</span> pricediff <span class="sc">+</span> </span>
<span id="cb114-11"><a href="attdfc.html#cb114-11" aria-hidden="true" tabindex="-1"></a>                           incomediff <span class="sc">|</span> incomediff <span class="sc">+</span> </span>
<span id="cb114-12"><a href="attdfc.html#cb114-12" aria-hidden="true" tabindex="-1"></a>                         salestaxdiff <span class="sc">+</span> cigtaxdiff)</span></code></pre></div>
<p>As usual we use <code>coeftest()</code> in conjunction with <code>vcovHC()</code> to obtain robust coefficient summaries for all models.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="attdfc.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 1.</span></span>
<span id="cb115-2"><a href="attdfc.html#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff1, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb115-3"><a href="attdfc.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-4"><a href="attdfc.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb115-5"><a href="attdfc.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-6"><a href="attdfc.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb115-7"><a href="attdfc.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.117962   0.068217 -1.7292   0.09062 .  </span></span>
<span id="cb115-8"><a href="attdfc.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -0.938014   0.207502 -4.5205 4.454e-05 ***</span></span>
<span id="cb115-9"><a href="attdfc.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.525970   0.339494  1.5493   0.12832    </span></span>
<span id="cb115-10"><a href="attdfc.html#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb115-11"><a href="attdfc.html#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb115-12"><a href="attdfc.html#cb115-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-13"><a href="attdfc.html#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 2.</span></span>
<span id="cb115-14"><a href="attdfc.html#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff2, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb115-15"><a href="attdfc.html#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-16"><a href="attdfc.html#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb115-17"><a href="attdfc.html#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-18"><a href="attdfc.html#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb115-19"><a href="attdfc.html#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.017049   0.067217 -0.2536    0.8009    </span></span>
<span id="cb115-20"><a href="attdfc.html#cb115-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -1.342515   0.228661 -5.8712 4.848e-07 ***</span></span>
<span id="cb115-21"><a href="attdfc.html#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.428146   0.298718  1.4333    0.1587    </span></span>
<span id="cb115-22"><a href="attdfc.html#cb115-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb115-23"><a href="attdfc.html#cb115-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb115-24"><a href="attdfc.html#cb115-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-25"><a href="attdfc.html#cb115-25" aria-hidden="true" tabindex="-1"></a><span class="co"># robust coefficient summary for 3.</span></span>
<span id="cb115-26"><a href="attdfc.html#cb115-26" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(cig_ivreg_diff3, <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb115-27"><a href="attdfc.html#cb115-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-28"><a href="attdfc.html#cb115-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb115-29"><a href="attdfc.html#cb115-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb115-30"><a href="attdfc.html#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              Estimate Std. Error t value  Pr(&gt;|t|)    </span></span>
<span id="cb115-31"><a href="attdfc.html#cb115-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.052003   0.062488 -0.8322    0.4097    </span></span>
<span id="cb115-32"><a href="attdfc.html#cb115-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; pricediff   -1.202403   0.196943 -6.1053 2.178e-07 ***</span></span>
<span id="cb115-33"><a href="attdfc.html#cb115-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; incomediff   0.462030   0.309341  1.4936    0.1423    </span></span>
<span id="cb115-34"><a href="attdfc.html#cb115-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb115-35"><a href="attdfc.html#cb115-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>We proceed by generating a tabulated summary of the estimation results using <code>stargazer()</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="attdfc.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb116-2"><a href="attdfc.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># gather robust standard errors in a list</span></span>
<span id="cb116-3"><a href="attdfc.html#cb116-3" aria-hidden="true" tabindex="-1"></a>rob_se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff1, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb116-4"><a href="attdfc.html#cb116-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff2, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))),</span>
<span id="cb116-5"><a href="attdfc.html#cb116-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcovHC</span>(cig_ivreg_diff3, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))))</span>
<span id="cb116-6"><a href="attdfc.html#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="attdfc.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table</span></span>
<span id="cb116-8"><a href="attdfc.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(cig_ivreg_diff1, cig_ivreg_diff2, cig_ivreg_diff3,</span>
<span id="cb116-9"><a href="attdfc.html#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">header =</span> <span class="cn">FALSE</span>, </span>
<span id="cb116-10"><a href="attdfc.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;latex&quot;</span>,</span>
<span id="cb116-11"><a href="attdfc.html#cb116-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">omit.table.layout =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb116-12"><a href="attdfc.html#cb116-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>, </span>
<span id="cb116-13"><a href="attdfc.html#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">column.labels =</span> <span class="fu">c</span>(<span class="st">&quot;IV: salestax&quot;</span>, <span class="st">&quot;IV: cigtax&quot;</span>, </span>
<span id="cb116-14"><a href="attdfc.html#cb116-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;IVs: salestax, cigtax&quot;</span>),</span>
<span id="cb116-15"><a href="attdfc.html#cb116-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.labels.include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb116-16"><a href="attdfc.html#cb116-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dep.var.caption =</span> </span>
<span id="cb116-17"><a href="attdfc.html#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Dependent Variable: 1985-1995 Difference in Log per Pack Price&quot;</span>,</span>
<span id="cb116-18"><a href="attdfc.html#cb116-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">se =</span> rob_se)</span></code></pre></div>


<!-- ```{r, message=F, warning=F, results='asis', echo=F, purl=F, eval=my_output == "html"} -->
<!-- # gather robust standard errors in a list -->
<!-- rob_se <- list(sqrt(diag(vcovHC(cig_ivreg_diff1, type = "HC1"))), -->
<!--                sqrt(diag(vcovHC(cig_ivreg_diff2, type = "HC1"))), -->
<!--                sqrt(diag(vcovHC(cig_ivreg_diff3, type = "HC1")))) -->

<!-- stargazer(cig_ivreg_diff1, cig_ivreg_diff2,cig_ivreg_diff3, -->
<!--   header = FALSE,  -->
<!--   type = "html", -->
<!--   digits = 3,  -->
<!--   column.labels = c("IV: salestax", "IV: cigtax", "IVs: salestax, cigtax"), -->
<!--   dep.var.labels.include = FALSE, -->
<!--   dep.var.caption = "Dependent variable: 1985-1995 difference in log per pack price", -->
<!--   se = rob_se) -->

<!-- stargazer_html_title("TSLS Estimates of the Long-Term Elasticity of the Demand for Cigarettes using Panel Data", "tslseotlteotdfcupd") -->
<!-- ``` -->


<p>Table <a href="#tab:tslseotlteotdfcupd"><strong>??</strong></a> reports negative estimates of the coefficient on <code>pricediff</code> that are quite different in magnitude. Which one should we trust? This hinges on the validity of the instruments used. To assess this we compute <span class="math inline">\(F\)</span>-statistics for the first-stage regressions of all three models to check instrument relevance.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="attdfc.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first-stage regressions</span></span>
<span id="cb117-2"><a href="attdfc.html#cb117-2" aria-hidden="true" tabindex="-1"></a>mod_relevance1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> salestaxdiff <span class="sc">+</span> incomediff)</span>
<span id="cb117-3"><a href="attdfc.html#cb117-3" aria-hidden="true" tabindex="-1"></a>mod_relevance2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> cigtaxdiff   <span class="sc">+</span> incomediff)</span>
<span id="cb117-4"><a href="attdfc.html#cb117-4" aria-hidden="true" tabindex="-1"></a>mod_relevance3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(pricediff <span class="sc">~</span> incomediff   <span class="sc">+</span> salestaxdiff <span class="sc">+</span> </span>
<span id="cb117-5"><a href="attdfc.html#cb117-5" aria-hidden="true" tabindex="-1"></a>                                                cigtaxdiff)</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="attdfc.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (1)</span></span>
<span id="cb118-2"><a href="attdfc.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance1, </span>
<span id="cb118-3"><a href="attdfc.html#cb118-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;salestaxdiff = 0&quot;</span>, </span>
<span id="cb118-4"><a href="attdfc.html#cb118-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb118-5"><a href="attdfc.html#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb118-6"><a href="attdfc.html#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-7"><a href="attdfc.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb118-8"><a href="attdfc.html#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb118-9"><a href="attdfc.html#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-10"><a href="attdfc.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb118-11"><a href="attdfc.html#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ salestaxdiff + incomediff</span></span>
<span id="cb118-12"><a href="attdfc.html#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-13"><a href="attdfc.html#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb118-14"><a href="attdfc.html#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb118-15"><a href="attdfc.html#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb118-16"><a href="attdfc.html#cb118-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                        </span></span>
<span id="cb118-17"><a href="attdfc.html#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     45  1 28.445 3.009e-06 ***</span></span>
<span id="cb118-18"><a href="attdfc.html#cb118-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb118-19"><a href="attdfc.html#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="attdfc.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (2)</span></span>
<span id="cb119-2"><a href="attdfc.html#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance2, </span>
<span id="cb119-3"><a href="attdfc.html#cb119-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;cigtaxdiff = 0&quot;</span>, </span>
<span id="cb119-4"><a href="attdfc.html#cb119-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb119-5"><a href="attdfc.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb119-6"><a href="attdfc.html#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb119-7"><a href="attdfc.html#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb119-8"><a href="attdfc.html#cb119-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb119-9"><a href="attdfc.html#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb119-10"><a href="attdfc.html#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb119-11"><a href="attdfc.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ cigtaxdiff + incomediff</span></span>
<span id="cb119-12"><a href="attdfc.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb119-13"><a href="attdfc.html#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb119-14"><a href="attdfc.html#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb119-15"><a href="attdfc.html#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F   Pr(&gt;F)    </span></span>
<span id="cb119-16"><a href="attdfc.html#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                       </span></span>
<span id="cb119-17"><a href="attdfc.html#cb119-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     45  1 98.034 7.09e-13 ***</span></span>
<span id="cb119-18"><a href="attdfc.html#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb119-19"><a href="attdfc.html#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="attdfc.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check instrument relevance for model (3)</span></span>
<span id="cb120-2"><a href="attdfc.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">linearHypothesis</span>(mod_relevance3, </span>
<span id="cb120-3"><a href="attdfc.html#cb120-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">c</span>(<span class="st">&quot;salestaxdiff = 0&quot;</span>, <span class="st">&quot;cigtaxdiff = 0&quot;</span>), </span>
<span id="cb120-4"><a href="attdfc.html#cb120-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov =</span> vcovHC, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>)</span>
<span id="cb120-5"><a href="attdfc.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb120-6"><a href="attdfc.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-7"><a href="attdfc.html#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb120-8"><a href="attdfc.html#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb120-9"><a href="attdfc.html#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb120-10"><a href="attdfc.html#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-11"><a href="attdfc.html#cb120-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb120-12"><a href="attdfc.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: pricediff ~ incomediff + salestaxdiff + cigtaxdiff</span></span>
<span id="cb120-13"><a href="attdfc.html#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-14"><a href="attdfc.html#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb120-15"><a href="attdfc.html#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb120-16"><a href="attdfc.html#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df Df      F    Pr(&gt;F)    </span></span>
<span id="cb120-17"><a href="attdfc.html#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46                        </span></span>
<span id="cb120-18"><a href="attdfc.html#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     44  2 76.916 4.339e-15 ***</span></span>
<span id="cb120-19"><a href="attdfc.html#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb120-20"><a href="attdfc.html#cb120-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>All <span class="math inline">\(F\)</span>-statistics are larger than <span class="math inline">\(10\)</span>; so, the rule of thumb for detecting weak instruments would suggest that the instruments are not weak.</p>
<p>Next, we also conduct the overidentifying restrictions test for model three which is the only model where the coefficient on the difference in log prices is overidentified (<span class="math inline">\(m=2\)</span>, <span class="math inline">\((K-1)=1\)</span>) such that the <span class="math inline">\(J\)</span>-statistic can be computed. To do this we take the residuals stored in <code>cig_ivreg_diff3</code> and regress them on both instruments and the presumably exogenous regressor <code>incomediff</code>. We again use <code>linearHypothesis()</code> to test whether the coefficients on both instruments are zero which is necessary for the exogeneity assumption to be fulfilled. Note that with <code>test = "Chisq"</code> we obtain a chi-squared distributed test statistic instead of an <span class="math inline">\(F\)</span>-statistic.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="attdfc.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute the J-statistic</span></span>
<span id="cb121-2"><a href="attdfc.html#cb121-2" aria-hidden="true" tabindex="-1"></a>cig_iv_OR <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">residuals</span>(cig_ivreg_diff3) <span class="sc">~</span> incomediff <span class="sc">+</span> </span>
<span id="cb121-3"><a href="attdfc.html#cb121-3" aria-hidden="true" tabindex="-1"></a>                                 salestaxdiff <span class="sc">+</span> cigtaxdiff)</span>
<span id="cb121-4"><a href="attdfc.html#cb121-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-5"><a href="attdfc.html#cb121-5" aria-hidden="true" tabindex="-1"></a>cig_OR_test <span class="ot">&lt;-</span> <span class="fu">linearHypothesis</span>(cig_iv_OR, </span>
<span id="cb121-6"><a href="attdfc.html#cb121-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="st">&quot;salestaxdiff = 0&quot;</span>, </span>
<span id="cb121-7"><a href="attdfc.html#cb121-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;cigtaxdiff = 0&quot;</span>), </span>
<span id="cb121-8"><a href="attdfc.html#cb121-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb121-9"><a href="attdfc.html#cb121-9" aria-hidden="true" tabindex="-1"></a>cig_OR_test</span>
<span id="cb121-10"><a href="attdfc.html#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Linear hypothesis test</span></span>
<span id="cb121-11"><a href="attdfc.html#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-12"><a href="attdfc.html#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Hypothesis:</span></span>
<span id="cb121-13"><a href="attdfc.html#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; salestaxdiff = 0</span></span>
<span id="cb121-14"><a href="attdfc.html#cb121-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cigtaxdiff = 0</span></span>
<span id="cb121-15"><a href="attdfc.html#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-16"><a href="attdfc.html#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 1: restricted model</span></span>
<span id="cb121-17"><a href="attdfc.html#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Model 2: residuals(cig_ivreg_diff3) ~ incomediff + salestaxdiff + cigtaxdiff</span></span>
<span id="cb121-18"><a href="attdfc.html#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb121-19"><a href="attdfc.html#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Res.Df     RSS Df Sum of Sq Chisq Pr(&gt;Chisq)  </span></span>
<span id="cb121-20"><a href="attdfc.html#cb121-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     46 0.37472                                </span></span>
<span id="cb121-21"><a href="attdfc.html#cb121-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     44 0.33695  2  0.037769 4.932    0.08492 .</span></span>
<span id="cb121-22"><a href="attdfc.html#cb121-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb121-23"><a href="attdfc.html#cb121-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p><strong>Caution</strong>: In this case the <span class="math inline">\(p\)</span>-value reported by <code>linearHypothesis()</code> is wrong because the degrees of freedom are set to <span class="math inline">\(2\)</span>. This differs from the degree of overidentification (<span class="math inline">\(m-(K-1)=2-(2-1)=1\)</span>) so the <span class="math inline">\(J\)</span>-statistic is <span class="math inline">\(\chi^2_1\)</span> distributed instead of following a <span class="math inline">\(\chi^2_2\)</span> distribution as assumed defaultly by <code>linearHypothesis()</code>. We may compute the correct <span class="math inline">\(p\)</span>-value using <code>pchisq()</code>.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="attdfc.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute correct p-value for J-statistic</span></span>
<span id="cb122-2"><a href="attdfc.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(cig_OR_test[<span class="dv">2</span>, <span class="dv">5</span>], <span class="at">df =</span> <span class="dv">1</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb122-3"><a href="attdfc.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02636406</span></span></code></pre></div>
<p>Since this value is smaller than <span class="math inline">\(0.05\)</span> we reject the hypothesis that both instruments are exogenous at the level of <span class="math inline">\(5\%\)</span>. This means one of the following:</p>
<ol style="list-style-type: decimal">
<li>The sales tax is an invalid instrument for the per-pack price.</li>
<li>The cigarettes-specific sales tax is an invalid instrument for the per-pack price.</li>
<li>Both instruments are invalid.</li>
</ol>
<p>One can argue that the assumption of instrument exogeneity is more likely to hold for the general sales tax such that the IV estimate of the long-run elasticity of demand for cigarettes we consider the most trustworthy is <span class="math inline">\(-0.94\)</span>, the TSLS estimate obtained using the general sales tax as the only instrument.</p>
<p>The interpretation of this estimate is that over a 10-year period, an increase in the average price per package by one percent is expected to decrease consumption by about <span class="math inline">\(0.94\)</span> percentage points. This suggests that, in the long run, price increases can reduce cigarette consumption considerably.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="civ.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Script_Econometrics_MSc.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"download": "https://uni-bonn.sciebo.de/s/IZ2yeLeA4dRTFUY",
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
