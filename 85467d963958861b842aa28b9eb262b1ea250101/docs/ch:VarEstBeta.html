<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.6 Variance and Standard Error of \(\hat\beta|X\) | Econometrics (M.Sc.)</title>
  <meta name="description" content="3.6 Variance and Standard Error of \(\hat\beta|X\) | Econometrics (M.Sc.)" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3.6 Variance and Standard Error of \(\hat\beta|X\) | Econometrics (M.Sc.)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/mylogo.png" />
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.6 Variance and Standard Error of \(\hat\beta|X\) | Econometrics (M.Sc.)" />
  
  
  <meta name="twitter:image" content="/images/mylogo.png" />

<meta name="author" content="Prof. Dr. Dominik Liebl" />


<meta name="date" content="2022-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="unbiasedness-of-hatbetax-and-hatbeta.html"/>
<link rel="next" href="the-gauss-markov-theorem.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="index.html#organization-of-the-course" id="toc-organization-of-the-course">Organization of the Course</a></li>
<li><a href="index.html#literature" id="toc-literature">Literature</a></li>
</ul></li>
<li><a href="introduction-to-r.html#introduction-to-r" id="toc-introduction-to-r"><span class="toc-section-number">1</span> Introduction to R</a>
<ul>
<li><a href="short-glossary.html#short-glossary" id="toc-short-glossary"><span class="toc-section-number">1.1</span> Short Glossary</a></li>
<li><a href="first-steps.html#first-steps" id="toc-first-steps"><span class="toc-section-number">1.2</span> First Steps</a></li>
<li><a href="further-data-objects.html#further-data-objects" id="toc-further-data-objects"><span class="toc-section-number">1.3</span> Further Data Objects</a></li>
<li><a href="simple-regression-analysis-using-r.html#simple-regression-analysis-using-r" id="toc-simple-regression-analysis-using-r"><span class="toc-section-number">1.4</span> Simple Regression Analysis using R</a></li>
<li><a href="programming-in-r.html#programming-in-r" id="toc-programming-in-r"><span class="toc-section-number">1.5</span> Programming in R</a></li>
<li><a href="r-packages.html#r-packages" id="toc-r-packages"><span class="toc-section-number">1.6</span> R-packages</a></li>
<li><a href="tidyverse.html#tidyverse" id="toc-tidyverse"><span class="toc-section-number">1.7</span> Tidyverse</a>
<ul>
<li><a href="tidyverse.html#tidyverse-plotting-basics" id="toc-tidyverse-plotting-basics"><span class="toc-section-number">1.7.1</span> Tidyverse: Plotting Basics</a></li>
<li><a href="tidyverse.html#tidyverse-data-wrangling-basics" id="toc-tidyverse-data-wrangling-basics"><span class="toc-section-number">1.7.2</span> Tidyverse: Data Wrangling Basics</a></li>
<li><a href="tidyverse.html#the-pipe-operator" id="toc-the-pipe-operator"><span class="toc-section-number">1.7.3</span> The pipe operator <code>%&gt;%</code></a></li>
<li><a href="tidyverse.html#the-group_by-function" id="toc-the-group_by-function"><span class="toc-section-number">1.7.4</span> The <code>group_by()</code> function</a></li>
</ul></li>
<li><a href="further-links.html#further-links" id="toc-further-links"><span class="toc-section-number">1.8</span> Further Links</a>
<ul>
<li><a href="further-links.html#further-r-intros" id="toc-further-r-intros"><span class="toc-section-number">1.8.1</span> Further R-Intros</a></li>
<li><a href="further-links.html#version-control-gitgithub" id="toc-version-control-gitgithub"><span class="toc-section-number">1.8.2</span> Version Control (Git/GitHub)</a></li>
<li><a href="further-links.html#r-ladies" id="toc-r-ladies"><span class="toc-section-number">1.8.3</span> R-Ladies</a></li>
</ul></li>
</ul></li>
<li><a href="ReviewStats.html#ReviewStats" id="toc-ReviewStats"><span class="toc-section-number">2</span> Review: Probability and Statistics</a>
<ul>
<li><a href="probability-theory.html#probability-theory" id="toc-probability-theory"><span class="toc-section-number">2.1</span> Probability Theory</a>
<ul>
<li><a href="probability-theory.html#sample-spaces-and-elementary-events" id="toc-sample-spaces-and-elementary-events"><span class="toc-section-number">2.1.1</span> Sample Spaces and (Elementary) Events</a></li>
<li><a href="probability-theory.html#probability" id="toc-probability"><span class="toc-section-number">2.1.2</span> Probability</a></li>
<li><a href="probability-theory.html#independent-events" id="toc-independent-events"><span class="toc-section-number">2.1.3</span> Independent Events</a></li>
<li><a href="probability-theory.html#conditional-probability" id="toc-conditional-probability"><span class="toc-section-number">2.1.4</span> Conditional Probability</a></li>
</ul></li>
<li><a href="random-variables.html#random-variables" id="toc-random-variables"><span class="toc-section-number">2.2</span> Random Variables</a>
<ul>
<li><a href="random-variables.html#univariate-distribution-and-probability-functions" id="toc-univariate-distribution-and-probability-functions"><span class="toc-section-number">2.2.1</span> Univariate Distribution and Probability Functions</a></li>
<li><a href="random-variables.html#multivariate-distribution-and-probability-functions" id="toc-multivariate-distribution-and-probability-functions"><span class="toc-section-number">2.2.2</span> Multivariate Distribution and Probability Functions</a></li>
<li><a href="random-variables.html#means-and-moments" id="toc-means-and-moments"><span class="toc-section-number">2.2.3</span> Means and Moments</a></li>
<li><a href="random-variables.html#unconditional-means" id="toc-unconditional-means"><span class="toc-section-number">2.2.4</span> Unconditional Means</a></li>
<li><a href="random-variables.html#conditional-means" id="toc-conditional-means"><span class="toc-section-number">2.2.5</span> Conditional Means</a></li>
<li><a href="random-variables.html#means-of-transformed-random-variables-and-moments" id="toc-means-of-transformed-random-variables-and-moments"><span class="toc-section-number">2.2.6</span> Means of Transformed Random Variables and Moments</a></li>
<li><a href="random-variables.html#independent-random-variables" id="toc-independent-random-variables"><span class="toc-section-number">2.2.7</span> Independent Random Variables</a></li>
<li><a href="random-variables.html#i.i.d.-samples" id="toc-i.i.d.-samples"><span class="toc-section-number">2.2.8</span> I.I.D. Samples</a></li>
<li><a href="random-variables.html#some-important-discrete-random-variables" id="toc-some-important-discrete-random-variables"><span class="toc-section-number">2.2.9</span> Some Important Discrete Random Variables</a></li>
<li><a href="random-variables.html#some-important-continuous-random-variables" id="toc-some-important-continuous-random-variables"><span class="toc-section-number">2.2.10</span> Some Important Continuous Random Variables</a></li>
</ul></li>
</ul></li>
<li><a href="ch:MLR.html#ch:MLR" id="toc-ch:MLR"><span class="toc-section-number">3</span> Multiple Linear Regression</a>
<ul>
<li><a href="assumptions.html#assumptions" id="toc-assumptions"><span class="toc-section-number">3.1</span> Assumptions</a>
<ul>
<li><a href="assumptions.html#some-implications-of-the-exogeneity-assumption" id="toc-some-implications-of-the-exogeneity-assumption"><span class="toc-section-number">3.1.1</span> Some Implications of the Exogeneity Assumption</a></li>
</ul></li>
<li><a href="deriving-the-expression-of-the-ols-estimator.html#deriving-the-expression-of-the-ols-estimator" id="toc-deriving-the-expression-of-the-ols-estimator"><span class="toc-section-number">3.2</span> Deriving the Expression of the OLS Estimator</a></li>
<li><a href="some-quantities-of-interest.html#some-quantities-of-interest" id="toc-some-quantities-of-interest"><span class="toc-section-number">3.3</span> Some Quantities of Interest</a></li>
<li><a href="method-of-moments-estimator.html#method-of-moments-estimator" id="toc-method-of-moments-estimator"><span class="toc-section-number">3.4</span> Method of Moments Estimator</a></li>
<li><a href="unbiasedness-of-hatbetax-and-hatbeta.html#unbiasedness-of-hatbetax-and-hatbeta" id="toc-unbiasedness-of-hatbetax-and-hatbeta"><span class="toc-section-number">3.5</span> Unbiasedness of <span class="math inline">\(\hat\beta|X\)</span> and <span class="math inline">\(\hat\beta\)</span></a></li>
<li><a href="ch:VarEstBeta.html#ch:VarEstBeta" id="toc-ch:VarEstBeta"><span class="toc-section-number">3.6</span> Variance and Standard Error of <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li><a href="the-gauss-markov-theorem.html#the-gauss-markov-theorem" id="toc-the-gauss-markov-theorem"><span class="toc-section-number">3.7</span> The Gauss-Markov Theorem</a></li>
<li><a href="practice-real-data.html#practice-real-data" id="toc-practice-real-data"><span class="toc-section-number">3.8</span> Practice: Real Data</a>
<ul>
<li><a href="practice-real-data.html#dummy-variables-contrast-codings-and-interactions" id="toc-dummy-variables-contrast-codings-and-interactions">Dummy Variables, Contrast Codings, and Interactions</a></li>
<li><a href="practice-real-data.html#the-function" id="toc-the-function">The Function </a></li>
</ul></li>
<li><a href="practice-simulation.html#practice-simulation" id="toc-practice-simulation"><span class="toc-section-number">3.9</span> Practice: Simulation</a>
<ul>
<li><a href="practice-simulation.html#behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i" id="toc-behavior-of-the-ols-estimates-for-resampled-data-conditionally-on-x_i"><span class="toc-section-number">3.9.1</span> Behavior of the OLS Estimates for Resampled Data (conditionally on <span class="math inline">\(X_i\)</span>)</a></li>
</ul></li>
</ul></li>
<li><a href="ch:SSINF.html#ch:SSINF" id="toc-ch:SSINF"><span class="toc-section-number">4</span> Small Sample Inference</a>
<ul>
<li><a href="ch:testmultp.html#ch:testmultp" id="toc-ch:testmultp"><span class="toc-section-number">4.1</span> Hypothesis Tests about Multiple Parameters</a>
<ul>
<li><a href="ch:testmultp.html#the-test-statistic-and-its-null-distribution" id="toc-the-test-statistic-and-its-null-distribution"><span class="toc-section-number">4.1.1</span> The Test Statistic and its Null Distribution</a></li>
</ul></li>
<li><a href="ch:testingsinglep.html#ch:testingsinglep" id="toc-ch:testingsinglep"><span class="toc-section-number">4.2</span> Tests about One Parameter</a></li>
<li><a href="testtheory.html#testtheory" id="toc-testtheory"><span class="toc-section-number">4.3</span> Testtheory</a>
<ul>
<li><a href="testtheory.html#significance-level" id="toc-significance-level"><span class="toc-section-number">4.3.1</span> Significance Level</a></li>
<li><a href="testtheory.html#critical-value-for-the-f-test" id="toc-critical-value-for-the-f-test"><span class="toc-section-number">4.3.2</span> Critical Value for the <span class="math inline">\(F\)</span>-Test</a></li>
<li><a href="testtheory.html#critical-values-for-the-t-test" id="toc-critical-values-for-the-t-test"><span class="toc-section-number">4.3.3</span> Critical Value(s) for the <span class="math inline">\(t\)</span>-Test</a></li>
</ul></li>
<li><a href="type-ii-error-and-power.html#type-ii-error-and-power" id="toc-type-ii-error-and-power"><span class="toc-section-number">4.4</span> Type II Error and Power</a></li>
<li><a href="p-value.html#p-value" id="toc-p-value"><span class="toc-section-number">4.5</span> <span class="math inline">\(p\)</span>-Value</a></li>
<li><a href="CIsmallsample.html#CIsmallsample" id="toc-CIsmallsample"><span class="toc-section-number">4.6</span> Confidence Intervals</a></li>
<li><a href="PSSI.html#PSSI" id="toc-PSSI"><span class="toc-section-number">4.7</span> Practice: Small Sample Inference</a>
<ul>
<li><a href="PSSI.html#normally-distributed-hatbetax" id="toc-normally-distributed-hatbetax"><span class="toc-section-number">4.7.1</span> Normally Distributed <span class="math inline">\(\hat\beta|X\)</span></a></li>
<li><a href="PSSI.html#testing-multiple-parameters" id="toc-testing-multiple-parameters"><span class="toc-section-number">4.7.2</span> Testing Multiple Parameters</a></li>
<li><a href="PSSI.html#dualty-of-confidence-intervals-and-hypothesis-tests" id="toc-dualty-of-confidence-intervals-and-hypothesis-tests"><span class="toc-section-number">4.7.3</span> Dualty of Confidence Intervals and Hypothesis Tests</a></li>
</ul></li>
</ul></li>
<li><a href="ch:LSINF.html#ch:LSINF" id="toc-ch:LSINF"><span class="toc-section-number">5</span> Large Sample Inference</a>
<ul>
<li><a href="tools-for-asymptotic-statistics.html#tools-for-asymptotic-statistics" id="toc-tools-for-asymptotic-statistics"><span class="toc-section-number">5.1</span> Tools for Asymptotic Statistics</a>
<ul>
<li><a href="tools-for-asymptotic-statistics.html#modes-of-convergence" id="toc-modes-of-convergence"><span class="toc-section-number">5.1.1</span> Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#four-important-modes-of-convergence" id="toc-four-important-modes-of-convergence">Four Important Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#relations-among-modes-of-convergence" id="toc-relations-among-modes-of-convergence">Relations among Modes of Convergence</a></li>
<li><a href="tools-for-asymptotic-statistics.html#continuous-mapping-theorem-cmt" id="toc-continuous-mapping-theorem-cmt"><span class="toc-section-number">5.1.2</span> Continuous Mapping Theorem (CMT)</a></li>
<li><a href="tools-for-asymptotic-statistics.html#slutsky-theorem" id="toc-slutsky-theorem"><span class="toc-section-number">5.1.3</span> Slutsky Theorem</a></li>
<li><a href="tools-for-asymptotic-statistics.html#law-of-large-numbers-lln-and-central-limit-theorem-clt" id="toc-law-of-large-numbers-lln-and-central-limit-theorem-clt"><span class="toc-section-number">5.1.4</span> Law of Large Numbers (LLN) and Central Limit Theorem (CLT)</a></li>
<li><a href="tools-for-asymptotic-statistics.html#estimators-as-a-sequences-of-random-variables" id="toc-estimators-as-a-sequences-of-random-variables"><span class="toc-section-number">5.1.5</span> Estimators as a Sequences of Random Variables</a></li>
</ul></li>
<li><a href="asymptotics-under-the-classic-regression-model.html#asymptotics-under-the-classic-regression-model" id="toc-asymptotics-under-the-classic-regression-model"><span class="toc-section-number">5.2</span> Asymptotics under the Classic Regression Model</a>
<ul>
<li><a href="asymptotics-under-the-classic-regression-model.html#the-case-of-heteroscedasticity" id="toc-the-case-of-heteroscedasticity"><span class="toc-section-number">5.2.1</span> The Case of Heteroscedasticity</a></li>
<li><a href="asymptotics-under-the-classic-regression-model.html#hypothesis-testing-and-confidence-intervals" id="toc-hypothesis-testing-and-confidence-intervals"><span class="toc-section-number">5.2.2</span> Hypothesis Testing and Confidence Intervals</a></li>
</ul></li>
<li><a href="practice-large-sample-inference.html#practice-large-sample-inference" id="toc-practice-large-sample-inference"><span class="toc-section-number">5.3</span> Practice: Large Sample Inference</a>
<ul>
<li><a href="practice-large-sample-inference.html#normally-distributed-hatbeta-for-ntoinfty" id="toc-normally-distributed-hatbeta-for-ntoinfty"><span class="toc-section-number">5.3.1</span> Normally Distributed <span class="math inline">\(\hat\beta\)</span> for <span class="math inline">\(n\to\infty\)</span></a></li>
<li><a href="practice-large-sample-inference.html#testing-multiple-and-single-parameters" id="toc-testing-multiple-and-single-parameters"><span class="toc-section-number">5.3.2</span> Testing Multiple and Single Parameters</a></li>
</ul></li>
</ul></li>
<li><a href="ivr.html#ivr" id="toc-ivr"><span class="toc-section-number">6</span> Instrumental Variables Regression</a>
<ul>
<li><a href="TIVEWASRAASI.html#TIVEWASRAASI" id="toc-TIVEWASRAASI"><span class="toc-section-number">6.1</span> The IV Estimator with a Single Regressor and a Single Instrument</a>
<ul>
<li><a href="TIVEWASRAASI.html#the-two-stage-least-squares-estimator" id="toc-the-two-stage-least-squares-estimator"><span class="toc-section-number">6.1.1</span> The Two-Stage Least Squares Estimator</a></li>
<li><a href="TIVEWASRAASI.html#application-demand-for-cigarettes-12" id="toc-application-demand-for-cigarettes-12"><span class="toc-section-number">6.1.2</span> Application: Demand For Cigarettes (1/2)</a></li>
</ul></li>
<li><a href="TGIVRM.html#TGIVRM" id="toc-TGIVRM"><span class="toc-section-number">6.2</span> The General IV Regression Model</a>
<ul>
<li><a href="TGIVRM.html#application-demand-for-cigarettes-22" id="toc-application-demand-for-cigarettes-22"><span class="toc-section-number">6.2.1</span> Application: Demand for Cigarettes (2/2)</a></li>
</ul></li>
<li><a href="civ.html#civ" id="toc-civ"><span class="toc-section-number">6.3</span> Checking Instrument Validity</a>
<ul>
<li><a href="civ.html#instrument-relevance" id="toc-instrument-relevance"><span class="toc-section-number">6.3.1</span> Instrument Relevance</a></li>
<li><a href="civ.html#instrument-validity" id="toc-instrument-validity"><span class="toc-section-number">6.3.2</span> Instrument Validity</a></li>
</ul></li>
<li><a href="attdfc.html#attdfc" id="toc-attdfc"><span class="toc-section-number">6.4</span> Application to the Demand for Cigarettes</a></li>
</ul></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometrics (M.Sc.)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch:VarEstBeta" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Variance and Standard Error of <span class="math inline">\(\hat\beta|X\)</span></h2>
The conditional variance of <span class="math inline">\(\hat\beta\)</span> given <span class="math inline">\(X\)</span> is given by
<span class="math display">\[\begin{align*}
\V(\hat{\beta}|X)=&amp; E\left[(\hat{\beta}-\beta)(\hat{\beta}-\beta)^{\prime}|X\right] \\
=&amp; E\left[\left(\left(X^{\prime} X\right)^{-1} X^{\prime} \eps\right)\left(\left(X^{\prime} X\right)^{-1} X^{\prime} \eps\right)^{\prime}|X\right] \\
=&amp; E\left[\left(X^{\prime} X\right)^{-1} X^{\prime} \eps\eps^{\prime} X\left(X^{\prime} X\right)^{-1}|X\right] \\
=&amp; \left(X^{\prime} X\right)^{-1} X^{\prime} E\left[\eps\eps^{\prime}|X\right] X\left(X^{\prime} X\right)^{-1}\\
=&amp; \underbrace{\left(X^{\prime} X\right)^{-1} X^{\prime} \overbrace{\V(\eps|X)}^{(n\times n)} X\left(X^{\prime} X\right)^{-1}}_{(K\times K)\text{-dimesnional}},\\
\end{align*}\]</span>
In the above derivations we used, first, that
<span class="math display">\[\begin{align*}
\hat\beta-\beta
&amp;=\left(X^{\prime} X\right)^{-1} X^{\prime} Y-\beta\\
&amp;=\left(X^{\prime} X\right)^{-1} X^{\prime}(X\beta+\eps)-\beta\\
&amp;=\beta+\left(X^{\prime} X\right)^{-1} X^{\prime}\eps)-\beta\\
&amp;=\left(X^{\prime} X\right)^{-1} X^{\prime}\eps
\end{align*}\]</span>
and, second, that <span class="math inline">\(E\left[\eps\eps^{\prime}|X\right]=\V(\eps|X)\)</span> since <span class="math inline">\(E(\eps|X)=0\)</span> under our assumptions. The above expression is the general version of <span class="math inline">\(\V(\hat{\beta}|X)\)</span> which can be further simplified using specific assumptions on the distribution of the error term <span class="math inline">\(\eps\)</span>:
<p>The diagonal elements in the <span class="math inline">\((K\times K)\)</span> matrix <span class="math inline">\(\V(\hat{\beta}|X)\)</span> are the variance expressions for the single estimators <span class="math inline">\(\hat\beta_k\)</span> with <span class="math inline">\(k=1,\dots,K\)</span>,
<span class="math display">\[\begin{align*}
\V(\hat{\beta}_k|X)=&amp;\left[\left(X^{\prime} X\right)^{-1} X^{\prime} \V(\eps|X) X\left(X^{\prime} X\right)^{-1}\right]_{kk}\quad\small{\text{(generally)}}\\
=&amp;\sigma^2\left[\left(X^{\prime} X\right)^{-1}\right]_{kk},\hspace*{4cm}\small{\text{(spherical errors)}}
\end{align*}\]</span>
where <span class="math inline">\([A]_{kl}\)</span> denotes the <span class="math inline">\(kl\)</span>th element of <span class="math inline">\(A\)</span> that is in the <span class="math inline">\(k\)</span>th row and <span class="math inline">\(l\)</span>th column of <span class="math inline">\(A\)</span>. Taking square roots leads to the of the estimators <span class="math inline">\(\hat\beta_k|X\)</span>
<span class="math display">\[\begin{align*}
\operatorname{SE}(\hat{\beta}_k|X)=&amp;\left(\left[\left(X^{\prime} X\right)^{-1} X^{\prime} \V(\eps|X) X\left(X^{\prime} X\right)^{-1}\right]_{kk}\right)^{1/2}\quad\small{\text{(generally)}}\\
=&amp;\left(\sigma^2\left[\left(X^{\prime} X\right)^{-1}\right]_{kk}\right)^{1/2},\hspace*{4cm}\small{\text{(spherical errors)}}
\end{align*}\]</span>
Of course, the above expressions for <span class="math inline">\(\V(\hat{\beta}_k|X)\)</span> and <span class="math inline">\(\operatorname{SE}(\hat{\beta}_k|X)\)</span> are generally useless in practice since we typically do not know the <span class="math inline">\((n\times n)\)</span> variance matrix <span class="math inline">\(\V(\eps|X)\)</span> or <span class="math inline">\(\sigma^2\)</span>, but need to estimate them from the data. So, we typically need to work with
<span class="math display">\[\begin{align*}
\widehat{\V}(\hat{\beta}_k|X)=&amp;\left[\left(X^{\prime} X\right)^{-1} X^{\prime} \widehat{\V}(\eps|X) X\left(X^{\prime} X\right)^{-1}\right]_{kk}\hspace*{1.5cm}\small{\text{(generally)}}\\
=&amp;\hat\sigma^2\left[\left(X^{\prime} X\right)^{-1}\right]_{kk},\hspace*{5cm}\small{\text{(spherical errors)}}\\
\text{and}\hspace*{3cm}&amp;\\
\widehat{\operatorname{SE}}(\hat{\beta}_k|X)=&amp;\left(\left[\left(X^{\prime} X\right)^{-1} X^{\prime} \widehat{\V}(\eps|X) X\left(X^{\prime} X\right)^{-1}\right]_{kk}\right)^{1/2}\quad\small{\text{(generally)}}\\
=&amp;\left(\hat\sigma^2\left[\left(X^{\prime}X\right)^{-1}\right]_{kk}\right)^{1/2},\hspace*{4cm}\small{\text{(spherical errors)}}
\end{align*}\]</span>
For the case of spherical errors, we already know a possible estimator, namely, <span class="math inline">\(\hat\sigma^2=s_{UB}^2=(n-K)^{-1}\sum_{i=1}^n\hat\eps_i^2\)</span>. However, finding a reasonable estimator <span class="math inline">\(\widehat\V(\eps|X)=\operatorname{diag}(\hat v_1,\dots,\hat v_n)\)</span> for the general heteroscedastic case is a little more tricky. The econometric literature knows the following heteroscedasticity-consistent (HC) robust approaches:
<span class="math display">\[\begin{align*}
\hspace*{-2cm}\text{HC0:}\quad &amp; \hat v_{i}=\hat{\eps}_{i}^{2} \\
\text{HC1:}\quad &amp; \hat v_{i}=\frac{n}{n-K} \hat{\eps}_{i}^{2} \\
\text{HC2:}\quad &amp; \hat v_{i}=\frac{\hat{\eps}_{i}^{2}}{1-h_{i}} \\
\text{HC3:}\quad &amp; \hat v_{i}=\frac{\hat{\eps}_{i}^{2}}{\left(1-h_{i}\right)^{2}}\text{\quad($\leftarrow$ Most often used)} \\
\text{HC4:}\quad &amp; \hat v_{i}=\frac{\hat{\eps}_{i}^{2}}{\left(1-h_{i}\right)^{\delta_{i}}}
\end{align*}\]</span>
where <span class="math inline">\(h_i=X_i&#39;(X&#39;X)^{-1}X_i=[P_X]_{ii}\)</span> is the <span class="math inline">\(i\)</span>th diagonal element of the projection matrix <span class="math inline">\(P_X\)</span>, <span class="math inline">\(\bar{h}=n^{-1}\sum_{i=1}^nh_i\)</span>, and <span class="math inline">\(\delta_i=\min\{4,h_i/\bar{h}\}\)</span>.</p>
<p>The statistic <span class="math inline">\(1/n\leq h_i\leq 1\)</span> is called the of <span class="math inline">\(X_i\)</span>, where (by construction) average leverage is <span class="math inline">\(n^{-1}\sum_{i=1}^nh_i=K/n\)</span>. Observations <span class="math inline">\(X_i\)</span> with leverage statistics <span class="math inline">\(h_i\)</span> that greatly exceed the average leverage value <span class="math inline">\(K/n\)</span> are referred to as observations. High-leverage observations have potentially a large influence on the estimation result. Typically, high-leverage observations <span class="math inline">\(X_i\)</span> distort the estimation results, <span class="math inline">\(\hat\beta\)</span>, if the absolute value of the corresponding residual <span class="math inline">\(|\hat{\eps}_i|\)</span> is unusually large ().</p>
<p>The estimator HC0 was suggested in the econometrics literature by and is justified by asymptotic arguments. The estimators HC1, HC2 and HC3 were suggested by to improve
the performance in small samples. A more extensive study of small sample behavior was carried out by which arrive at the conclusion that HC3 provides the best performance in small samples as it inflates the <span class="math inline">\(\hat\eps_i\)</span> values which is thought to adjust for the of observations with large leverage values <span class="math inline">\(h_i\)</span>. suggested the estimator HC4 to further improve small sample performance, especially in the presence of influential observations (large <span class="math inline">\(h_i\)</span> values).</p>
<p> In small samples, inference is only possible in a rather restrictive framework requiring spherical and Gaussian errors; see Chapter <a href="ch:SSINF.html#ch:SSINF">4</a>. In large samples, inference requires less restrictive assumptions and one can work with the HC robust standard error estimators; see Chapter <a href="ch:LSINF.html#ch:LSINF">5</a>.</p>
<p>The following code shows how to compute HC robust variance/standard error estimators:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="ch:VarEstBeta.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb76-2"><a href="ch:VarEstBeta.html#cb76-2" aria-hidden="true" tabindex="-1"></a>n      <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb76-3"><a href="ch:VarEstBeta.html#cb76-3" aria-hidden="true" tabindex="-1"></a>K      <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb76-4"><a href="ch:VarEstBeta.html#cb76-4" aria-hidden="true" tabindex="-1"></a>X      <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n<span class="sc">*</span>(K<span class="dv">-1</span>), <span class="dv">2</span>, <span class="dv">10</span>), n, K<span class="dv">-1</span>)</span>
<span id="cb76-5"><a href="ch:VarEstBeta.html#cb76-5" aria-hidden="true" tabindex="-1"></a>X      <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,X)</span>
<span id="cb76-6"><a href="ch:VarEstBeta.html#cb76-6" aria-hidden="true" tabindex="-1"></a>beta   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb76-7"><a href="ch:VarEstBeta.html#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># heteroscedastic errors:</span></span>
<span id="cb76-8"><a href="ch:VarEstBeta.html#cb76-8" aria-hidden="true" tabindex="-1"></a>sigma  <span class="ot">&lt;-</span> <span class="fu">abs</span>(X[,<span class="dv">2</span>] <span class="sc">+</span> X[,<span class="dv">3</span>])<span class="sc">^</span><span class="fl">1.5</span></span>
<span id="cb76-9"><a href="ch:VarEstBeta.html#cb76-9" aria-hidden="true" tabindex="-1"></a>error  <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd=</span>sigma)</span>
<span id="cb76-10"><a href="ch:VarEstBeta.html#cb76-10" aria-hidden="true" tabindex="-1"></a>Y      <span class="ot">&lt;-</span> beta[<span class="dv">1</span>]<span class="sc">*</span>X[,<span class="dv">1</span>] <span class="sc">+</span> beta[<span class="dv">2</span>]<span class="sc">*</span>X[,<span class="dv">2</span>] <span class="sc">+</span> beta[<span class="dv">3</span>]<span class="sc">*</span>X[,<span class="dv">3</span>] <span class="sc">+</span> error</span>
<span id="cb76-11"><a href="ch:VarEstBeta.html#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb76-12"><a href="ch:VarEstBeta.html#cb76-12" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X <span class="sc">-</span><span class="dv">1</span> )</span>
<span id="cb76-13"><a href="ch:VarEstBeta.html#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Caution! By default R computes the standard errors </span></span>
<span id="cb76-14"><a href="ch:VarEstBeta.html#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="do">## assuming homoscedastic errors. This can lead to </span></span>
<span id="cb76-15"><a href="ch:VarEstBeta.html#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="do">## false inferences under heteroscedastic errors.</span></span>
<span id="cb76-16"><a href="ch:VarEstBeta.html#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit)<span class="sc">$</span>coefficients </span>
<span id="cb76-17"><a href="ch:VarEstBeta.html#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Estimate Std. Error    t value    Pr(&gt;|t|)</span></span>
<span id="cb76-18"><a href="ch:VarEstBeta.html#cb76-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1 -3.818392  17.797787 -0.2145431 0.830573969</span></span>
<span id="cb76-19"><a href="ch:VarEstBeta.html#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2  5.474779   2.084915  2.6259006 0.010043024</span></span>
<span id="cb76-20"><a href="ch:VarEstBeta.html#cb76-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X3  5.566453   2.011848  2.7668360 0.006778811</span></span>
<span id="cb76-21"><a href="ch:VarEstBeta.html#cb76-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-22"><a href="ch:VarEstBeta.html#cb76-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sandwich&quot;</span>) <span class="co"># HC robust variance estimation </span></span>
<span id="cb76-23"><a href="ch:VarEstBeta.html#cb76-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lmtest&quot;</span>)</span>
<span id="cb76-24"><a href="ch:VarEstBeta.html#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Robust estimation of the variance of \hat{\beta}:</span></span>
<span id="cb76-25"><a href="ch:VarEstBeta.html#cb76-25" aria-hidden="true" tabindex="-1"></a>Var_beta_hat_robust <span class="ot">&lt;-</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_fit, <span class="at">type=</span><span class="st">&quot;HC3&quot;</span>)</span>
<span id="cb76-26"><a href="ch:VarEstBeta.html#cb76-26" aria-hidden="true" tabindex="-1"></a>Var_beta_hat_robust </span>
<span id="cb76-27"><a href="ch:VarEstBeta.html#cb76-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           X1         X2         X3</span></span>
<span id="cb76-28"><a href="ch:VarEstBeta.html#cb76-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1 389.83293 -39.198061 -38.026861</span></span>
<span id="cb76-29"><a href="ch:VarEstBeta.html#cb76-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2 -39.19806   5.763624   2.260672</span></span>
<span id="cb76-30"><a href="ch:VarEstBeta.html#cb76-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X3 -38.02686   2.260672   5.437287</span></span>
<span id="cb76-31"><a href="ch:VarEstBeta.html#cb76-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Corresponding regression-output:</span></span>
<span id="cb76-32"><a href="ch:VarEstBeta.html#cb76-32" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_fit, <span class="at">vcov =</span> Var_beta_hat_robust)</span>
<span id="cb76-33"><a href="ch:VarEstBeta.html#cb76-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb76-34"><a href="ch:VarEstBeta.html#cb76-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t test of coefficients:</span></span>
<span id="cb76-35"><a href="ch:VarEstBeta.html#cb76-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb76-36"><a href="ch:VarEstBeta.html#cb76-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb76-37"><a href="ch:VarEstBeta.html#cb76-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X1  -3.8184    19.7442 -0.1934  0.84706  </span></span>
<span id="cb76-38"><a href="ch:VarEstBeta.html#cb76-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X2   5.4748     2.4008  2.2804  0.02477 *</span></span>
<span id="cb76-39"><a href="ch:VarEstBeta.html#cb76-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; X3   5.5665     2.3318  2.3872  0.01892 *</span></span>
<span id="cb76-40"><a href="ch:VarEstBeta.html#cb76-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb76-41"><a href="ch:VarEstBeta.html#cb76-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>Observe that the HC robust variance estimation leads to larger variances than the classic variance estimation for homoscedastic errors. This is typically, but not always, the case.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="unbiasedness-of-hatbetax-and-hatbeta.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-gauss-markov-theorem.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Script_Econometrics_MSc.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"download": "https://uni-bonn.sciebo.de/s/IZ2yeLeA4dRTFUY",
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
