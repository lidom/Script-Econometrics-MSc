#####################################
### This file generates Figure 28.7
### MMA weight selection
#####################################
### Uses package spatstat
#####################################

library(spatstat)

wd <- 1.4

pdf("HANSEN28-7a.pdf",family="Helvetica",colormodel='cmyk',width=4.5,height=4.5)
plot.new()
plot.window(c(-2,2.5),c(-2,2))
polygon(c(-sqrt(3)/2,sqrt(3)/2,0,-sqrt(3)/2),c(-1/2,-1/2,1,-1/2),col=gray(.8),lwd=wd)
arrows(0,0,0,2,angle=20,length=.1,lwd=wd)
arrows(0,0,sqrt(3),-1,angle=20,length=.1,lwd=wd)
arrows(0,0,-sqrt(3),-1,angle=20,length=.1,lwd=wd)
W1 <- ellipse(a=1,b=1/2,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W1,add=TRUE,lwd=wd)
W2 <- ellipse(a=1/2,b=1/4,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W2,add=TRUE,lwd=wd)
W3 <- ellipse(a=1/4,b=1/8,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W3,add=TRUE,lwd=wd)
W4 <- ellipse(a=3/4,b=3/8,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W4,add=TRUE,lwd=wd)
points(sqrt(3),0,pch=19,col="black",cex=.7)
points(sqrt(3)/2,-1/2,pch=19,col="black",cex=.7)
text(-1.4,-1,expression(w[1]))
text(1.45,-1,expression(w[2]))
text(.2,2,expression(w[3]))
dev.off()

postscript("HANSEN28-7a.eps",paper="special",width=4.5,height=4.5,horizontal=FALSE,onefile=FALSE,family="Helvetica",colormodel='cmyk')
plot.new()
plot.window(c(-2,2.5),c(-2,2))
polygon(c(-sqrt(3)/2,sqrt(3)/2,0,-sqrt(3)/2),c(-1/2,-1/2,1,-1/2),col=gray(.8),lwd=wd)
arrows(0,0,0,2,angle=20,length=.1,lwd=wd)
arrows(0,0,sqrt(3),-1,angle=20,length=.1,lwd=wd)
arrows(0,0,-sqrt(3),-1,angle=20,length=.1,lwd=wd)
W1 <- ellipse(a=1,b=1/2,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W1,add=TRUE,lwd=wd)
W2 <- ellipse(a=1/2,b=1/4,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W2,add=TRUE,lwd=wd)
W3 <- ellipse(a=1/4,b=1/8,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W3,add=TRUE,lwd=wd)
W4 <- ellipse(a=3/4,b=3/8,centre=c(sqrt(3),0),phi=pi/6,npoly=1024)
plot(W4,add=TRUE,lwd=wd)
points(sqrt(3),0,pch=19,col="black",cex=.7)
points(sqrt(3)/2,-1/2,pch=19,col="black",cex=.7)
text(-1.4,-1,expression(w[1]))
text(1.45,-1,expression(w[2]))
text(.2,2,expression(w[3]))
dev.off()


pdf("HANSEN28-7b.pdf",family="Helvetica",colormodel='cmyk',width=4.5,height=4.5)
plot.new()
plot.window(c(-2,2.5),c(-2,2))
polygon(c(-sqrt(3)/2,sqrt(3)/2,0,-sqrt(3)/2),c(-1/2,-1/2,1,-1/2),col=gray(.8),lwd=wd)
arrows(0,0,0,2,angle=20,length=.1,lwd=wd)
arrows(0,0,sqrt(3),-1,angle=20,length=.1,lwd=wd)
arrows(0,0,-sqrt(3),-1,angle=20,length=.1,lwd=wd)
text(-1.4,-1,expression(w[1]))
text(1.45,-1,expression(w[2]))
text(.2,2,expression(w[3]))
W1 <- ellipse(a=3/4,b=1/2,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W1,add=TRUE,lwd=wd)
W2 <- ellipse(a=3/8,b=1/4,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W2,add=TRUE,lwd=wd)
W3 <- ellipse(a=3/16,b=1/8,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W3,add=TRUE,lwd=wd)
W4 <- ellipse(a=9/16,b=3/8,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W4,add=TRUE,lwd=wd)
points(-.88,.88,pch=19,col="black",cex=.7)
points(-.39,.34,pch=19,col="black",cex=.7)
dev.off()

postscript("HANSEN28-7b.eps",paper="special",width=4.5,height=4.5,horizontal=FALSE,onefile=FALSE,family="Helvetica",colormodel='cmyk')
plot.new()
plot.window(c(-2,2.5),c(-2,2))
polygon(c(-sqrt(3)/2,sqrt(3)/2,0,-sqrt(3)/2),c(-1/2,-1/2,1,-1/2),col=gray(.8),lwd=wd)
arrows(0,0,0,2,angle=20,length=.1,lwd=wd)
arrows(0,0,sqrt(3),-1,angle=20,length=.1,lwd=wd)
arrows(0,0,-sqrt(3),-1,angle=20,length=.1,lwd=wd)
text(-1.4,-1,expression(w[1]))
text(1.45,-1,expression(w[2]))
text(.2,2,expression(w[3]))
W1 <- ellipse(a=3/4,b=1/2,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W1,add=TRUE,lwd=wd)
W2 <- ellipse(a=3/8,b=1/4,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W2,add=TRUE,lwd=wd)
W3 <- ellipse(a=3/16,b=1/8,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W3,add=TRUE,lwd=wd)
W4 <- ellipse(a=9/16,b=3/8,centre=c(-.88,.88),phi=-pi/3,npoly=1024)
plot(W4,add=TRUE,lwd=wd)
points(-.88,.88,pch=19,col="black",cex=.7)
points(-.39,.34,pch=19,col="black",cex=.7)
dev.off()

