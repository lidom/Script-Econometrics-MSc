<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>3&nbsp; Matrix Algebra – Basis Module Econometrics (M.Sc.)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-Monte-Carlo-Simulations.html" rel="next">
<link href="./02-Probability.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-Matrix-Algebra.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/Uni_Bonn_Logo.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Basis Module Econometrics (M.Sc.)</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Organization of the Course</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Introduction-to-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Matrix-Algebra.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matrix Algebra</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Monte-Carlo-Simulations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimation Theory and Monte Carlo Simulations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Multiple-Linear-Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Small-Sample-Inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Small Sample Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Asymptotics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Large Sample Inference</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#basic-definitions" id="toc-basic-definitions" class="nav-link active" data-scroll-target="#basic-definitions"><span class="header-section-number">3.1</span> Basic Definitions</a>
  <ul class="collapse">
<li><a href="#scalar-vector-and-matrix" id="toc-scalar-vector-and-matrix" class="nav-link" data-scroll-target="#scalar-vector-and-matrix"><span class="header-section-number">3.1.1</span> Scalar, Vector and Matrix</a></li>
  <li><a href="#some-specific-matrices" id="toc-some-specific-matrices" class="nav-link" data-scroll-target="#some-specific-matrices"><span class="header-section-number">3.1.2</span> Some Specific Matrices</a></li>
  <li><a href="#transposition" id="toc-transposition" class="nav-link" data-scroll-target="#transposition"><span class="header-section-number">3.1.3</span> Transposition</a></li>
  <li><a href="#matrices-in-r" id="toc-matrices-in-r" class="nav-link" data-scroll-target="#matrices-in-r"><span class="header-section-number">3.1.4</span> Matrices in <code>R</code></a></li>
  </ul>
</li>
  <li>
<a href="#sums-and-products" id="toc-sums-and-products" class="nav-link" data-scroll-target="#sums-and-products"><span class="header-section-number">3.2</span> Sums and Products</a>
  <ul class="collapse">
<li><a href="#matrix-summation" id="toc-matrix-summation" class="nav-link" data-scroll-target="#matrix-summation"><span class="header-section-number">3.2.1</span> Matrix Summation</a></li>
  <li><a href="#scalar-matrix-multiplication" id="toc-scalar-matrix-multiplication" class="nav-link" data-scroll-target="#scalar-matrix-multiplication"><span class="header-section-number">3.2.2</span> Scalar-Matrix Multiplication</a></li>
  <li><a href="#element-by-element-operations-in-r" id="toc-element-by-element-operations-in-r" class="nav-link" data-scroll-target="#element-by-element-operations-in-r"><span class="header-section-number">3.2.3</span> Element-by-Element Operations in R</a></li>
  <li><a href="#vector-vector-multiplication" id="toc-vector-vector-multiplication" class="nav-link" data-scroll-target="#vector-vector-multiplication"><span class="header-section-number">3.2.4</span> Vector-Vector Multiplication</a></li>
  <li><a href="#matrix-matrix-multiplication" id="toc-matrix-matrix-multiplication" class="nav-link" data-scroll-target="#matrix-matrix-multiplication"><span class="header-section-number">3.2.5</span> Matrix-Matrix Multiplication</a></li>
  </ul>
</li>
  <li>
<a href="#rank-and-inverse" id="toc-rank-and-inverse" class="nav-link" data-scroll-target="#rank-and-inverse"><span class="header-section-number">3.3</span> Rank and Inverse</a>
  <ul class="collapse">
<li><a href="#linear-combination" id="toc-linear-combination" class="nav-link" data-scroll-target="#linear-combination"><span class="header-section-number">3.3.1</span> Linear Combination</a></li>
  <li><a href="#column-rank" id="toc-column-rank" class="nav-link" data-scroll-target="#column-rank"><span class="header-section-number">3.3.2</span> Column Rank</a></li>
  <li><a href="#nonsingular-matrix" id="toc-nonsingular-matrix" class="nav-link" data-scroll-target="#nonsingular-matrix"><span class="header-section-number">3.3.3</span> Nonsingular Matrix</a></li>
  <li><a href="#determinant" id="toc-determinant" class="nav-link" data-scroll-target="#determinant"><span class="header-section-number">3.3.4</span> Determinant</a></li>
  <li><a href="#inverse-matrix" id="toc-inverse-matrix" class="nav-link" data-scroll-target="#inverse-matrix"><span class="header-section-number">3.3.5</span> Inverse Matrix</a></li>
  </ul>
</li>
  <li>
<a href="#further-concepts" id="toc-further-concepts" class="nav-link" data-scroll-target="#further-concepts"><span class="header-section-number">3.4</span> Further Concepts</a>
  <ul class="collapse">
<li><a href="#trace" id="toc-trace" class="nav-link" data-scroll-target="#trace"><span class="header-section-number">3.4.1</span> Trace</a></li>
  <li><a href="#idempotent-matrix" id="toc-idempotent-matrix" class="nav-link" data-scroll-target="#idempotent-matrix"><span class="header-section-number">3.4.2</span> Idempotent Matrix</a></li>
  <li><a href="#definite-matrix" id="toc-definite-matrix" class="nav-link" data-scroll-target="#definite-matrix"><span class="header-section-number">3.4.3</span> Definite Matrix</a></li>
  </ul>
</li>
  <li>
<a href="#advanced-concepts" id="toc-advanced-concepts" class="nav-link" data-scroll-target="#advanced-concepts"><span class="header-section-number">3.5</span> Advanced Concepts</a>
  <ul class="collapse">
<li><a href="#eigendecomposition" id="toc-eigendecomposition" class="nav-link" data-scroll-target="#eigendecomposition"><span class="header-section-number">3.5.1</span> Eigendecomposition</a></li>
  <li><a href="#definiteness-property-and-eigenvalues" id="toc-definiteness-property-and-eigenvalues" class="nav-link" data-scroll-target="#definiteness-property-and-eigenvalues"><span class="header-section-number">3.5.2</span> Definiteness Property and Eigenvalues</a></li>
  <li><a href="#cholesky-decomposition" id="toc-cholesky-decomposition" class="nav-link" data-scroll-target="#cholesky-decomposition"><span class="header-section-number">3.5.3</span> Cholesky Decomposition</a></li>
  <li><a href="#vectorization" id="toc-vectorization" class="nav-link" data-scroll-target="#vectorization"><span class="header-section-number">3.5.4</span> Vectorization</a></li>
  <li><a href="#kronecker-product" id="toc-kronecker-product" class="nav-link" data-scroll-target="#kronecker-product"><span class="header-section-number">3.5.5</span> Kronecker Product</a></li>
  <li><a href="#vector-and-matrix-norm" id="toc-vector-and-matrix-norm" class="nav-link" data-scroll-target="#vector-and-matrix-norm"><span class="header-section-number">3.5.6</span> Vector and Matrix Norm</a></li>
  </ul>
</li>
  <li>
<a href="#matrix-calculus" id="toc-matrix-calculus" class="nav-link" data-scroll-target="#matrix-calculus"><span class="header-section-number">3.6</span> Matrix Calculus</a>
  <ul class="collapse">
<li><a href="#gradient" id="toc-gradient" class="nav-link" data-scroll-target="#gradient"><span class="header-section-number">3.6.1</span> Gradient</a></li>
  <li><a href="#hessian" id="toc-hessian" class="nav-link" data-scroll-target="#hessian"><span class="header-section-number">3.6.2</span> Hessian</a></li>
  <li><a href="#optimization" id="toc-optimization" class="nav-link" data-scroll-target="#optimization"><span class="header-section-number">3.6.3</span> Optimization</a></li>
  </ul>
</li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">3.7</span> Exercises</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matrix Algebra</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="basic-definitions" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="basic-definitions">
<span class="header-section-number">3.1</span> Basic Definitions</h2>
<p>Let’s start with some basic definitions and specific examples.</p>
<section id="scalar-vector-and-matrix" class="level3" data-number="3.1.1"><h3 data-number="3.1.1" class="anchored" data-anchor-id="scalar-vector-and-matrix">
<span class="header-section-number">3.1.1</span> Scalar, Vector and Matrix</h3>
<p>A <strong>scalar</strong> <span class="math inline">\(a\)</span> is a single real number. We write <span class="math inline">\(a \in \mathbb R\)</span>.</p>
<p>A <strong>vector</strong> <span class="math inline">\(a\)</span> of length <span class="math inline">\(k\)</span> is a <span class="math inline">\(k \times 1\)</span> list of real numbers <span class="math display">\[
a = \begin{pmatrix} a_1 \\ a_2 \\ \vdots \\ a_k \end{pmatrix}.
\]</span> By default, when we refer to a vector, we always mean a column vector. We write <span class="math inline">\(a \in \mathbb R^k\)</span>. The value <span class="math inline">\(a_i\)</span> is called <span class="math inline">\(i\)</span>-th entry or <span class="math inline">\(i\)</span>-th component of <span class="math inline">\(a\)</span>. A scalar is a vector of length 1.</p>
<p>A row vector of length <span class="math inline">\(k\)</span> is written as <span class="math display">\[
b = (b_1, \ldots, b_k).
\]</span></p>
<p>A <strong>matrix</strong> <span class="math inline">\(A\)</span> of order (or dimension) <span class="math inline">\(k \times m\)</span> is a rectangular array of real numbers <span class="math display">\[
A =\begin{pmatrix}
             a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1m}\\
             a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2m}\\
             \vdots &amp; \vdots &amp;       &amp; \vdots\\
             a_{k1} &amp; a_{k2} &amp; \cdots &amp; a_{km}
\end{pmatrix}
\]</span> with <span class="math inline">\(k\)</span> rows and <span class="math inline">\(m\)</span> columns. We write <span class="math inline">\(A \in \mathbb R^{k \times m}\)</span>. The value <span class="math inline">\(a_{ij}\)</span> is called <span class="math inline">\((i,j)\)</span>-th entry or <span class="math inline">\((i,j)\)</span>-th component of <span class="math inline">\(A\)</span>. We also use the notation <span class="math inline">\((A)_{i,j}\)</span> to denote the <span class="math inline">\((i,j)\)</span>-th entry. A vector of length <span class="math inline">\(k\)</span> is a <span class="math inline">\(k \times 1\)</span> matrix. A row vector of length <span class="math inline">\(k\)</span> is a <span class="math inline">\(1 \times k\)</span> matrix. A scalar is a matrix of order <span class="math inline">\(1 \times 1\)</span>.</p>
<p>We may describe a matrix <span class="math inline">\(A\)</span> by its column or row vectors as <span class="math display">\[
A = \begin{pmatrix} a_1 &amp; a_2 &amp; \ldots &amp; a_m \end{pmatrix}
= \begin{pmatrix} \alpha_1 \\ \vdots \\ \alpha_k \end{pmatrix},
\]</span> where <span class="math display">\[
a_i = \begin{pmatrix} a_{1i} \\ \vdots \\ a_{ki} \end{pmatrix}
\]</span> is the <span class="math inline">\(i\)</span>-th column of <span class="math inline">\(A\)</span> and <span class="math display">\[
\alpha_i = (a_{i1}, \ldots, a_{im})
\]</span> is the <span class="math inline">\(i\)</span>-th row.</p>
</section><section id="some-specific-matrices" class="level3" data-number="3.1.2"><h3 data-number="3.1.2" class="anchored" data-anchor-id="some-specific-matrices">
<span class="header-section-number">3.1.2</span> Some Specific Matrices</h3>
<p>A matrix is called <strong>square matrix</strong> if the numbers of rows and columns coincide, i.e., <span class="math inline">\(k=m.\)</span> For instance, <span class="math display">\[
{B} = \begin{pmatrix}1 &amp; 2 \\ 3 &amp; 4 \end{pmatrix}
\]</span> is a <span class="math inline">\((2\times 2)\)</span> square matrix. A square matrix is called <strong>diagonal matrix</strong> if all off-diagonal elements are zero. <span class="math display">\[
{C} = \begin{pmatrix}1 &amp; 0 \\ 0 &amp; 4 \end{pmatrix}
\]</span> is a diagonal matrix. We also write <span class="math display">\[
C = \mathop{\mathrm{diag}}(1,4).
\]</span> A square matrix is called <strong>upper triangular</strong> if all elements below the main diagonal are zero, and <strong>lower triangular</strong> if all elements above the main diagonal are zero. Examples of an upper triangular matrix <span class="math inline">\(D\)</span> and a lower triangular matrix <span class="math inline">\(E\)</span> are <span class="math display">\[
{D} = \begin{pmatrix}1 &amp; 2 \\ 0 &amp; 4 \end{pmatrix}
\quad \text{and}\quad
{E} = \begin{pmatrix}1 &amp; 0 \\ 3 &amp; 4 \end{pmatrix}.
\]</span> The <span class="math inline">\(k \times k\)</span> diagonal matrix <span class="math display">\[
{I}_k=
      \begin{pmatrix}
      1      &amp; 0      &amp; \cdots &amp; 0\\
      0      &amp; 1      &amp; \cdots &amp; 0\\
      \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
      0      &amp; 0      &amp; \cdots &amp; 1
      \end{pmatrix} = \mathop{\mathrm{diag}}(1, \ldots, 1)
\]</span> is called <strong>identity matrix</strong> of order <span class="math inline">\(k\)</span>. The <span class="math inline">\(k \times m\)</span> matrix <span class="math display">\[
\underset{(k\times m)}{0}\;=0=\begin{pmatrix}
             0      &amp; \cdots &amp; 0\\
            \vdots &amp;  \ddots      &amp; \vdots\\
            0      &amp; \cdots &amp; 0
       \end{pmatrix}
\]</span> is called <strong>zero matrix</strong>.</p>
<p>The <strong>zero (column) vector</strong> of length <span class="math inline">\(k\)</span> is <span class="math display">\[
\underset{(k\times 1)}{0}\; 0
       =\begin{pmatrix}
             0   \\
            \vdots \\
            0
       \end{pmatrix}.
\]</span> If the order becomes clear from the context, we omit the indices and write <span class="math inline">\(I\)</span> for the identity matrix and <span class="math inline">\(0\)</span> for the zero matrix or zero vector.</p>
</section><section id="transposition" class="level3" data-number="3.1.3"><h3 data-number="3.1.3" class="anchored" data-anchor-id="transposition">
<span class="header-section-number">3.1.3</span> Transposition</h3>
<p>The <strong>transpose</strong> <span class="math inline">\(A'\)</span> of the matrix <span class="math inline">\(A\)</span> is obtained by flipping rows and columns on the main diagonal: <span class="math display">\[
A =\begin{pmatrix}
             a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1m}\\
             a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2m}\\
             \vdots &amp; \vdots &amp;       &amp; \vdots\\
             a_{k1} &amp; a_{k2} &amp; \cdots &amp; a_{km}
\end{pmatrix}
\]</span> <span class="math display">\[
{A}'=\begin{pmatrix}
    a_{11} &amp; a_{21} &amp; \cdots &amp; a_{k1}\\
    a_{12} &amp; a_{22} &amp; \cdots &amp; a_{k2}\\
    \vdots &amp; \vdots &amp;       &amp; \vdots\\
    a_{1m} &amp; a_{2m} &amp; \cdots &amp; a_{km}
\end{pmatrix}.
\]</span> If <span class="math inline">\(A\)</span> is a matrix of order <span class="math inline">\(k\times m\)</span>, then <span class="math inline">\(A'\)</span> is a matrix of order <span class="math inline">\(m \times k\)</span>. <em>Example:</em> <span class="math display">\[
{A}=\begin{pmatrix}
        1 &amp; 2\\
        4 &amp; 5\\
        7 &amp; 8
\end{pmatrix}\quad\Rightarrow\quad
{A}'=\begin{pmatrix}
        1 &amp; 4 &amp; 7\\
        2 &amp; 5 &amp; 8
\end{pmatrix}
\]</span> The definition implies that transposing twice produces the original matrix: <span class="math display">\[
(A')' = A.
\]</span> The transpose of a (column) vector is a row vector: <span class="math display">\[
a' = (a_1, \ldots, a_k)
\]</span></p>
<p>A <strong>symmetric matrix</strong> is a square matrix <span class="math inline">\(A\)</span> with <span class="math inline">\({A}'={A}\)</span>. An example of a symmetric matrix is <span class="math display">\[
A = \begin{aligned}         \left(\begin{matrix}1 &amp; 2 \\ 2 &amp; 4 \end{matrix}\right)\end{aligned}.
\]</span></p>
</section><section id="matrices-in-r" class="level3" data-number="3.1.4"><h3 data-number="3.1.4" class="anchored" data-anchor-id="matrices-in-r">
<span class="header-section-number">3.1.4</span> Matrices in <code>R</code>
</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    2
[2,]    4    5
[3,]    7    8</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="co">#transpose of A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="co">#the (3,2)-entry of A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># another matrix</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">B</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span> <span class="co">#check whether B is symmetric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co">#diagonal matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    0
[2,]    0    4</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co">#identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    0    0
[2,]    0    1    0
[3,]    0    0    1</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="co">#matrix of zeros</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    0    0    0    0    0
[2,]    0    0    0    0    0</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="co">#number of rows and columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 2</code></pre>
</div>
</div>
</section></section><section id="sums-and-products" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="sums-and-products">
<span class="header-section-number">3.2</span> Sums and Products</h2>
<section id="matrix-summation" class="level3" data-number="3.2.1"><h3 data-number="3.2.1" class="anchored" data-anchor-id="matrix-summation">
<span class="header-section-number">3.2.1</span> Matrix Summation</h3>
<p>Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> both be matrices of order <span class="math inline">\(k \times m\)</span>. Their sum is defined componentwise: <span class="math display">\[
{A} + {B}
=\begin{pmatrix}
a_{11}+ b_{11} &amp; a_{12}+ b_{12} &amp; \cdots &amp; a_{1m}+ b_{1m} \\
a_{21}+ b_{21} &amp; a_{22}+ b_{22} &amp; \cdots &amp; a_{2m}+ b_{2m} \\
\vdots        &amp; \vdots        &amp;       &amp; \vdots        \\
a_{k1}+ b_{k1} &amp; a_{k2}+ b_{k2} &amp; \cdots &amp; a_{km}+ b_{km}
\end{pmatrix}.
\]</span> Only two matrices of the same order can be added.</p>
<p>Example: <span class="math display">\[
{A}=\begin{pmatrix}2&amp;0\\1&amp;5\\3&amp;2\end{pmatrix}\,,\quad
{B}=\begin{pmatrix}-1&amp;1\\7&amp;1\\-5&amp;2\end{pmatrix}\,,\quad
{A}+{B}=\begin{pmatrix}1&amp;1\\8&amp;6\\-2&amp;4\end{pmatrix}\,.
\]</span></p>
<p>The matrix summation satisfies the following rules: <span class="math display">\[
\begin{array}{@{}rr@{\ }c@{\ }l@{}r@{}}
\text{(i)}   &amp; {A}+{B}       &amp;=&amp; {B}+{A}\,       &amp; \text{(commutativity)}   \\
\text{(ii)}  &amp; ({A}+{B})+{C} &amp;=&amp; {A}+({B}+{C})\, &amp; \text{(associativity)}   \\
\text{(iii)} &amp; A + 0         &amp;=&amp; A               &amp; \text{(identity element)}\\
\text{(iv)}  &amp; (A + B)'      &amp;=&amp; A' + B'         &amp; \text{(transposition)}          
\end{array}
\]</span></p>
</section><section id="scalar-matrix-multiplication" class="level3" data-number="3.2.2"><h3 data-number="3.2.2" class="anchored" data-anchor-id="scalar-matrix-multiplication">
<span class="header-section-number">3.2.2</span> Scalar-Matrix Multiplication</h3>
<p>The product of a <span class="math inline">\(k \times m\)</span> matrix <span class="math inline">\({A}\)</span> with a scalar <span class="math inline">\(\lambda\in\mathbb{R}\)</span> is defined componentwise: <span class="math display">\[
\lambda {A} =
\begin{pmatrix}
   \lambda a_{11}   &amp; \lambda a_{12} &amp; \cdots  &amp; \lambda a_{1n} \\
   \lambda a_{21}   &amp; \lambda a_{22} &amp; \cdots  &amp; \lambda a_{2n} \\
   \vdots           &amp; \vdots &amp;                &amp; \vdots         \\
   \lambda a_{m1}   &amp; \lambda a_{m2} &amp; \cdots  &amp; \lambda a_{mn}
\end{pmatrix}.
\]</span></p>
<p><em>Example:</em> <span class="math display">\[
\lambda=2, \quad {A}=\begin{pmatrix}2&amp;0\\1&amp;5\\3&amp;2\end{pmatrix},\quad
\lambda{A}=\begin{pmatrix}4&amp;0\\2&amp;10\\6&amp;4\end{pmatrix}.\]</span> Scalar-matrix multiplication satisfies the distributivity law: <span class="math display">\[\begin{array}{@{}rr@{\ }c@{\ }l@{}r@{}}
\text{(i)}    &amp; \lambda({A}+{B})&amp;=&amp; \lambda{A}+\lambda{B}\, &amp;    \\
\text{(ii)}   &amp; (\lambda+\mu){A} &amp;=&amp; \lambda{A}+\mu{A}\,     &amp;
\end{array}
\]</span></p>
</section><section id="element-by-element-operations-in-r" class="level3" data-number="3.2.3"><h3 data-number="3.2.3" class="anchored" data-anchor-id="element-by-element-operations-in-r">
<span class="header-section-number">3.2.3</span> Element-by-Element Operations in R</h3>
<p>Basic arithmetic operations work on an element-by-element basis in <code>R</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">7</span>,<span class="op">-</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">A</span><span class="op">+</span><span class="va">B</span> <span class="co">#matrix summation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    1
[2,]    8    6
[3,]   -2    4</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span><span class="op">-</span><span class="va">B</span> <span class="co">#matrix subtraction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    3   -1
[2,]   -6    4
[3,]    8    0</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">2</span><span class="op">*</span><span class="va">A</span> <span class="co">#scalar-matrix product</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    4    0
[2,]    2   10
[3,]    6    4</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span><span class="op">/</span><span class="fl">2</span> <span class="co">#division of entries by 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]  1.0  0.0
[2,]  0.5  2.5
[3,]  1.5  1.0</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span><span class="op">*</span><span class="va">B</span> <span class="co">#element-wise multiplication</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   -2    0
[2,]    7    5
[3,]  -15    4</code></pre>
</div>
</div>
</section><section id="vector-vector-multiplication" class="level3" data-number="3.2.4"><h3 data-number="3.2.4" class="anchored" data-anchor-id="vector-vector-multiplication">
<span class="header-section-number">3.2.4</span> Vector-Vector Multiplication</h3>
<section id="inner-product" class="level4" data-number="3.2.4.1"><h4 data-number="3.2.4.1" class="anchored" data-anchor-id="inner-product">
<span class="header-section-number">3.2.4.1</span> Inner Product</h4>
<p>The <strong>inner product</strong> (also known as dot product) of two vectors <span class="math inline">\({a},{b}\in\mathbb{R}^k\)</span> is <span class="math display">\[
{a}'{b} = a_1 b_1+a_2b_2+\ldots+a_kb_k=\sum_{i=1}^k a_ib_i\in\mathbb{R}.
\]</span></p>
<p><em>Example:</em> <span class="math display">\[
{a}=\begin{pmatrix}1\\2\\3\end{pmatrix},\quad
{b}=\begin{pmatrix}-2\\0\\2\end{pmatrix},\quad
{a}'{b}=1\cdot(-2)+2\cdot0+3\cdot2=4.
\]</span></p>
<p>The inner product is commutative: <span class="math display">\[
\begin{align*}
  a' b = b' a.
\end{align*}
\]</span> Two vectors <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are called <strong>orthogonal</strong> if <span class="math display">\[
a' b = 0.
\]</span></p>
<p>The vectors <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are called <strong>orthonormal</strong> if, in addition to <span class="math inline">\(a'b\)</span>, we have <span class="math display">\[
a' a = 1\quad\text{and}\quad b' b=1.
\]</span></p>
</section><section id="outer-product" class="level4" data-number="3.2.4.2"><h4 data-number="3.2.4.2" class="anchored" data-anchor-id="outer-product">
<span class="header-section-number">3.2.4.2</span> Outer Product</h4>
<p>The outer product (also known as dyadic product) of two vectors <span class="math inline">\({x} \in \mathbb R^k\)</span> and <span class="math inline">\({y}\in\mathbb{R}^m\)</span> is <span class="math display">\[
{x}{y}' =
\left(\begin{matrix}
x_1 y_1 &amp; x_1 y_2  &amp;\ldots &amp; x_1 y_m \\
x_2 y_1 &amp; x_2 y_2 &amp; \ldots &amp; x_2 y_m \\
\vdots   &amp; \vdots &amp;      &amp; \vdots    \\
x_k y_1 &amp; x_k y_2 &amp; \ldots &amp; x_k y_m
\end{matrix}\right)\in  \mathbb{R}^{k \times m}.
\]</span> <em>Example:</em> <span class="math display">\[
{x}=\begin{pmatrix}1\\2\end{pmatrix}\,,\quad
{y}=\begin{pmatrix}-2\\0\\2\end{pmatrix}\,,\quad
{x}{y}'=\left(\begin{matrix}
-2 &amp; 0 &amp; 2 \\
-4 &amp; 0 &amp; 4
\end{matrix}\right).
\]</span></p>
</section><section id="vector-multiplication-in-r" class="level4" data-number="3.2.4.3"><h4 data-number="3.2.4.3" class="anchored" data-anchor-id="vector-multiplication-in-r">
<span class="header-section-number">3.2.4.3</span> Vector Multiplication in <code>R</code>
</h4>
<p>For vector multiplication in <code>R</code>, we use the operator <code>%*%</code> (recall that <code>*</code> is already reserved for element-wise multiplication). Let’s implement some multiplications.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span> <span class="co">#y is treated as a column vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">y</span> <span class="co">#the inner product of y with itself</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   70</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="co">#the outer product of y with itself</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    4   14    8    2
[2,]   14   49   28    7
[3,]    8   28   16    4
[4,]    2    7    4    1</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#the example from above</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   -2    0    2
[2,]   -4    0    4</code></pre>
</div>
</div>
</section></section><section id="matrix-matrix-multiplication" class="level3" data-number="3.2.5"><h3 data-number="3.2.5" class="anchored" data-anchor-id="matrix-matrix-multiplication">
<span class="header-section-number">3.2.5</span> Matrix-Matrix Multiplication</h3>
<p>The <strong>matrix product</strong> of a <span class="math inline">\(k \times m\)</span> matrix <span class="math inline">\({A}\)</span> and a <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\({B}\)</span> is the <span class="math inline">\(k\times n\)</span> matrix <span class="math inline">\(C = {A}{B}\)</span> with the components <span class="math display">\[
c_{ij} = a_{i1}b_{1j}+a_{i2}b_{2j}+\ldots+a_{im}b_{mj}=\sum_{l=1}^m a_{il}b_{lj} = a_i' b_j,
\]</span> where <span class="math inline">\(a_i = (a_{i1}, \ldots, a_{im})'\)</span> is the <span class="math inline">\(i\)</span>-th row of <span class="math inline">\(A\)</span> written as a column vector, and <span class="math inline">\(b_j = (b_{1j}, \ldots, b_{mj})'\)</span> is the <span class="math inline">\(j\)</span>-th column of <span class="math inline">\(B\)</span>. The full matrix product can be written as <span class="math display">\[
A B = \begin{pmatrix} a_1' \\ \vdots \\ a_k' \end{pmatrix}
\begin{pmatrix} b_1 &amp; \ldots &amp; b_n \end{pmatrix}
= \begin{pmatrix} a_1' b_1 &amp; \ldots &amp; a_1' b_n \\ \vdots &amp; &amp; \vdots \\ a_k' b_1 &amp; \ldots &amp; a_k' b_n \end{pmatrix}.
\]</span> The matrix product is only defined if the number of columns of the first matrix equals the number of rows of the second matrix. Therefore, we say that the <span class="math inline">\(k \times m\)</span> matrix <span class="math inline">\(A\)</span> and the <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\(B\)</span> are <strong>conformable for matrix multiplication</strong>.</p>
<p><em>Example:</em> Let <span class="math display">\[\begin{aligned}
    {A}=\begin{pmatrix}
    1 &amp; 0\\
    0 &amp; 1\\
    2 &amp; 1
\end{pmatrix}, \quad
{B}=\begin{pmatrix}
    -1 &amp; 2\\
    -3 &amp; 0
\end{pmatrix}.\end{aligned}
\]</span> Their matrix product is <span class="math display">\[
\begin{aligned}
{A} {B} &amp;= \begin{pmatrix}
    1 &amp; 0\\
    0 &amp; 1\\
    2 &amp; 1
\end{pmatrix} \begin{pmatrix}
    -1 &amp; 2\\
    -3 &amp; 0
\end{pmatrix} \\ &amp;= \left(\begin{matrix}1 \cdot (-1) + 0 \cdot (-3) &amp; 1 \cdot 2 + 0 \cdot 0 \\ 0 \cdot (-1) + 1 \cdot (-3) &amp; 0 \cdot 2 + 1 \cdot 0 \\ 2 \cdot (-1) + 1 \cdot (-3) &amp; 2 \cdot 2 + 1 \cdot 0 \end{matrix}\right)
= \left(\begin{matrix}-1 &amp; 2 \\ -3 &amp; 0 \\ -5 &amp; 4 \end{matrix}\right).\end{aligned}
\]</span></p>
<p>The <code>%*%</code> operator is used in <code>R</code> for matrix-matrix multiplications:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">B</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]   -1    2
[2,]   -3    0
[3,]   -5    4</code></pre>
</div>
</div>
<p>Matrix multiplication is <strong>not commutative</strong>. In general, we have <span class="math inline">\(A B \neq B A\)</span>.</p>
<p><em>Example:</em> <span class="math display">\[
\begin{aligned}
    {A}{B} = \begin{pmatrix} 1 &amp; 2\\ 3 &amp; 4\end{pmatrix}
    \begin{pmatrix} 1 &amp; 1\\ 1 &amp; 2\end{pmatrix}
    &amp;=
    \begin{pmatrix} 3 &amp; 5\\ 7 &amp; 11\end{pmatrix}\,,\\
    {B}{A} = \begin{pmatrix} 1 &amp; 1\\ 1 &amp; 2\end{pmatrix}
    \begin{pmatrix} 1 &amp; 2\\ 3 &amp; 4\end{pmatrix}
    &amp;=
    \begin{pmatrix} 4 &amp; 6\\ 7 &amp; 10\end{pmatrix}\,.\end{aligned}
\]</span></p>
<p>Even if neither of the two matrices contains zeros, the matrix product can give the zero matrix: <span class="math display">\[
{A}{B} = \begin{pmatrix} 1 &amp; 2\\ 2 &amp; 4\end{pmatrix}
    \begin{pmatrix} 2 &amp; -4\\ -1 &amp; 2\end{pmatrix}
    =
    \begin{pmatrix} 0 &amp; 0\\ 0 &amp; 0\end{pmatrix}={0}.
\]</span></p>
<p>The following rules of calculation apply (provided the matrices are conformable): <span class="math display">\[
\begin{array}{rrcl@{}r@{}}
\text{(i)}   &amp; {A}({B}{C})       &amp; = &amp; ({A}{B}){C}\,    &amp;\text{(associativity)} \\
\text{(ii)}  &amp;   {A}({B}+{D})    &amp; = &amp; {A}{B}+{A}{D}\,  &amp; \text{(distributivity)} \\
\text{(iii)} &amp;   ({B}+{D}){C}    &amp; = &amp; {B}{C}+{D}{C}\,  &amp; \text{(distributivity)} \\
\text{(iv)}  &amp;   {A}(\lambda {B})&amp; = &amp; \lambda({A}{B})\,&amp; \text{(scalar commutativity)}\\
\text{(v)}   &amp; {A}{I}_{n}        &amp; = &amp; {A}\,            &amp; \text{(identity element)}\\
\text{(vi)}  &amp; {I}_{m}{A}        &amp; = &amp; {A}\,            &amp;
\text{(identity element)}     \\
\text{(vii)} &amp;   ({A}{B})'  &amp; = &amp; {B}'{A}'\,         &amp; \text{(product transposition)} \\
\text{(viii)}&amp;   ({A}{B} C)'  &amp; = &amp; C' {B}'{A}'\,  &amp; \text{(product transposition)}
\end{array}
\]</span></p>
</section></section><section id="rank-and-inverse" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="rank-and-inverse">
<span class="header-section-number">3.3</span> Rank and Inverse</h2>
<section id="linear-combination" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="linear-combination">
<span class="header-section-number">3.3.1</span> Linear Combination</h3>
<p>Let <span class="math inline">\(x_1, \ldots, x_n\)</span> be vectors of the same order, and let <span class="math inline">\(\lambda_1, \ldots, \lambda_n\)</span> be scalars. The vector <span class="math display">\[
\lambda_1 x_1 + \lambda_2 x_2 + \ldots + \lambda_n x_n
\]</span> is called <strong>linear combination</strong> of <span class="math inline">\(x_1, \ldots, x_n\)</span>. A linear combination can also be written as a matrix-vector product. Let <span class="math inline">\(X =\begin{pmatrix} x_1 &amp; \ldots &amp; x_n \end{pmatrix}\)</span> be the matrix with columns <span class="math inline">\(x_1, \ldots, x_n\)</span>, and let <span class="math inline">\(\lambda = (\lambda_1, \ldots, \lambda_n)'\)</span>. Then, <span class="math display">\[
\lambda_1 x_1 + \lambda_2 x_2 + \ldots + \lambda_n x_n = X \lambda.
\]</span> The vectors <span class="math inline">\(x_1, \ldots, x_n\)</span> are called <strong>linearly dependent</strong> if at least one can be written as a linear combination of the others. That is, there exists a nonzero vector <span class="math inline">\(\lambda\)</span> with <span class="math display">\[
X \lambda = \lambda_1 x_1 + \ldots + \lambda_n x_n = 0.
\]</span> The vectors <span class="math inline">\(x_1, \ldots, x_n\)</span> are called <strong>linearly independent</strong> if <span class="math display">\[
X \lambda = \lambda_1 x_1 + \ldots + \lambda_n x_n \neq 0
\]</span> for all nonzero vectors <span class="math inline">\(\lambda\)</span>.</p>
<p>To check whether the vectors are linearly independent, we can solve the system of equations <span class="math display">\[
X \lambda = 0
\]</span> by <a href="https://math.libretexts.org/Bookshelves/Algebra/Algebra_and_Trigonometry_1e_(OpenStax)/11%3A_Systems_of_Equations_and_Inequalities/11.06%3A_Solving_Systems_with_Gaussian_Elimination">Gaussian elimination</a>. If <span class="math inline">\(\lambda = 0\)</span> is the only solution, then the columns of <span class="math inline">\(X\)</span> are linearly independent. If there is a solution <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\lambda \neq 0\)</span>, then the columns of <span class="math inline">\(X\)</span> are linearly dependent.</p>
</section><section id="column-rank" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="column-rank">
<span class="header-section-number">3.3.2</span> Column Rank</h3>
<p>The <strong>rank</strong> of a <span class="math inline">\(k \times m\)</span> matrix <span class="math inline">\(A = \begin{pmatrix} a_1 &amp; \ldots &amp; a_m \end{pmatrix}\)</span>, written as <span class="math inline">\(\mathop{\mathrm{rank}}(A)\)</span>, is the number of linearly independent columns <span class="math inline">\(a_i\)</span>. We say that <span class="math inline">\(A\)</span> has <strong>full column rank</strong> if <span class="math inline">\(\mathop{\mathrm{rank}}(X) = m\)</span>.</p>
<p>The identity matrix <span class="math inline">\(I_k\)</span> has full column rank (i.e., <span class="math inline">\(\mathop{\mathrm{rank}}(I_n) = k\)</span>). As another example, consider <span class="math display">\[
X = \begin{pmatrix} 2 &amp; 1 &amp; 4 \\ 0 &amp; 1 &amp; 2 \end{pmatrix},
\]</span> which has linearly dependent columns since the third column is a linear combination of the first two columns: <span class="math display">\[
\begin{align*}
&amp;\qquad\qquad\begin{pmatrix} 4 \\ 2 \end{pmatrix} = 1 \begin{pmatrix} 2 \\ 0 \end{pmatrix} + 2 \begin{pmatrix} 1 \\ 1 \end{pmatrix}\\
&amp;\Leftrightarrow\quad - 1 \begin{pmatrix} 2 \\ 0 \end{pmatrix} - 2 \begin{pmatrix} 1 \\ 1 \end{pmatrix} + \begin{pmatrix} 4 \\ 2 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}\\
&amp;\Leftrightarrow\quad\begin{pmatrix} 2&amp;1&amp;4 \\ 0&amp;1&amp;2 \end{pmatrix} \begin{pmatrix} -1 \\ -2\\1 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}\\
\end{align*}
\]</span></p>
<p>However, the first two columns are linearly independent since <span class="math inline">\(\lambda_1 = 0\)</span> and <span class="math inline">\(\lambda_2 = 0\)</span> are the only solutions to the equation <span class="math display">\[
\lambda_1 \begin{pmatrix} 2 \\ 0 \end{pmatrix} + \lambda_2 \begin{pmatrix} 1 \\ 1 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}.
\]</span> Therefore, we have <span class="math inline">\(\mathop{\mathrm{rank}}(X) = 2\)</span>, i.e., <span class="math inline">\(X\)</span> does not have a full column rank.</p>
<p>Some useful properties are</p>
<ol type="i">
<li><span class="math inline">\(\mathop{\mathrm{rank}}(A) \leq \min(k,m)\)</span></li>
<li><span class="math inline">\(\mathop{\mathrm{rank}}(A) = \mathop{\mathrm{rank}}(A')\)</span></li>
<li><span class="math inline">\(\mathop{\mathrm{rank}}(A B) = \min(\mathop{\mathrm{rank}}(A), \mathop{\mathrm{rank}}(B))\)</span></li>
<li>
<span class="math inline">\(\mathop{\mathrm{rank}}(A) = \mathop{\mathrm{rank}}(A' A) = \mathop{\mathrm{rank}}(A A')\)</span>.</li>
</ol>
<p>We can use the <code><a href="https://rdrr.io/r/base/qr.html">qr()</a></code> function to extract the rank in <code>R</code>. Let’s compute the rank of the matrices <span class="math display">\[
A = \begin{pmatrix}
1 &amp; 2 &amp; 3 \\ 3 &amp; 9 &amp; 1 \\ 0 &amp; 11 &amp; 5
\end{pmatrix},
\]</span> <span class="math inline">\(B = I_3\)</span>, and <span class="math inline">\(X\)</span> from the example above:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">9</span>,<span class="fl">11</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">X</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/qr.html">qr</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">$</span><span class="va">rank</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</section><section id="nonsingular-matrix" class="level3" data-number="3.3.3"><h3 data-number="3.3.3" class="anchored" data-anchor-id="nonsingular-matrix">
<span class="header-section-number">3.3.3</span> Nonsingular Matrix</h3>
<p>A square <span class="math inline">\(k \times k\)</span> matrix <span class="math inline">\(A\)</span> is called <strong>nonsingular</strong> if it has full rank, i.e., <span class="math display">\[
\mathop{\mathrm{rank}}(A) = k.
\]</span> Conversely, <span class="math inline">\(A\)</span> is called <strong>singular</strong> if it does not have full rank, i.e., <span class="math display">\[
\mathop{\mathrm{rank}}(A) &lt; k.
\]</span></p>
</section><section id="determinant" class="level3" data-number="3.3.4"><h3 data-number="3.3.4" class="anchored" data-anchor-id="determinant">
<span class="header-section-number">3.3.4</span> Determinant</h3>
<p>Consider a square <span class="math inline">\(k \times k\)</span> matrix <span class="math inline">\(A\)</span>. The determinant <span class="math inline">\(\det(A)\)</span> is a measure of the volume of the geometric object formed by the columns of <span class="math inline">\(A\)</span> (a parallelogram for <span class="math inline">\(k=2\)</span>, a parallelepiped for <span class="math inline">\(k=3\)</span>, a hyper-parallelepiped for <span class="math inline">\(k&gt;3\)</span>). For <span class="math inline">\(2 \times 2\)</span> matrices, the determinant is easy to calculate: <span class="math display">\[
A = \begin{pmatrix} a &amp; b \\ c &amp; d \end{pmatrix}, \quad
\det(A) = ad - bc.
\]</span></p>
<p>If <span class="math inline">\(A\)</span> is triangular (upper or lower), the determinant is the product of the diagonal entries, i.e., <span class="math inline">\(\det(A) = \prod_{i=1}^k a_{ii}\)</span>. Hence, <a href="https://math.libretexts.org/Bookshelves/Algebra/Algebra_and_Trigonometry_1e_(OpenStax)/11%3A_Systems_of_Equations_and_Inequalities/11.06%3A_Solving_Systems_with_Gaussian_Elimination">Gaussian elimination</a> can be used to compute the determinant by transforming the matrix to a triangular one. The exact definition of the determinant is technical and of little importance to us. A useful relation is the following: <span class="math display">\[
\begin{align*}
  \det(A) = 0 \quad &amp;\Leftrightarrow \quad A \ \text{is singular} \\
   \det(A) \neq 0 \quad &amp;\Leftrightarrow \quad A \ \text{is nonsingular}.
\end{align*}
\]</span></p>
<p>In <code>R</code>, we have the <code><a href="https://rdrr.io/r/base/det.html">det()</a></code> function to compute the determinant:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/det.html">det</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 103</code></pre>
</div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/det.html">det</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>Since <span class="math inline">\(\det(A) \neq 0\)</span> and <span class="math inline">\(\det(B) = 0\)</span>, we conclude that <span class="math inline">\(A\)</span> is nonsingular and <span class="math inline">\(B\)</span> is singular.</p>
</section><section id="inverse-matrix" class="level3" data-number="3.3.5"><h3 data-number="3.3.5" class="anchored" data-anchor-id="inverse-matrix">
<span class="header-section-number">3.3.5</span> Inverse Matrix</h3>
<p>The <strong>inverse</strong> <span class="math inline">\({A}^{-1}\)</span> of a square <span class="math inline">\(k \times k\)</span> matrix <span class="math inline">\(A\)</span> is defined by the property <span class="math display">\[{A} {A}^{-1} = {A}^{-1} {A} ={I}_k.\]</span> When multiplied from the left or the right, the inverse matrix produces the identity matrix. The inverse exists if and only if <span class="math inline">\({A}\)</span> is nonsingular, i.e., <span class="math inline">\(\det(A) \neq 0\)</span>. Therefore, a nonsingular matrix is also called <strong>invertible matrix</strong>. Note that only square matrices can be inverted.</p>
<p>For <span class="math inline">\(2 \times 2\)</span> matrices, there exists a simple formula: <span class="math display">\[{A}^{-1} = \frac{1}{\det({A})} \begin{pmatrix}d&amp;-b\\-c&amp;a\end{pmatrix}\,,\]</span> where <span class="math inline">\(\det({A}) = ad - bc\)</span>. We swap the main diagonal elements, reverse the sign of the off-diagonal elements, and divide all entries by the determinant. <em>Example:</em> <span class="math display">\[\displaystyle{A}=\begin{pmatrix}5&amp;6\\1&amp;2\end{pmatrix}\]</span> We have <span class="math inline">\(\det({A}) = ad-bc=5\cdot2-6\cdot1=4\)</span>, and <span class="math display">\[{A}^{-1}= \frac{1}{4} \cdot \begin{pmatrix}2&amp;-6\\-1&amp;5\end{pmatrix}.\]</span> Indeed, <span class="math inline">\(A^{-1}\)</span> is the inverse of <span class="math inline">\(A\)</span> since <span class="math display">\[{A}{A}^{-1}
=\begin{pmatrix}5&amp;6\\1&amp;2\end{pmatrix} \cdot \frac{1}{4} \cdot \begin{pmatrix}2&amp;-6\\-1&amp;5\end{pmatrix}
=\frac{1}{4} \cdot \begin{pmatrix}4&amp;0\\0&amp;4\end{pmatrix}
= \left(\begin{matrix}1 &amp; 0 \\ 0 &amp; 1 \end{matrix}\right)
= {I}_2.\]</span></p>
<p>One way to calculate the inverse of higher order square matrices is to solve equation <span class="math inline">\(A A^{-1} = I\)</span> with Gaussian elimination. <code>R</code> can compute the inverse matrix quickly using the function <code><a href="https://rdrr.io/r/base/solve.html">solve()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="co">#inverse if A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]        [,2]        [,3]
[1,]  0.3300971  0.22330097 -0.24271845
[2,] -0.1456311  0.04854369  0.07766990
[3,]  0.3203883 -0.10679612  0.02912621</code></pre>
</div>
</div>
<p>We have the following relationship between invertibility, rank, and determinant of a square matrix <span class="math inline">\(A\)</span>:</p>
<span class="math display">\[\begin{align*}
  &amp;A \ \text{is nonsingular} \\
  \Leftrightarrow \quad &amp;\text{all columns of} \ A \ \text{are linearly independent} \\
  \Leftrightarrow \quad &amp;A \ \text{has full column rank} \\
  \Leftrightarrow \quad &amp;\text{the determinant is nonzero} \ (\det(A) \neq 0).
\end{align*}\]</span>
<p>Similarly, <span class="math display">\[
\begin{align*}
  &amp;A \ \text{is singular} \\
  \Leftrightarrow \quad &amp;A \ \text{has linearly dependent columns} \\
  \Leftrightarrow \quad &amp;A \ \text{does not have full rank} \\
  \Leftrightarrow \quad &amp;\text{the determinant is zero} \ (\det(A) = 0).
\end{align*}
\]</span></p>
<p>Below you will find some important properties for nonsingular matrices:</p>
<ol type="i">
<li><span class="math inline">\(({A}^{-1})^{-1} = {A}\)</span></li>
<li><span class="math inline">\(({A}')^{-1} = ({A}^{-1})'\)</span></li>
<li>
<span class="math inline">\((\lambda{A})^{-1} = \frac{1}{\lambda}{A}^{-1}\)</span> for any <span class="math inline">\(\lambda \neq 0\)</span>
</li>
<li><span class="math inline">\(\det(A^{-1}) = \frac{1}{\det(A)}\)</span></li>
<li><span class="math inline">\(({A} {B})^{-1} = {B}^{-1} {A}^{-1}\)</span></li>
<li><span class="math inline">\((A B C)^{-1} = C^{-1} B^{-1} A^{-1}\)</span></li>
<li>If <span class="math inline">\({A}\)</span> is symmetric, then <span class="math inline">\({A}^{-1}\)</span> is symmetric.</li>
</ol></section></section><section id="further-concepts" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="further-concepts">
<span class="header-section-number">3.4</span> Further Concepts</h2>
<section id="trace" class="level3" data-number="3.4.1"><h3 data-number="3.4.1" class="anchored" data-anchor-id="trace">
<span class="header-section-number">3.4.1</span> Trace</h3>
<p>The <strong>trace</strong> of a <span class="math inline">\(k \times k\)</span> square matrix <span class="math inline">\(A\)</span> is the sum of the diagonal entries: <span class="math display">\[\mathop{\mathrm{tr}}(A) = \sum_{i=1}^n a_{ii}\]</span> <em>Example:</em> <span class="math display">\[
A = \begin{pmatrix}
1 &amp; 2 &amp; 3 \\ 3 &amp; 9 &amp; 1 \\ 0 &amp; 11 &amp; 5
\end{pmatrix} \quad \Rightarrow \quad \mathop{\mathrm{tr}}(A) = 1+9+5 = 15
\]</span> In <code>R</code>we have</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">9</span>,<span class="fl">11</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span>  <span class="co">#trace = sum of diagonal entries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
</div>
<p>The following properties hold for square matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and scalars <span class="math inline">\(\lambda\)</span>:</p>
<ol type="i">
<li><span class="math inline">\(\mathop{\mathrm{tr}}(\lambda A) = \lambda \mathop{\mathrm{tr}}(A)\)</span></li>
<li><span class="math inline">\(\mathop{\mathrm{tr}}(A + B) = \mathop{\mathrm{tr}}(A) + \mathop{\mathrm{tr}}(B)\)</span></li>
<li><span class="math inline">\(\mathop{\mathrm{tr}}(A') = \mathop{\mathrm{tr}}(A)\)</span></li>
<li><span class="math inline">\(\mathop{\mathrm{tr}}(I_k) = k\)</span></li>
</ol>
<p>For <span class="math inline">\(A\in \mathbb R^{k \times m}\)</span> and <span class="math inline">\(B \in \mathbb R^{m \times k}\)</span> we have <span class="math display">\[
\mathop{\mathrm{tr}}(A B) = \mathop{\mathrm{tr}}(B A).
\]</span></p>
</section><section id="idempotent-matrix" class="level3" data-number="3.4.2"><h3 data-number="3.4.2" class="anchored" data-anchor-id="idempotent-matrix">
<span class="header-section-number">3.4.2</span> Idempotent Matrix</h3>
<p>The square matrix <span class="math inline">\(A\)</span> is called <strong>idempotent</strong> if <span class="math inline">\(A A = A\)</span>. The identity matrix is idempotent: <span class="math inline">\(I_n I_n = I_n\)</span>. Another example is the matrix <span class="math display">\[
A = \begin{pmatrix}
4 &amp; -1 \\ 12 &amp; -3
\end{pmatrix}.
\]</span> We have <span class="math display">\[
\begin{align*}
A A
&amp;= \begin{pmatrix}
4 &amp; -1 \\ 12 &amp; -3
\end{pmatrix}
\begin{pmatrix}
4 &amp; -1 \\ 12 &amp; -3
\end{pmatrix} \\
&amp;= \begin{pmatrix}
16-12 &amp; -4+3 \\ 48-36 &amp; -12+9
\end{pmatrix} \\
&amp;= \begin{pmatrix}
4 &amp; -1 \\ 12 &amp; -3
\end{pmatrix}
= A.
\end{align*}
\]</span></p>
</section><section id="definite-matrix" class="level3" data-number="3.4.3"><h3 data-number="3.4.3" class="anchored" data-anchor-id="definite-matrix">
<span class="header-section-number">3.4.3</span> Definite Matrix</h3>
<p>The <span class="math inline">\(k \times k\)</span> square matrix <span class="math inline">\({A}\)</span> is called <strong>positive definite</strong> if <span class="math display">\[{c}'{Ac}&gt;0\]</span> holds for all nonzero vectors <span class="math inline">\({c}\in \mathbb{R}^k\)</span>. If <span class="math display">\[{c}'{Ac}\geq 0\]</span></p>
<p>for all vectors <span class="math inline">\({c}\in \mathbb{R}^k\)</span>, the matrix is called <strong>positive semi-definite</strong>. Analogously, <span class="math inline">\(A\)</span> is called <strong>negative definite</strong> if <span class="math inline">\({c}'{Ac}&lt;0\)</span> and <strong>negative semi-definite</strong> if <span class="math inline">\({c}'{Ac}\leq 0\)</span> for all nonzero vectors <span class="math inline">\(c \in \mathbb R^k\)</span>. A matrix that is neither positive semi-definite nor negative semi-definite is called <strong>indefinite</strong></p>
<p>The matrix analog of a positive or negative number (scalar) is a positive definite or negative definite matrix. Therefore, we use the notation</p>
<ol type="i">
<li>
<span class="math inline">\(A &gt; 0\)</span> &nbsp;if <span class="math inline">\(A\)</span> is positive definite</li>
<li>
<span class="math inline">\(A &lt; 0\)</span> &nbsp;if <span class="math inline">\(A\)</span> is negative definite</li>
<li>
<span class="math inline">\(A \geq 0\)</span> &nbsp;if <span class="math inline">\(A\)</span> is positive semi-definite</li>
<li>
<span class="math inline">\(A \leq 0\)</span> &nbsp;if <span class="math inline">\(A\)</span> is negative semi-definite</li>
</ol>
<p>The notation <span class="math inline">\(A &gt; B\)</span> means that the matrix <span class="math inline">\(A - B\)</span> is positive definite.</p>
</section></section><section id="advanced-concepts" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="advanced-concepts">
<span class="header-section-number">3.5</span> Advanced Concepts</h2>
<section id="eigendecomposition" class="level3" data-number="3.5.1"><h3 data-number="3.5.1" class="anchored" data-anchor-id="eigendecomposition">
<span class="header-section-number">3.5.1</span> Eigendecomposition</h3>
<section id="eigenvalues" class="level4" data-number="3.5.1.1"><h4 data-number="3.5.1.1" class="anchored" data-anchor-id="eigenvalues">
<span class="header-section-number">3.5.1.1</span> Eigenvalues</h4>
<p>An <strong>eigenvalue</strong> <span class="math inline">\(\lambda\)</span> of a <span class="math inline">\(k \times k\)</span> square matrix is a solution to the equation <span class="math display">\[
  \det(\lambda I_k - A) = 0.
\]</span> The function <span class="math inline">\(f(\lambda) = \det(\lambda I_k - A)\)</span> has exactly <span class="math inline">\(k\)</span> roots so that <span class="math inline">\(\det(\lambda I_k - A) = 0\)</span> has exactly <span class="math inline">\(k\)</span> solutions. The solutions <span class="math inline">\(\lambda_1, \ldots, \lambda_k\)</span> are the <span class="math inline">\(k\)</span> eigenvalues of <span class="math inline">\(A\)</span>.</p>
<p>Most applications of eigenvalues in econometrics concern symmetric matrices. In this case, all eigenvalues are real-valued. In the case of non-symmetric matrices, some eigenvalues may be complex-valued.</p>
<p>Useful properties of the eigenvalues of a symmetric <span class="math inline">\(k \times k\)</span> matrix are:</p>
<ol type="i">
<li><span class="math inline">\(\det(A) = \lambda_1 \cdot \ldots \cdot \lambda_k\)</span></li>
<li><span class="math inline">\(\mathop{\mathrm{tr}}(A) = \lambda_1 + \ldots + \lambda_k\)</span></li>
<li>
<span class="math inline">\(A\)</span> is nonsingular if and only if all eigenvalues are nonzero</li>
<li>
<span class="math inline">\(A B\)</span> and <span class="math inline">\(B A\)</span> have the same eigenvalues.</li>
</ol></section><section id="eigenvectors" class="level4" data-number="3.5.1.2"><h4 data-number="3.5.1.2" class="anchored" data-anchor-id="eigenvectors">
<span class="header-section-number">3.5.1.2</span> Eigenvectors</h4>
<p>If <span class="math inline">\(\lambda_i\)</span> is an eigenvalue of <span class="math inline">\(A\)</span>, then <span class="math inline">\(\lambda_i I_k - A\)</span> is singular, which implies that there exists a linear combination vector <span class="math inline">\(v_i\)</span> with <span class="math inline">\((\lambda_i I_k - A) v_i = 0\)</span>. Equivalently, <span class="math display">\[
A v_i = \lambda_i v_i,
\]</span></p>
<p>which can be solved by Gaussian elimination. It is convenient to normalize any solution such that <span class="math inline">\(v_i'v_i = 1\)</span>. The solutions <span class="math inline">\(v_1, \ldots, v_k\)</span> are called eigenvectors of <span class="math inline">\(A\)</span> to corresponding eigenvalues <span class="math inline">\(\lambda_1, \ldots, \lambda_k\)</span>.</p>
</section><section id="spectral-decomposition" class="level4" data-number="3.5.1.3"><h4 data-number="3.5.1.3" class="anchored" data-anchor-id="spectral-decomposition">
<span class="header-section-number">3.5.1.3</span> Spectral Decomposition</h4>
<p>If <span class="math inline">\(A\)</span> is symmetric, then <span class="math inline">\(v_1, \ldots, v_k\)</span> are pairwise orthogonal (i.e., <span class="math inline">\(v_i' v_j = 0\)</span> for <span class="math inline">\(i \neq j\)</span>). Let <span class="math inline">\(V = \begin{pmatrix} v_1 &amp; \ldots &amp; v_k \end{pmatrix}\)</span> be the <span class="math inline">\(k \times k\)</span> matrix of eigenvectors and let <span class="math inline">\(\Lambda = \mathop{\mathrm{diag}}(\lambda_1, \ldots, \lambda_k)\)</span> be the <span class="math inline">\(k \times k\)</span> diagonal matrix with the eigenvalues on the main diagonal. Then, we can write <span class="math display">\[
  A = V \Lambda V',
\]</span> which is called the <strong>spectral decomposition</strong> of <span class="math inline">\(A\)</span>. The matrix of eigenvalues can be written as <span class="math inline">\(\Lambda = V' A V\)</span>.</p>
</section><section id="eigendecomposition-in-r" class="level4" data-number="3.5.1.4"><h4 data-number="3.5.1.4" class="anchored" data-anchor-id="eigendecomposition-in-r">
<span class="header-section-number">3.5.1.4</span> Eigendecomposition in <code>R</code>
</h4>
<p>The function <code><a href="https://rdrr.io/r/base/eigen.html">eigen()</a></code> computes the eigenvalues and corresponding eigenvectors.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">B</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="va">A</span> </span>
<span><span class="va">B</span> <span class="co">#A'A is symmetric</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]   10   29    6
[2,]   29  206   70
[3,]    6   70   35</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="co">#eigenvalues and eigenvector matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eigen() decomposition
$values
[1] 234.827160  12.582227   3.590613

$vectors
           [,1]       [,2]       [,3]
[1,] -0.1293953 -0.5312592  0.8372697
[2,] -0.9346164 -0.2167553 -0.2819739
[3,] -0.3312839  0.8190121  0.4684764</code></pre>
</div>
</div>
</section></section><section id="definiteness-property-and-eigenvalues" class="level3" data-number="3.5.2"><h3 data-number="3.5.2" class="anchored" data-anchor-id="definiteness-property-and-eigenvalues">
<span class="header-section-number">3.5.2</span> Definiteness Property and Eigenvalues</h3>
<p>The definiteness property of a symmetric matrix <span class="math inline">\(A\)</span> can be determined using its eigenvalues:</p>
<ol type="i">
<li>
<span class="math inline">\(A\)</span> is positive definite &nbsp;<span class="math inline">\(\Leftrightarrow\)</span> &nbsp;all eigenvalues of <span class="math inline">\(A\)</span> are strictly positive</li>
<li>
<span class="math inline">\(A\)</span> is negative definite &nbsp;<span class="math inline">\(\Leftrightarrow\)</span> &nbsp; all eigenvalues of <span class="math inline">\(A\)</span> are strictly negative</li>
<li>
<span class="math inline">\(A\)</span> is positive semi-definite &nbsp;<span class="math inline">\(\Leftrightarrow\)</span> &nbsp; all eigenvalues of <span class="math inline">\(A\)</span> are non-negative</li>
<li>
<span class="math inline">\(A\)</span> is negative semi-definite &nbsp;<span class="math inline">\(\Leftrightarrow\)</span> &nbsp; all eigenvalues of <span class="math inline">\(A\)</span> are non-positive</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">values</span> <span class="co">#B is positive definite (all eigenvalues positive)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 234.827160  12.582227   3.590613</code></pre>
</div>
</div>
</section><section id="cholesky-decomposition" class="level3" data-number="3.5.3"><h3 data-number="3.5.3" class="anchored" data-anchor-id="cholesky-decomposition">
<span class="header-section-number">3.5.3</span> Cholesky Decomposition</h3>
<p>Any positive definite and symmetric matrix <span class="math inline">\(B\)</span> can be written as <span class="math display">\[
  B = P P',
\]</span> where <span class="math inline">\(P\)</span> is a lower triangular matrix with strictly positive diagonal entries <span class="math inline">\(p_{jj} &gt; 0\)</span>. This representation is called <strong>Cholesky decomposition</strong>. The matrix <span class="math inline">\(P\)</span> is unique. For a <span class="math inline">\(2 \times 2\)</span> matrix <span class="math inline">\(B\)</span> we have <span class="math display">\[
\begin{align*}
\begin{pmatrix} b_{11} &amp; b_{12} \\ b_{21} &amp; b_{22} \end{pmatrix}
&amp;= \begin{pmatrix} p_{11} &amp; 0 \\ p_{21} &amp; p_{22} \end{pmatrix}
\begin{pmatrix} p_{11} &amp; p_{21} \\ 0 &amp; p_{22} \end{pmatrix} \\
&amp;= \begin{pmatrix} p_{11}^2 &amp; p_{11} p_{21} \\ p_{11} p_{21} &amp; p_{21}^2 + p_{22}^2 \end{pmatrix},
\end{align*}
\]</span> which implies <span class="math inline">\(p_{11} = \sqrt{b_{11}}\)</span>, <span class="math inline">\(p_{21} = b_{21}/p_{11}\)</span>, and <span class="math inline">\(p_{22} = \sqrt{b_{22} - p_{21}^2}\)</span>. For a <span class="math inline">\(3 \times 3\)</span> matrix we obtain <span class="math display">\[
\begin{align*}
\begin{pmatrix} b_{11} &amp; b_{12} &amp; b_{31} \\ b_{21} &amp; b_{22} &amp; b_{23} \\ b_{31} &amp; b_{32} &amp; b_{33} \end{pmatrix}
= \begin{pmatrix} p_{11} &amp; 0 &amp; 0 \\ p_{21} &amp; p_{22} &amp; 0 \\ p_{31} &amp; p_{32} &amp; p_{33} \end{pmatrix}
\begin{pmatrix} p_{11} &amp; p_{21} &amp; p_{31} \\ 0 &amp; p_{22} &amp; p_{32} \\ 0 &amp; 0 &amp; p_{33}\end{pmatrix} \\
= \begin{pmatrix} p_{11}^2 &amp; p_{11} p_{21} &amp; p_{11} p_{31} \\ p_{11} p_{21} &amp; p_{21}^2 + p_{22}^2 &amp; p_{21} p_{31} + p_{22} p_{32} \\ p_{11}p_{31} &amp; p_{21}p_{31} + p_{22}p_{32} &amp; p_{31}^2 + p_{32}^2  + p_{33}^2\end{pmatrix},
\end{align*}
\]</span> which implies</p>
<span class="math display">\[\begin{gather*}
p_{11}=\sqrt{b_{11}}, \ \ p_{21} = \frac{b_{21}}{p_{11}}, \ \ p_{31} = \frac{b_{31}}{p_{11}}, \ \ p_{22} = \sqrt{b_{22}-p_{21}^2}, \\
p_{32}= \frac{b_{32}-p_{21}p_{31}}{p_{22}}, \ \ p_{33} = \sqrt{b_{33} - p_{31}^2 - p_{32}^2}.
\end{gather*}\]</span>
<p>Let’s compute the Cholesky decomposition of <span class="math display">\[
B = \begin{pmatrix} 1 &amp; -0.5 &amp; 0.6 \\ -0.5 &amp; 1 &amp; 0.25 \\ 0.6 &amp; 0.25 &amp; 1 \end{pmatrix}
\]</span> using the <code>R</code> function <code><a href="https://rdrr.io/r/base/chol.html">chol()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0.25</span>, <span class="fl">0.6</span>, <span class="fl">0.25</span>, <span class="fl">1</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/chol.html">chol</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]       [,2]      [,3]
[1,]    1 -0.5000000 0.6000000
[2,]    0  0.8660254 0.6350853
[3,]    0  0.0000000 0.4864840</code></pre>
</div>
</div>
</section><section id="vectorization" class="level3" data-number="3.5.4"><h3 data-number="3.5.4" class="anchored" data-anchor-id="vectorization">
<span class="header-section-number">3.5.4</span> Vectorization</h3>
<p>The <strong>vectorization operator</strong> <span class="math inline">\(\mathop{\mathrm{vec}}()\)</span> stacks the matrix entries column-wise into a large vector. The vectorized <span class="math inline">\(k \times m\)</span> matrix <span class="math inline">\(A\)</span> is the <span class="math inline">\(km \times 1\)</span> vector <span class="math display">\[
\mathop{\mathrm{vec}}(A) = (a_{11}, \ldots, a_{k1}, a_{12}, \ldots, a_{k2}, \ldots, a_{1m}, \ldots, a_{km})'.
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="co">#vectorize the matrix A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  3  0  2  9 11  3  1  5</code></pre>
</div>
</div>
</section><section id="kronecker-product" class="level3" data-number="3.5.5"><h3 data-number="3.5.5" class="anchored" data-anchor-id="kronecker-product">
<span class="header-section-number">3.5.5</span> Kronecker Product</h3>
<p>The <strong>Kronecker product</strong> <span class="math inline">\(\otimes\)</span> multiplies each element of the left-hand side matrix with the entire matrix on the right-hand side. For a <span class="math inline">\(k \times m\)</span> matrix <span class="math inline">\(A\)</span> and a <span class="math inline">\(r \times s\)</span> matrix <span class="math inline">\(B\)</span>, we get the <span class="math inline">\(kr\times ms\)</span> matrix <span class="math display">\[
A \otimes B = \begin{pmatrix} a_{11}B &amp; \ldots &amp; a_{1m}B \\ \vdots &amp; &amp; \vdots \\ a_{k1}B &amp; \ldots &amp; a_{km}B \end{pmatrix},
\]</span> where each entry <span class="math inline">\(a_{ij} B\)</span> is a <span class="math inline">\(r \times s\)</span> matrix.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">A</span> <span class="op"><a href="https://rdrr.io/r/base/kronecker.html">%x%</a></span> <span class="va">B</span> <span class="co">#Kronecker product in R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]  [,2] [,3] [,4]  [,5]  [,6] [,7]  [,8] [,9]
 [1,]  1.0 -0.50 0.60  2.0 -1.00  1.20  3.0 -1.50 1.80
 [2,] -0.5  1.00 0.25 -1.0  2.00  0.50 -1.5  3.00 0.75
 [3,]  0.6  0.25 1.00  1.2  0.50  2.00  1.8  0.75 3.00
 [4,]  3.0 -1.50 1.80  9.0 -4.50  5.40  1.0 -0.50 0.60
 [5,] -1.5  3.00 0.75 -4.5  9.00  2.25 -0.5  1.00 0.25
 [6,]  1.8  0.75 3.00  5.4  2.25  9.00  0.6  0.25 1.00
 [7,]  0.0  0.00 0.00 11.0 -5.50  6.60  5.0 -2.50 3.00
 [8,]  0.0  0.00 0.00 -5.5 11.00  2.75 -2.5  5.00 1.25
 [9,]  0.0  0.00 0.00  6.6  2.75 11.00  3.0  1.25 5.00</code></pre>
</div>
</div>
</section><section id="vector-and-matrix-norm" class="level3" data-number="3.5.6"><h3 data-number="3.5.6" class="anchored" data-anchor-id="vector-and-matrix-norm">
<span class="header-section-number">3.5.6</span> Vector and Matrix Norm</h3>
<p>A norm <span class="math inline">\(\|\cdot\|\)</span> of a vector or a matrix is a measure of distance from the origin. The most commonly used norms are the Euclidean vector norm <span class="math display">\[
  \|a\| = \sqrt{a' a} = \sqrt{\sum_{i=1}^k a_i^2}
\]</span> for <span class="math inline">\(a \in \mathbb R^k\)</span>, and the Frobenius matrix norm <span class="math display">\[
  \|A \| = \sqrt{\sum_{i=1}^k \sum_{j=1}^m a_{ij}^2}
\]</span> for <span class="math inline">\(A \in \mathbb R^{k \times m}\)</span>.</p>
<p>A norm satisfies the following properties:</p>
<ol type="i">
<li>
<span class="math inline">\(\|\lambda A\| = |\lambda| \|A\|\)</span> for any scalar <span class="math inline">\(\lambda\)</span> (absolute homogeneity)</li>
<li>
<span class="math inline">\(\|A + B\| \leq \|A\| + \|B\|\)</span> (triangle inequality)</li>
<li>
<span class="math inline">\(\|A\| = 0\)</span> implies <span class="math inline">\(A = 0\)</span> (definiteness)</li>
</ol></section></section><section id="matrix-calculus" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="matrix-calculus">
<span class="header-section-number">3.6</span> Matrix Calculus</h2>
<p>Let <span class="math inline">\(f(\beta_1, \ldots, \beta_k) = f({\beta})\)</span> be a twice-differential real-valued function that depends on some vector <span class="math inline">\(\beta = (\beta_1, \ldots, \beta_k)'\)</span>. Examples that frequently appear in econometrics are functions of the inner product form <span class="math inline">\(f(\beta) = a' \beta\)</span>, where <span class="math inline">\(a \in \mathbb R^k\)</span>, and functions of the sandwich form <span class="math inline">\(f(\beta) = \beta' A \beta\)</span>, where <span class="math inline">\(A \in \mathbb R^{k \times k}\)</span>.</p>
<section id="gradient" class="level3" data-number="3.6.1"><h3 data-number="3.6.1" class="anchored" data-anchor-id="gradient">
<span class="header-section-number">3.6.1</span> Gradient</h3>
<p>The <strong>first derivatives vector</strong> or <strong>gradient</strong> is <span class="math display">\[
\frac{\partial f(\beta)}{\partial{\beta}}  = \begin{pmatrix}\frac{\partial f(\beta)}{\partial \beta_1} \\ \vdots \\ \frac{\partial f(\beta)}{\partial \beta_k} \end{pmatrix}
\]</span> If the gradient is evaluated at some particular value <span class="math inline">\(\beta = b\)</span>, we write <span class="math display">\[
\frac{\partial f}{\partial{\beta}}(b)
\]</span> Useful properties for inner product and sandwich forms are <span class="math display">\[
\begin{align*}
(i)&amp; \quad &amp;&amp;\frac{\partial (a' \beta)}{\partial \beta}  = a \\
(ii)&amp; \quad &amp;&amp;\frac{\partial ( \beta' A \beta)}{\partial \beta}   = (A + A') \beta.
\end{align*}
\]</span></p>
</section><section id="hessian" class="level3" data-number="3.6.2"><h3 data-number="3.6.2" class="anchored" data-anchor-id="hessian">
<span class="header-section-number">3.6.2</span> Hessian</h3>
<p>The <strong>second derivatives matrix</strong> or <strong>Hessian</strong> is the <span class="math inline">\(k \times k\)</span> matrix <span class="math display">\[
    \frac{\partial^2 f(\beta)}{\partial{\beta }\partial {\beta}'}
    =  \begin{pmatrix}\frac{\partial^2 f(\beta)}{\partial \beta_1 \partial \beta_1} &amp; \ldots &amp; \frac{\partial^2 f(\beta)}{\partial \beta_k \partial \beta_1} \\
    \vdots &amp; &amp; \vdots \\
    \frac{\partial^2 f(\beta)}{\partial \beta_1 \partial \beta_k} &amp; \ldots &amp; \frac{\partial^2 f(\beta)}{\partial \beta_k \partial \beta_k}
    \end{pmatrix}.
\]</span></p>
<p>If the Hessian is evaluated at some particular value <span class="math inline">\(\beta = b\)</span>, we write <span class="math display">\[
\frac{\partial^2 f}{\partial{\beta }\partial {\beta}'}(b)
\]</span></p>
<p>The Hessian is symmetric. Each column of the Hessian is the derivative of the components of the gradient for the corresponding variable in <span class="math inline">\(\beta'\)</span>:</p>
<span class="math display">\[\begin{align*}
\frac{\partial^2 f(\beta)}{\partial{\beta }\partial {\beta}'}
    &amp;= \frac{\partial(\partial f(\beta)/\partial \beta)}{\partial \beta'} \\
    &amp;= \Bigg[ \frac{\partial(\partial f(\beta)/\partial \beta)}{\partial \beta_1} \ \frac{\partial(\partial f(\beta)/\partial \beta)}{\partial \beta_2} \ \ldots \ \frac{\partial(\partial f(\beta)/\partial \beta)}{\partial \beta_n} \Bigg]
\end{align*}\]</span>
<p>The Hessian of a sandwich form function is <span class="math display">\[
  \frac{\partial^2 ( \beta' A \beta)}{\partial \beta \partial \beta'}  = A + A'.
\]</span></p>
</section><section id="optimization" class="level3" data-number="3.6.3"><h3 data-number="3.6.3" class="anchored" data-anchor-id="optimization">
<span class="header-section-number">3.6.3</span> Optimization</h3>
<p>Recall the <em>first-order</em> (necessary) and <em>second-order</em> (sufficient) conditions for optimum (maximum or minimum) in the univariate case:</p>
<ul>
<li>
<strong>First-order condition</strong>: the first derivative evaluated at the optimum is zero.</li>
<li>
<strong>Second-order condition</strong>: the second derivative at the optimum is negative for a maximum and positive for a minimum.</li>
</ul>
<p>Similarly, we formulate first and second-order conditions for a function <span class="math inline">\(f(\beta)\)</span>. The <strong>first-order condition</strong> for an optimum (maximum or minimum) at <span class="math inline">\(b\)</span> is <span class="math display">\[
\frac{\partial f}{\partial{\beta}}(b)  = 0.
\]</span> The <strong>second-order condition</strong> is <span class="math display">\[
\begin{align*}
  &amp;\frac{\partial^2 f}{\partial{\beta }\partial {\beta}'}(b) &gt; 0 \quad \text{for a minimum at} \ b, \\
  &amp;\frac{\partial^2 f}{\partial{\beta }\partial {\beta}'}(b) &lt; 0 \quad \text{for a maximum at} \ b.
\end{align*}
\]</span> Recall that, in the context of matrices, the notation “<span class="math inline">\(&gt; 0\)</span>” means positive definite, and “<span class="math inline">\(&lt; 0\)</span>” means negative definite.</p>
</section></section><section id="exercises" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">3.7</span> Exercises</h2>
<ul>
<li><a href="https://www.dropbox.com/scl/fi/sjw21fv8ezcc4jouval88/Ch3_Exercises1.pdf?rlkey=wym3kvepow3ugex0p82scjkkq&amp;dl=0">Exercises for Chapter 3</a></li>
</ul>
<!--
* [Exercises for Chapter 3 with Solutions](https://www.dropbox.com/scl/fi/lp0zkaftdi14gzz5n69al/Ch3_Exercises_with_Solutions1.pdf?rlkey=h08gnhua651rm6oyknpmcs4yg&dl=0) 
-->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-Probability.html" class="pagination-link" aria-label="Probability">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-Monte-Carlo-Simulations.html" class="pagination-link" aria-label="Estimation Theory and Monte Carlo Simulations">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Estimation Theory and Monte Carlo Simulations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>